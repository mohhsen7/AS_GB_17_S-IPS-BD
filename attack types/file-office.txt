['alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows embedded packager object identifier"
 flow:to_client,established
 flowbits:isset,file.ole
 file_data
 content:"|0F 00 09 04|"
 fast_pattern:only
 flowbits:set,ms.packager
 flowbits:noalert
 metadata:service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0013
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-005
 classtype:attempted-user
 sid:20882
 rev:10
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows RTF file with embedded object package download attempt"
 flow:to_client,established
 file_data
 content:"{|5C|rt"
 nocase
 content:"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"
 distance:0
 nocase
 flowbits:set,file.rtf.embed
 metadata:service ftp-data, service http, service imap, service pop3
 reference:cve,2006-4692
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms06-065
 classtype:misc-activity
 sid:8445
 rev:14
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel IPMT record buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|1C 1D 13 08 48 00 13 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 25 02 00 00 00 11 6D 79 63 6F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:25295
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel IPMT record buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|06 04 00 00 A7 00 04 00 B0 0F 0C 00 3C 00 50 01 77 8D A4 06 30 00 00 00 00 00 00 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:25294
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel IPMT record buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|06 04 00 00 A7 00 04 00 B0 0F 0C 00 3C 00 50 01 77 8D A4 06 30 00 00 00 00 00 00 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:25296
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Visio TAG_xxxSheet code execution attempt"
 flow:to_client,established
 flowbits:isset,file.visio
 file_data
 content:"|6D 00 FF FF 00 00 03 00 20 00 00 00 03 00 FF FF FF FF FF FF FF FF 00 00 00 00 00 00 02 00 FF FF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-023
 classtype:attempted-user
 sid:26163
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Visio TAG_xxxSheet code execution attempt"
 flow:to_server,established
 flowbits:isset,file.visio
 file_data
 content:"|6D 00 FF FF 00 00 03 00 20 00 00 00 03 00 FF FF FF FF FF FF FF FF 00 00 00 00 00 00 02 00 FF FF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-023
 classtype:attempted-user
 sid:26164
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word malformed OCXINFO element EoP attempt"
 flow:to_server,established
 file_data
 content:"|06 00 00 88 29 00 00 0B 00 00 00 FF FF 06 00 00 00 06 00 AF 50 33 00 08 00 02 00 AC 3C 22 00 06 00 B0 50 33 00 08 00 02 00 DC A2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3850
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-072
 classtype:attempted-user
 sid:27859
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word malformed OCXINFO element EoP attempt"
 flow:to_client,established
 file_data
 content:"|06 00 00 88 29 00 00 0B 00 00 00 FF FF 06 00 00 00 06 00 AF 50 33 00 08 00 02 00 AC 3C 22 00 06 00 B0 50 33 00 08 00 02 00 DC A2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3850
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-072
 classtype:attempted-user
 sid:27858
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word document invalid cell count memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|3F 60 04 00 0E C6 AA FD 24 36 DF AC 39 D6 B8 7B AB 2E 6B 7F CE F4 E7 FE 8A 0F 49 C4 CC C8 B3 30|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3854
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27857
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word document invalid cell count memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|3F 60 04 00 0E C6 AA FD 24 36 DF AC 39 D6 B8 7B AB 2E 6B 7F CE F4 E7 FE 8A 0F 49 C4 CC C8 B3 30|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3854
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27856
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word document invalid cell count memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|D0 F0 C4 B5 A6 B5 A6 98 A6 98 89 C4 7C 70 7C 70 7C 70 62 55 49 55 49 55 62|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3856
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27855
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word document invalid cell count memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|D0 F0 C4 B5 A6 B5 A6 98 A6 98 89 C4 7C 70 7C 70 7C 70 62 55 49 55 49 55 62|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3856
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27854
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word invalid number of cells memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|70 00 6B 00 2D 00 6B 00 67 00 72 00 65 00 73 00 2E 00 72 00 75 00 2F 00 00 00 E0 C9 EA 79 F9 BA|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3852
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27853
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word invalid number of cells memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|70 00 6B 00 2D 00 6B 00 67 00 72 00 65 00 73 00 2E 00 72 00 75 00 2F 00 00 00 E0 C9 EA 79 F9 BA|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3852
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27852
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office SDTI signed integer underflow attempt"
 flow:to_server,established
 file_data
 flowbits:isset,file.doc
 content:"|00 00 0C 00|"
 fast_pattern
 content:"|FF FF|"
 within:2
 distance:-10
 content:!"|00 00 00 00|"
 within:4
 distance:8
 byte_test:1,!&,0x80,3,relative
 byte_test:1,&,0x80,15,relative
 byte_test:4,>,0,20,relative,little
 byte_test:4,<=,4,20,relative,little
 metadata:policy balanced-ips alert, policy security-ips alert, service smtp
 reference:cve,2013-3848
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27851
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office SDTI signed integer underflow attempt"
 flow:to_client,established
 file_data
 flowbits:isset,file.doc
 content:"|00 00 0C 00|"
 fast_pattern
 content:"|FF FF|"
 within:2
 distance:-10
 content:!"|00 00 00 00|"
 within:4
 distance:8
 byte_test:1,!&,0x80,3,relative
 byte_test:1,&,0x80,15,relative
 byte_test:4,>,0,20,relative,little
 byte_test:4,<=,4,20,relative,little
 metadata:policy balanced-ips alert, policy security-ips alert, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3848
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-072
 classtype:attempted-user
 sid:27850
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel invalid external defined names read AV attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|49 6E 64 65 70 65 6E 64 65 6E 63 65 20 44 61 79 5A 00 0D 00 05 05 23 00 01 00 00 00 00 60 B5 E3|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:27825
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel invalid external defined names read AV attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|49 6E 64 65 70 65 6E 64 65 6E 63 65 20 44 61 79 5A 00 0D 00 05 05 23 00 01 00 00 00 00 60 B5 E3|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:27824
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel PtgMemFunc zero-value cce-field read access violation attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|41 4D 34 36 34 39 42 33 36 32 07 00 2D 00 00 FF 3F 00 00 23|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1315
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:27821
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel PtgMemFunc zero-value cce-field read access violation attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|41 4D 34 36 34 39 42 33 36 32 07 00 2D 00 00 FF 3F 00 00 23|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1315
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:27820
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word 2003 macro byte opcode large data structure arbitrary code execution attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|82 39 26 41 B0 5D 5A D1|"
 content:"|7F DE 64 36 C7 06 83|"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3891
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-086
 classtype:attempted-user
 sid:28206
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word 2003 macro byte opcode large data structure arbitrary code execution attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|82 39 26 41 B0 5D 5A D1|"
 content:"|7F DE 64 36 C7 06 83|"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3891
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-086
 classtype:attempted-user
 sid:28205
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel RealTimeData record memory corruption attempt"
 flow:to_server,established
 content:"|D0 CF 11 E0|"
 depth:4
 file_data
 content:"|13 08|"
 content:!"|00 00|"
 within:2
 byte_extract:2,0,size_of_record,relative,little
 content:"|13 08 00 00 00 00 00 00 00 00|"
 within:10
 byte_test:4,>,size_of_record,6,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:28546
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel RealTimeData record memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|13 08|"
 content:!"|00 00|"
 within:2
 byte_extract:2,0,size_of_record,relative,little
 content:"|13 08 00 00 00 00 00 00 00 00|"
 within:10
 byte_test:4,>,size_of_record,6,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:28544
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via malicious toolbar and author attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"Tran Duy Linh"
 nocase
 content:"CONTROL MSComctlLib.Toolbar.2"
 fast_pattern:only
 content:"Toolbar1"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30166
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via malicious toolbar and author attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"Tran Duy Linh"
 nocase
 content:"CONTROL MSComctlLib.Toolbar.2"
 fast_pattern:only
 content:"Toolbar1"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30165
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via malicious MSComctlLib object attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"CONTROL MSComctlLib"
 fast_pattern:only
 content:"|90 90 90 90 90 90|"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30163
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via malicious MSComctlLib object attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"CONTROL MSComctlLib"
 fast_pattern:only
 content:"|90 90 90 90 90 90|"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30161
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_server,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"9181DC5F-E07D-418A-ACA6-8EEA1ECB8E9E"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30160
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_client,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"9181DC5F-E07D-418A-ACA6-8EEA1ECB8E9E"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30159
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_server,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"C74190B6-8589-11d1-B16A-00C0F0283628"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30158
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_client,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"C74190B6-8589-11d1-B16A-00C0F0283628"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30157
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_server,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"996BF5E0-8044-4650-ADEB-0B013914E99C"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30156
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_client,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"996BF5E0-8044-4650-ADEB-0B013914E99C"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30155
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_server,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"BDD1F04B-858B-11D1-B16A-00C0F0283628"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30154
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls stack buffer overflow via MIME HTML document attempt"
 flow:to_client,established
 file_data
 content:"MIME-Version"
 depth:12
 nocase
 content:"BDD1F04B-858B-11D1-B16A-00C0F0283628"
 content:".mso"
 distance:0
 content:"Content-Transfer-Encoding: base64"
 within:250
 distance:-100
 nocase
 content:"Content-Type: application/x-mso"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:30153
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|C5 02 3F 83 01 FE 8B 05 E0 2F B1 0D 01 97 0C 50|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3155
 reference:url,osvdb.org/show/osvdb/97113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-074
 classtype:attempted-user
 sid:31537
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|02 09 04 87 04 17 B9 02 3F 83 01 FE 8B 05 B8 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3155
 reference:url,osvdb.org/show/osvdb/97113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-074
 classtype:attempted-user
 sid:31536
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|C5 02 3F 83 01 FE 8B 05 E0 2F B1 0D 01 97 0C 50|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3155
 reference:url,osvdb.org/show/osvdb/97113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-074
 classtype:attempted-user
 sid:31535
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|02 09 04 87 04 17 B9 02 3F 83 01 FE 8B 05 B8 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3155
 reference:url,osvdb.org/show/osvdb/97113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-074
 classtype:attempted-user
 sid:31534
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel TXO and OBJ records parsing stack memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|EB 00|"
 content:"|0F 00 00 F0|"
 within:4
 distance:2
 flowbits:set,cve.2008-4265
 flowbits:noalert
 metadata:service smtp
 reference:bugtraq,32618
 reference:cve,2008-4265
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS08-074
 classtype:misc-activity
 sid:31591
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 file_data
 content:"|40 00 00 00 00 D2 49 6B 00 00 00 00 40 00 00 00 00 4C 10 5F 20 E3 C6 01 40 00 00 00 00 1E 5A CA 20 E3 C6 01|"
 fast_pattern:only
 content:"|FE FF 00 00|"
 content:"|02 00 00 00 A8 03 00 00 1E|"
 within:9
 distance:180
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:31927
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 file_data
 content:"|40 00 00 00 00 D2 49 6B 00 00 00 00 40 00 00 00 00 4C 10 5F 20 E3 C6 01 40 00 00 00 00 1E 5A CA 20 E3 C6 01|"
 fast_pattern:only
 content:"|FE FF 00 00|"
 content:"|02 00 00 00 A8 03 00 00 1E|"
 within:9
 distance:180
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:31926
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word styleWithEffects use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.docx
 file_data
 content:"|E2 EC 9C B5 F6 1B C6 B2 CD 34 06 86 4B 3A E9 5F 3F 12 60 0C 08 09 24 EE 46 C9 43 62 5B 94 E1 2B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:32148
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word styleWithEffects use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.docx
 file_data
 content:"|E2 EC 9C B5 F6 1B C6 B2 CD 34 06 86 4B 3A E9 5F 3F 12 60 0C 08 09 24 EE 46 C9 43 62 5B 94 E1 2B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:32147
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word bOffset value overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|0A 26 00 0B 46 02 00 0D C6 08 00 02 30 FD 02 0D 00 00 16 24 01 2A 24 01 49 66 02 00 00 00 67 64|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6335
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32477
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word document malicious lcbSttbfBkmkArto value attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|FF FF FF FF FF FF FF FF EC A5 C1 00|"
 content:"|16 00|"
 within:2
 distance:58
 content:"|B7 00|"
 within:2
 distance:88
 isdataat:1400
 content:!"|00 00 00 00|"
 within:4
 distance:1396
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6333
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-069
 classtype:attempted-user
 sid:32429
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word document malicious lcbSttbfBkmkArto value attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|FF FF FF FF FF FF FF FF EC A5 C1 00|"
 content:"|16 00|"
 within:2
 distance:58
 content:"|B7 00|"
 within:2
 distance:88
 isdataat:1400
 content:!"|00 00 00 00|"
 within:4
 distance:1396
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6333
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-069
 classtype:attempted-user
 sid:32428
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|08 02 18 00 07 00 00 00 0A 00 2C 01 00 00 00 00 40 01 0F 00 08 02 10 00 08 00 00 00 0A 00 2C 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6361
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-083
 classtype:attempted-user
 sid:32719
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|08 02 18 00 07 00 00 00 0A 00 2C 01 00 00 00 00 40 01 0F 00 08 02 10 00 08 00 00 00 0A 00 2C 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6361
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-083
 classtype:attempted-user
 sid:32718
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word array index out-of-bounds attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|0F 84 80 16 11 84 98 14 A4 90 01 00 05 1C 00 13 A4 A0 00 14 A4 A0 00 00 4E 4A 07 00 51 4A 07 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6356
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-081
 classtype:attempted-user
 sid:32712
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word array index out-of-bounds attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|0F 84 80 16 11 84 98 14 A4 90 01 00 05 1C 00 13 A4 A0 00 14 A4 A0 00 00 4E 4A 07 00 51 4A 07 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6356
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-081
 classtype:attempted-user
 sid:32711
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel blip image use after free attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|02 00 00 00 3B 00 00 00 03 00 00 00 85 00 00 00 3F 00 01 F0 19 3C 00 00 02 00 07 E0 24 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6360
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-083
 classtype:attempted-user
 sid:32684
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel blip image use after free attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|02 00 00 00 3B 00 00 00 03 00 00 00 85 00 00 00 3F 00 01 F0 19 3C 00 00 02 00 07 E0 24 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6360
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-083
 classtype:attempted-user
 sid:32683
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"4E087DEB"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32863
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|B1 3C C1 6A|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32862
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|A3 E8 13 07|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32861
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|8B 8D DA 58|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32860
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|4E 08 7D EB|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32859
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|00 36 D8 F4|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32858
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|8E 7E E1 E6|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:32857
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel remote exploit attempt"
 flow:to_client,established
 file_data
 content:"|C8 19 F5 05 27 D4 FD 77 3F 66 9A 71 A3 3B 09 B2 79 03 3E A0 A4 FA 9F AE E7 EC D3 51 3C 5F E5 FC|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0063
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-012
 classtype:attempted-user
 sid:33362
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib use after free attempt"
 flow:established,to_server
 flowbits:isset,file.doc
 content:"|00 00 30 22 00 00 00 00 00 00 DC 23 00 00 00 00 00 00 DC 23 00 00 00 00 00 00 55 31 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0064
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-012
 classtype:attempted-user
 sid:33351
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib use after free attempt"
 flow:established,to_client
 flowbits:isset,file.doc
 content:"|00 00 30 22 00 00 00 00 00 00 DC 23 00 00 00 00 00 00 DC 23 00 00 00 00 00 00 55 31 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0064
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-012
 classtype:attempted-user
 sid:33350
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OFFICE Microsoft Office Word incorrect schema property remote code execution attempt"
 flow:established,to_server
 flowbits:isset,file.docx
 file_data
 content:"|4D 60 52 3B 55 B9 2A 33 49 ED 5B 4A 48 32 68 C7 B6 1C 49 1E E0 DF A7 E5 0B 5F 80 0D D9 4D 1E 52|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0085
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022
 classtype:attempted-user
 sid:33716
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word incorrect schema property remote code execution attempt"
 flow:established,to_client
 flowbits:isset,file.docx
 file_data
 content:"|4D 60 52 3B 55 B9 2A 33 49 ED 5B 4A 48 32 68 C7 B6 1C 49 1E E0 DF A7 E5 0B 5F 80 0D D9 4D 1E 52|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0085
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022
 classtype:attempted-user
 sid:33715
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office RTF out-of-bounds array access remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"{|5C|sv }"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1649
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34094
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office RTF out-of-bounds array access remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"{|5C|sv }"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1649
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34093
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office RTF double-free remote code execution attempt"
 flow:to_server,established
 file_data
 content:"hp}|5C|xmlns1{|5C|protend{|5C|xmlclose}|5C|xmlns2{|5C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1651
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34087
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office RTF double-free remote code execution attempt"
 flow:to_client,established
 file_data
 content:"hp}|5C|xmlns1{|5C|protend{|5C|xmlclose}|5C|xmlns2{|5C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1651
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34086
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office XML nested num tag double-free attempt"
 flow:to_server,established
 file_data
 content:"|00 12 00 00 00|word/numbering.xml"
 fast_pattern
 content:"|52 3A 31 5A 44 FE 0F 44 CF 3D E1 8D E4 10 B5 C7 29 21 EC 9E B9 8D 84 21 C2 6B 18 33 69 76 C5 9D|"
 within:32
 distance:279
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,74011
 reference:cve,2015-1650
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34067
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office XML nested num tag double-free attempt"
 flow:to_client,established
 file_data
 content:"|00 12 00 00 00|word/numbering.xml"
 fast_pattern
 content:"|52 3A 31 5A 44 FE 0F 44 CF 3D E1 8D E4 10 B5 C7 29 21 EC 9E B9 8D 84 21 C2 6B 18 33 69 76 C5 9D|"
 within:32
 distance:279
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,74011
 reference:cve,2015-1650
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34066
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word document memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.docx
 file_data
 content:"|BC AF 87 AD CB 62 47 80 14 8E 41 66 48 81 DE 9E 6B E5 40 8B A0 47 F5 5B ED 9E 23 D5 01 3B D1 58|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34063
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word document memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.docx
 file_data
 content:"|BC AF 87 AD CB 62 47 80 14 8E 41 66 48 81 DE 9E 6B E5 40 8B A0 47 F5 5B ED 9E 23 D5 01 3B D1 58|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:34062
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"FILE-OFFICE Microsoft Office Word incorrect ptCount element denial of service attempt"
 flow:established,to_server
 flowbits:isset,file.docx
 file_data
 content:"|5C D3 6E 39 8C EE 34 F1 05 33 3C 1D 97 CA D1 FB D5 D5 D5 DB DB DB D1 BF 04 22 03 03 7B B3 A2 2C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1682
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-046
 classtype:denial-of-service
 sid:34429
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word incorrect ptCount element denial of service attempt"
 flow:established,to_client
 flowbits:isset,file.docx
 file_data
 content:"|5C D3 6E 39 8C EE 34 F1 05 33 3C 1D 97 CA D1 FB D5 D5 D5 DB DB DB D1 BF 04 22 03 03 7B B3 A2 2C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1682
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-046
 classtype:denial-of-service
 sid:34428
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 file_data
 content:"|9D 58 67 58 53 57 18 4E 08 84 3D 02 04 08 7B 4A 08 60 D9 1B 94 15 F6 DE B3|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28526
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 file_data
 content:"|9D 58 67 58 53 57 18 4E 08 84 3D 02 04 08 7B 4A 08 60 D9 1B 94 15 F6 DE B3|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28525
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 file_data
 content:"|EC 5A 07 54 D3 D9 B3 BE F4 2E EA 4A 17 75 57 8A C2 02 8A 0A 04 50 B1 81 34|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28473
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 file_data
 content:"|EC 5A 07 54 D3 D9 B3 BE F4 2E EA 4A 17 75 57 8A C2 02 8A 0A 04 50 B1 81 34|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28472
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.tiff.little
 file_data
 content:"|17 01 04 00 01 00 00 00|"
 byte_test:4,>,0xFFFFFF,0,relative,little
 content:"|02 02 04 00 01 00 00 00|"
 within:300
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28471
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.tiff.little
 file_data
 content:"|17 01 04 00 01 00 00 00|"
 byte_test:4,>,0xFFFFFF,0,relative,little
 content:"|02 02 04 00 01 00 00 00|"
 within:300
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28470
 rev:8
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.tiff.big
 file_data
 content:"|01 17 00 04 00 00 00 01|"
 byte_test:4,>,0xFFFFFF,0,relative
 content:"|02 02 00 04 00 00 00 01|"
 within:300
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28469
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.tiff.big
 file_data
 content:"|01 17 00 04 00 00 00 01|"
 byte_test:4,>,0xFFFFFF,0,relative
 content:"|02 02 00 04 00 00 00 01|"
 within:300
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28468
 rev:8
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 content:"|ED 5C 07 54 53 59 B7 3E A1 57 11 95 D0 44 9D 91 A2 32 80 22 02 41 B0 22 48|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28467
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 file_data
 content:"|ED 5C 07 54 53 59 B7 3E A1 57 11 95 D0 44 9D 91 A2 32 80 22 02 41 B0 22 48|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28466
 rev:8
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.tiff|file.doc
 file_data
 content:"|98 B8 FF FF B2 00 00 00 B2 00 00 00 B3 00 00 00 B3 00 00 00 B2 00 00 00 B1 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28465
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office GDI library TIFF handling integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.tiff|file.doc
 file_data
 content:"|98 B8 FF FF B2 00 00 00 B2 00 00 00 B3 00 00 00 B3 00 00 00 B2 00 00 00 B1 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,63530
 reference:cve,2013-3906
 reference:url,osvdb.org/show/osvdb/99376
 reference:url,technet.microsoft.com/en-us/security/advisory/2896666
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-096
 classtype:attempted-user
 sid:28464
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel IPMT record buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|1C 1D 13 08 48 00 13 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 25 02 00 00 00 11 6D 79 63 6F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2011-0101
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS11-021
 classtype:attempted-user
 sid:25293
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word rtf invalid listoverridecount value attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|listoverride"
 content:"|5C|listoverridecount"
 fast_pattern:only
 pcre:"/listoverridecount([2345678]|[019][0-9])/i"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-2539
 reference:cve,2014-1761
 reference:url,technet.microsoft.com/en-us/security/advisory/2953095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:24975
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word rtf invalid listoverridecount value attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|listoverride"
 content:"|5C|listoverridecount"
 fast_pattern:only
 pcre:"/listoverridecount([2345678]|[019][0-9])/i"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-2539
 reference:cve,2014-1761
 reference:url,technet.microsoft.com/en-us/security/advisory/2953095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:24974
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Drawing object code execution attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|EC 00|"
 byte_extract:2,0,record,relative,little
 content:"|0B F0|"
 within:record
 content:"|80 00|"
 within:record
 content:!"|00 00 00 00|"
 within:4
 flowbits:set,recordtype
 flowbits:noalert
 metadata:policy max-detect-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,23826
 reference:cve,2007-1203
 reference:cve,2007-1747
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms07-023
 classtype:attempted-user
 sid:24284
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office MSCOMCTL ActiveX control tabstrip method attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 flowbits:isset,mscomctl
 file_data
 content:"9665fb1e7c85d111b16a00c0f0283628"
 nocase
 content:"21433412"
 distance:0
 nocase
 content:"01efcdab"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-1856
 reference:cve,2013-1313
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-060
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-020
 classtype:attempted-user
 sid:24006
 rev:13
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office MSCOMCTL ActiveX control tabstrip method access"
 flow:to_server,established
 content:"4D53436F6D63746C4C69622E5461625374726970"
 fast_pattern:only
 flowbits:set,mscomctl
 flowbits:noalert
 metadata:service smtp
 classtype:misc-activity
 sid:24005
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office MSCOMCTL ActiveX control tabstrip method access"
 flow:to_client,established
 file_data
 content:"MSComctlLib.TabStrip"
 fast_pattern:only
 flowbits:set,mscomctl
 flowbits:noalert
 metadata:service ftp-data, service http, service imap, service pop3
 classtype:misc-activity
 sid:24004
 rev:8
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office MSCOMCTL ActiveX control tabstrip method attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 flowbits:isset,mscomctl
 file_data
 content:"9665fb1e7c85d111b16a00c0f0283628"
 nocase
 content:"21433412"
 distance:0
 nocase
 content:"01efcdab"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-1856
 reference:cve,2013-1313
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-060
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-020
 classtype:attempted-user
 sid:23844
 rev:14
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"D0CF11E0"
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,=,0x64000000,0,relative,little,string,hex
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:23305
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"A3E81207"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21937
 rev:10
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"8E7EE1E6"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21906
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"B13CC16A"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21905
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"0036D8F4"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21904
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"8B8DDA58"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21903
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"21433412"
 content:"4E087DEB"
 distance:0
 nocase
 content:"436F626A"
 distance:0
 nocase
 byte_test:8,>,0x08000000,8,relative,little,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21902
 rev:11
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|A3 E8 13 07|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21901
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|8E 7E E1 E6|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21900
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|B1 3C C1 6A|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21899
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|00 36 D8 F4|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21898
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|8B 8D DA 58|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21897
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows common controls MSCOMCTL.OCX buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|21 43 34 12|"
 content:"|4E 08 7D EB|"
 distance:0
 content:"|43 6F 62 6A|"
 distance:0
 byte_test:4,>,8,4,relative,little
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21896
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE MSCOMCTL ActiveX control deserialization arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"5FDC81917DE08A41A6AC"
 fast_pattern:only
 pcre:"/5FDC81917DE08A41A6AC(E9B8ECA1EE.8|.98ECB1EEA8E)/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21801
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE MSCOMCTL ActiveX control deserialization arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"B69041C78985D1116AD1283628F0C000"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21800
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE MSCOMCTL ActiveX control deserialization arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"E0F86B9944805046EBAD9CE91439010B"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21799
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE MSCOMCTL ActiveX control deserialization arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"4BF0D1BD8B85D1116ab1283628f0c000"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21798
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE MSCOMCTL ActiveX control deserialization arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"4BF0D1BD8B85D111B16A00C0F0283628"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS12-027
 classtype:attempted-user
 sid:21797
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word with embedded Flash file transfer"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"CONTROL ShockwaveFlash.ShockwaveFlash"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2011-0611
 reference:url,www.adobe.com/support/security/advisories/apsa11-02.html
 classtype:attempted-user
 sid:18546
 rev:16
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Download of PowerPoint 95 file"
 flow:to_client,established
 content:"|03 00 00 00 FF FF 00 00|"
 content:"|00 00 00 00 E8 03 00 00 FF FF 00 00|"
 within:12
 distance:4
 content:"|00 00 00 00 E9 03 00 00 04 00 00 00|"
 within:12
 distance:4
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-017
 classtype:attempted-user
 sid:15503
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word ActiveX object uninitialized memory access attempt"
 flow:to_server,established
 file_data
 content:"|A4 11 D8 28 D3 E5 EC FD ED 1A 1E 59 E0 08 4C 03 03 1A 99 33 83 EC 54 3C 3E 64 B0 A4 28 96 C0 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1770
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34744
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word ActiveX object uninitialized memory access attempt"
 flow:to_client,established
 file_data
 content:"|A4 11 D8 28 D3 E5 EC FD ED 1A 1E 59 E0 08 4C 03 03 1A 99 33 83 EC 54 3C 3E 64 B0 A4 28 96 C0 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1770
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34743
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word WordPerfect converter EnumFontFamProc use after free attempt"
 flow:to_server,established
 file_data
 content:"|05 DC 05 0C 00 01 D0 D0 02 08 00 00 01 80 01 08 00 02 D0 D1 01 23 00 00 8A 02 54 00 F4 1A 5C 12|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1760
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34740
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word WordPerfect converter EnumFontFamProc use after free attempt"
 flow:to_client,established
 file_data
 content:"|05 DC 05 0C 00 01 D0 D0 02 08 00 00 01 80 01 08 00 02 D0 D1 01 23 00 00 8A 02 54 00 F4 1A 5C 12|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1760
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34739
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word WordPerfect converter ForeignToRtf32 use after free attempt"
 flow:to_server,established
 file_data
 content:"|23 60 09 28 23 14 00 E0 DD 08 17 00 83 01 3B 00 02 00 33 A3 F7 03 00 00 2E 04 00 00 17 00 DD 8C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1759
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34738
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word WordPerfect converter ForeignToRtf32 use after free attempt"
 flow:to_client,established
 file_data
 content:"|23 60 09 28 23 14 00 E0 DD 08 17 00 83 01 3B 00 02 00 33 A3 F7 03 00 00 2E 04 00 00 17 00 DD 8C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1759
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:34737
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word nested tblStylePr element use after free attempt"
 flow:to_server,established
 file_data
 content:"|BA 37 6E 65 CE 88 EF 89 39 3B 43 BE B7 F7 9C AC 4A 5D 80 A3 11 2C 42 1D CF 34 CC 2F 9F E9 87 9B D8 74 FF A2 48 C7 3C D2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:35021
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word nested tblStylePr element use after free attempt"
 flow:to_client,established
 file_data
 content:"|BA 37 6E 65 CE 88 EF 89 39 3B 43 BE B7 F7 9C AC 4A 5D 80 A3 11 2C 42 1D CF 34 CC 2F 9F E9 87 9B D8 74 FF A2 48 C7 3C D2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:35020
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word nested tblStylePr element use after free attempt"
 flow:to_server,established
 file_data
 content:"<w:tblStylePr"
 content:"<w:tblStylePr"
 within:200
 content:!"</w:tblStylePr"
 within:200
 distance:-213
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:35019
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word nested tblStylePr element use after free attempt"
 flow:to_client,established
 file_data
 content:"<w:tblStylePr"
 content:"<w:tblStylePr"
 within:200
 content:!"</w:tblStylePr"
 within:200
 distance:-213
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-061
 classtype:attempted-user
 sid:35018
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word OCX use after free attempt"
 flow:to_server,established
 file_data
 content:"|36 1E 98 27 F1 00 24 63 BB 20 B5 52 23 25 9E D8 AB F5 0A 27 28 2F 40 E8 88 B3 F3 5B E4 C8 DE 6B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2380
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-070
 classtype:attempted-user
 sid:35202
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word OCX use after free attempt"
 flow:to_client,established
 file_data
 content:"|36 1E 98 27 F1 00 24 63 BB 20 B5 52 23 25 9E D8 AB F5 0A 27 28 2F 40 E8 88 B3 F3 5B E4 C8 DE 6B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2380
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-070
 classtype:attempted-user
 sid:35201
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel c legend remote code execution attempt"
 flow:to_server,established
 file_data
 content:"|F8 B5 E3 70 73 9B E3 C3 E1 F5 31 AB FC AF A5 28 2D 99 41 5A EF 09 37 65 06 E8 C7 DD 28 04 77 10|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2377
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35177
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel c legend remote code execution attempt"
 flow:to_client,established
 file_data
 content:"|F8 B5 E3 70 73 9B E3 C3 E1 F5 31 AB FC AF A5 28 2D 99 41 5A EF 09 37 65 06 E8 C7 DD 28 04 77 10|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2377
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35176
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel malformed workbook record remote code execution attempt"
 flow:to_server,established
 file_data
 content:"|70 B5 81 BE 90 F1 CF 01 C0 45 C9 BE 90 F1 CF 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2415
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35142
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel malformed workbook record remote code execution attempt"
 flow:to_client,established
 file_data
 content:"|70 B5 81 BE 90 F1 CF 01 C0 45 C9 BE 90 F1 CF 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2415
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35141
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"|AA 04 98 A6 6F 2D AB C3 00 15 4C 3C D3 4C 51 9D D7 59 6D 4A 74 2E 3F 26 84 27 3F 16 AA 71 57 69|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2376
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35138
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"|AA 04 98 A6 6F 2D AB C3 00 15 4C 3C D3 4C 51 9D D7 59 6D 4A 74 2E 3F 26 84 27 3F 16 AA 71 57 69|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2376
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-070
 classtype:attempted-user
 sid:35137
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word RTF Control.TaskSymbol.1 heap corruption attempt - Win.Trojan.Sofacy"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"{|5C|*|5C|objclass Control.TaskSymbol.1}"
 fast_pattern
 nocase
 content:"d0cf11e"
 within:200
 nocase
 content:"{|5C|*|5C|objclass Forms.Image.1}"
 distance:0
 nocase
 content:"466F726D732E496D6167652E31"
 distance:0
 nocase
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2424
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-070
 reference:url,www.virustotal.com/en/file/9e5fbd79d8febe7a162cd5200041772db60dc83244605b1ff37ef8d14334f512/analysis/
 classtype:trojan-activity
 sid:35325
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word malformed document file use after free attempt"
 flow:to_server,established
 file_data
 content:"|0E 16 68 5F 61 63 00 43 4A 14 00 61 4A 14 00 00 1A 15 68 DB 18 04 00 16 68 A2 09 13 00 35 08 81|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2467
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-admin
 sid:35522
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word malformed document file use after free attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|0E 16 68 5F 61 63 00 43 4A 14 00 61 4A 14 00 00 1A 15 68 DB 18 04 00 16 68 A2 09 13 00 35 08 81|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2467
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-admin
 sid:35521
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word msptls.dll integer underflow attempt"
 flow:to_server,established
 file_data
 content:"|68 01 67 64 9A 06 9B 00 00 10 00 00 03 24 03 11 84 E0 01 12 64 2C 01 01 00 57 44 C8 00 60 84 E0|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2470
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-081
 classtype:attempted-user
 sid:35512
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word msptls.dll integer underflow attempt"
 flow:to_client,established
 file_data
 content:"|68 01 67 64 9A 06 9B 00 00 10 00 00 03 24 03 11 84 E0 01 12 64 2C 01 01 00 57 44 C8 00 60 84 E0|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2470
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-081
 classtype:attempted-user
 sid:35511
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|84 93 00 00 86 13 00 00 88 13 00 00 8A 13 00 00 8C 13 00 00 8E 13 00 00 90 13 00 00 F1 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2469
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35510
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|84 93 00 00 86 13 00 00 88 13 00 00 8A 13 00 00 8C 13 00 00 8E 13 00 00 90 13 00 00 F1 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2469
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35509
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word mso.dll use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|16 00 1A 15 68 C3 70 FB 00 16 68 AC 1B 40 00 35 08 81 43 4A 16 00 5C 08 81 61 4A 16 00 00 0E 16|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2468
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35506
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word mso.dll use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|16 00 1A 15 68 C3 70 FB 00 16 68 AC 1B 40 00 35 08 81 43 4A 16 00 5C 08 81 61 4A 16 00 00 0E 16|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2468
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35505
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word incomplete ActiveX control use-after-free attempt"
 flow:to_server,established
 file_data
 content:"|65 90 41 6B C3 30 0C 85 EF 83 FD 87 A0 7B 62 B7 09 5D 1B E2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1642
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-081
 classtype:attempted-user
 sid:35504
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word incomplete ActiveX control use-after-free attempt"
 flow:to_client,established
 file_data
 content:"|65 90 41 6B C3 30 0C 85 EF 83 FD 87 A0 7B 62 B7 09 5D 1B E2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1642
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-081
 classtype:attempted-user
 sid:35503
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll corrupt fcPlcfFldMom out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|C6 7A 00 00 A6 00 00 00 6C 73 00 00 00 00 00 00 6C 73 00 00 00 00 00 00 6C 73 00 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,76192
 reference:cve,2015-2477
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35502
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll corrupt fcPlcfFldMom out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|C6 7A 00 00 A6 00 00 00 6C 73 00 00 00 00 00 00 6C 73 00 00 00 00 00 00 6C 73 00 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,76192
 reference:cve,2015-2477
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:35501
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word Document invalid directory entry use after free attempt"
 flow:to_server,established
 file_data
 content:"|20 00 20 00 08 FF 31 00 09 FF 39 68 6E 63 BB 79 57 53 17 53 81 67 DC 8F D1 8F 6E 78 9A 5B 57 53|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2431
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-user
 sid:35498
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word Document invalid directory entry use after free attempt"
 flow:to_client,established
 file_data
 content:"|20 00 20 00 08 FF 31 00 09 FF 39 68 6E 63 BB 79 57 53 17 53 81 67 DC 8F D1 8F 6E 78 9A 5B 57 53|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2431
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-user
 sid:35497
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel bad file pointer memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|00 1D 1C 02 00 00 00 03 00 49 49 49 85 00 09 00 63 C8 02 00 00 00 01 00 56 85 00 0A 00 F3 67 03|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2520
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36003
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel bad file pointer memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|00 1D 1C 02 00 00 00 03 00 49 49 49 85 00 09 00 63 C8 02 00 00 00 01 00 56 85 00 0A 00 F3 67 03|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2520
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36002
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel malformed XF record use after free attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|90 EC B7 BD 89 36 CE 01 FE FF FF FF 00 00 00 00 00 00 00 00 57 00 6F 00 72 00 6B 00 62 00 6F 00 6F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2523
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36001
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel malformed XF record use after free attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|90 EC B7 BD 89 36 CE 01 FE FF FF FF 00 00 00 00 00 00 00 00 57 00 6F 00 72 00 6B 00 62 00 6F 00 6F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2523
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36000
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel OLESS directory entry type confusion remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|C0 F7 22 A4 65 D2 9B 3E 62 FF AE C2 E7 48 71 C0 0D D2 A7 73 AC 49 26 BD 44 6A E4 D2 06 3F 2D 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2521
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:35997
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel OLESS directory entry type confusion remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|C0 F7 22 A4 65 D2 9B 3E 62 FF AE C2 E7 48 71 C0 0D D2 A7 73 AC 49 26 BD 44 6A E4 D2 06 3F 2D 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2521
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:35996
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word EPS filter PostScript object use after free attempt"
 flow:to_server,established
 flowbits:isset,file.docx
 file_data
 content:"|D6 3B F7 71 19 1B D3 A5 20 E0 4A B0 01 30 E8 55 ED DF B9 2C AE 6E 1C 30 A5 AA 71 29 1F 0E 80 B8|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2545
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36027
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word EPS filter PostScript object use after free attempt"
 flow:to_client,established
 flowbits:isset,file.docx
 file_data
 content:"|D6 3B F7 71 19 1B D3 A5 20 E0 4A B0 01 30 E8 55 ED DF B9 2C AE 6E 1C 30 A5 AA 71 29 1F 0E 80 B8|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2545
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-099
 classtype:attempted-user
 sid:36026
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Windows OLE Packer Remote Code Execution attempt"
 flow:to_server,established
 file_data
 content:"|36 64 12 62 40 EE E8 DA 5E F7 87 2B 87 14 2A 9A 31 86 7B E8 FC D9 D5 F5 5E 73 57 AC 75 D6 7A CD BA 38 13 C9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service smtp
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/library/security/3010060
 classtype:attempted-user
 sid:36148
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Windows OLE Packer Remote Code Execution attempt"
 flow:to_client,established
 file_data
 content:"|36 64 12 62 40 EE E8 DA 5E F7 87 2B 87 14 2A 9A 31 86 7B E8 FC D9 D5 F5 5E 73 57 AC 75 D6 7A CD BA 38 13 C9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/library/security/3010060
 classtype:attempted-user
 sid:36147
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office XML nested num tag double-free attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|10 00 08 01|docProps/app.xml"
 fast_pattern
 content:"|92 C1 4E C3 30 0C 86 EF 48 BC 43 95 7B 9B A4 63 88 55 6D 27 01 DA 89 49 48 0C 81 B8 45 89 D7 45|"
 within:960
 distance:40
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,74011
 reference:cve,2015-1650
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:36245
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office XML nested num tag double-free attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|10 00 08 01|docProps/app.xml"
 fast_pattern
 content:"|92 C1 4E C3 30 0C 86 EF 48 BC 43 95 7B 9B A4 63 88 55 6D 27 01 DA 89 49 48 0C 81 B8 45 89 D7 45|"
 within:960
 distance:40
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,74011
 reference:cve,2015-1650
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:36244
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll corrupt fcPlcfFldMom uninitialized memory access attempt "
 flow:to_server,established
 file_data
 content:"|2B 14 00 00 24 01 00 00 4F 15 00 00 00 00 00 00 4F 15 00 00 00 00 00 00 4F 15 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,76192
 reference:cve,2015-2477
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:36204
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll corrupt fcPlcfFldMom uninitialized memory access attempt "
 flow:to_client,established
 file_data
 content:"|2B 14 00 00 24 01 00 00 4F 15 00 00 00 00 00 00 4F 15 00 00 00 00 00 00 4F 15 00 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,76192
 reference:cve,2015-2477
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-081
 classtype:attempted-user
 sid:36203
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel malformed binary format use after free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsx
 file_data
 content:"|6B 95 3B DD B6 40 58 44 DD E9 D5 09 C5 31 69 56 86 32 14 D4 9B 58 CA 41 03 2B 33 C5 5F 69 82 E8 FF F9 CA EC|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2555
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-110
 classtype:attempted-user
 sid:36430
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel malformed binary format use after free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsx
 file_data
 content:"|6B 95 3B DD B6 40 58 44 DD E9 D5 09 C5 31 69 56 86 32 14 D4 9B 58 CA 41 03 2B 33 C5 5F 69 82 E8 FF F9 CA EC|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2555
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-110
 classtype:attempted-user
 sid:36429
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Visio lmetaclasscount buffer overflow attempt"
 flow:to_server,established
 file_data
 content:"|A0 3B E5 40 3C E5 40 3D E5 40 3E E5 40 55 3F E5 40 40 E5 40 41 E5 40|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2557
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-110
 classtype:attempted-user
 sid:36428
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Visio lmetaclasscount buffer overflow attempt"
 flow:to_client,established
 file_data
 content:"|A0 3B E5 40 3C E5 40 3D E5 40 3E E5 40 55 3F E5 40 40 E5 40 41 E5 40|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2557
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-110
 classtype:attempted-user
 sid:36427
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel fileVersion use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsx
 file_data
 content:"|F0 A9 1E E3 D8 98 6C 44 88 0E 63 96 50 7D 20 33 96 C2 C9 52 AA 84 1A D8 AA 15 D1 99 62 34 D2 31|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2558
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-110
 classtype:attempted-user
 sid:36426
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel fileVersion use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsx
 file_data
 content:"|F0 A9 1E E3 D8 98 6C 44 88 0E 63 96 50 7D 20 33 96 C2 C9 52 AA 84 1A D8 AA 15 D1 99 62 34 D2 31|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2558
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-110
 classtype:attempted-user
 sid:36425
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel MdCallBack out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|A2 31 2A EB 46 25 1B A3 72 6E 54 D0 18 95 B7 51 E6 2A 22 44 39 7A A1 95 D5 EA CE 50 12 CD 70 59|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6038
 reference:cve,2016-0136
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-042
 classtype:attempted-user
 sid:36752
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel MdCallBack out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|A2 31 2A EB 46 25 1B A3 72 6E 54 D0 18 95 B7 51 E6 2A 22 44 39 7A A1 95 D5 EA CE 50 12 CD 70 59|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6038
 reference:cve,2016-0136
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-042
 classtype:attempted-user
 sid:36751
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word FGetCpFlowDr memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|68 F8 74 CB 00 00 2D 15 68 35 07 3B 00 16 68 35 07 3B 00 42 2A 01 43 4A 10 00 4B 48 00 00 4F 4A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6091
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36741
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word FGetCpFlowDr memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|68 F8 74 CB 00 00 2D 15 68 35 07 3B 00 16 68 35 07 3B 00 42 2A 01 43 4A 10 00 4B 48 00 00 4F 4A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6091
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36740
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word PmwdFromDoc use after free attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|00 0F 00 00 03 24 03 0F 84 D0 02 11 84 E4 FD 5E 84 D0 02 60 84 E4 FD 61 24 03 67 E4 C5 22 D4 00 00 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-116
 classtype:attempted-user
 sid:36717
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word PmwdFromDoc use after free attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|00 0F 00 00 03 24 03 0F 84 D0 02 11 84 E4 FD 5E 84 D0 02 60 84 E4 FD 61 24 03 67 E4 C5 22 D4 00 00 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-116
 classtype:attempted-user
 sid:36716
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel slicer style use-after-free attempt"
 flow:to_server,established
 file_data
 content:"|69 44 94 38 14 27 D4 CE E9 FC 0C F9 33 7F F2 C0 9E 44 51 15 3B E4 FB 38 DC 0C 93 68 CD A2 B4 C5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36715
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel slicer style use-after-free attempt"
 flow:to_client,established
 file_data
 content:"|69 44 94 38 14 27 D4 CE E9 FC 0C F9 33 7F F2 C0 9E 44 51 15 3B E4 FB 38 DC 0C 93 68 CD A2 B4 C5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36714
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office malformed odttf integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.docx
 file_data
 content:"word/fonts/"
 content:".odttf"
 within:25
 content:"|3B 76 37 13 DA 99 B7 E2 F6 D8 B7 BE 9E 79 D3 AE BF BB 7E 71 63 8D AA 9C AA 5A 53 FD EA CC 03 BF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6093
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36708
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office malformed odttf integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.docx
 file_data
 content:"word/fonts/"
 content:".odttf"
 within:25
 content:"|3B 76 37 13 DA 99 B7 E2 F6 D8 B7 BE 9E 79 D3 AE BF BB 7E 71 63 8D AA 9C AA 5A 53 FD EA CC 03 BF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6093
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-116
 classtype:attempted-user
 sid:36707
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office nwdblib.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"n|00|w|00|d|00|b|00|l|00|i|00|b|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x19\\x00|\\x00\\x5C)\\x00n\\x00w\\x00d\\x00b\\x00l\\x00i\\x00b\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2015-6128
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:37002
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office elsext.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"e|00|l|00|s|00|e|00|x|00|t|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x17\\x00|\\x00\\x5C)\\x00e\\x00l\\x00s\\x00e\\x00x\\x00t\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2015-6128
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:37001
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office nwdblib.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/nwdblib.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-6128
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:37000
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office elsext.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/elsext.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-6128
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36999
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office spframe.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/spframe.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-6132
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36996
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office spframe.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"s|00|p|00|f|00|r|00|a|00|m|00|e|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x19\\x00|\\x00\\x5C)\\x00s\\x00p\\x00f\\x00r\\x00a\\x00m\\x00e\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2015-6132
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36995
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office mqrt.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/mqrt.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-6132
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36994
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office mqrt.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"m|00|q|00|r|00|t|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x13\\x00|\\x00\\x5C)\\x00m\\x00q\\x00r\\x00t\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2015-6132
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36993
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|FF FF FF 7F 01 00 B7 01 00 19 1E 05 00 1E 0A 00 B1 01 8E 00 02 00 08 00 00 00 FF FF 3A 24 02 00 00 00 09 00 0D 00 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6177
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36975
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|FF FF FF 7F 01 00 B7 01 00 19 1E 05 00 1E 0A 00 B1 01 8E 00 02 00 08 00 00 00 FF FF 3A 24 02 00 00 00 09 00 0D 00 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6177
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36974
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word OGL module out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|02 04 00 00 03 24 03 61 24 03 00 04 00 00 03 24 01 61 24 01 08 01 00 03 24 01 0A 26 00 0B 46 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6106
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-128
 classtype:attempted-user
 sid:36967
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word OGL module out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|02 04 00 00 03 24 03 61 24 03 00 04 00 00 03 24 01 61 24 01 08 01 00 03 24 01 0A 26 00 0B 46 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6106
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-128
 classtype:attempted-user
 sid:36966
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word gdiplus integer overflow attempt"
 flow:to_server,established
 file_data
 content:"|2B 15 68 16 13 A5 00 16 68 2F 7D 31 00 35 08 81 43 4A 20 00 61 4A 20 00 66 48 00 99 6F 28 01 71|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6107
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-128
 classtype:attempted-user
 sid:36965
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word gdiplus integer overflow attempt"
 flow:to_client,established
 file_data
 content:"|2B 15 68 16 13 A5 00 16 68 2F 7D 31 00 35 08 81 43 4A 20 00 61 4A 20 00 66 48 00 99 6F 28 01 71|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6107
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-128
 classtype:attempted-user
 sid:36964
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word XML parsing use after free attempt"
 flow:to_server,established
 file_data
 content:"|75 EF C1 4E 11 EE 13 76 0B 97 04 A4 65 87 82 99 FE C6 65 4D DA 9D A4 9C 8F 2F 4D 09 6A A5 64 BE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36961
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word XML parsing use after free attempt"
 flow:to_client,established
 file_data
 content:"|75 EF C1 4E 11 EE 13 76 0B 97 04 A4 65 87 82 99 FE C6 65 4D DA 9D A4 9C 8F 2F 4D 09 6A A5 64 BE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36960
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel StyleXF invalid icvXF out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|E0 00 14 00 05 00 2C 00 F5 FF 20 00 00 F8 00 00 00 00 00 00 00 00 C0 60 E0 00 14 00 18 00 2A 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6122
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-131
 classtype:attempted-user
 sid:36959
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel StyleXF invalid icvXF out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|E0 00 14 00 05 00 2C 00 F5 FF 20 00 00 F8 00 00 00 00 00 00 00 00 C0 60 E0 00 14 00 18 00 2A 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6122
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-131
 classtype:attempted-user
 sid:36958
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word pointer release validation use after free attempt"
 flow:to_server,established
 file_data
 content:"|B2 04 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 06 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36935
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word pointer release validation use after free attempt"
 flow:to_client,established
 file_data
 content:"|B2 04 FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF 06 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36934
 rev:2
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office wuaext.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/wuaext.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-6133
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36931
 rev:2
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office wuaext.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"w|00|u|00|a|00|e|00|x|00|t|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x17\\x00|\\x00\\x5C)\\x00w\\x00u\\x00a\\x00e\\x00x\\x00t\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2015-6133
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-132
 classtype:attempted-user
 sid:36930
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel MSO reference count use after free attempt"
 flow:to_server,established
 file_data
 content:"|D1 7F EF 90 92 63 27 59 74 0B BB 40 6D 80 E2 75 38 3C 73 E6 72 FF E1 D0 70 F4 4C 55 C7 A4 C8 B1|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6040
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36925
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel MSO reference count use after free attempt"
 flow:to_client,established
 file_data
 content:"|D1 7F EF 90 92 63 27 59 74 0B BB 40 6D 80 E2 75 38 3C 73 E6 72 FF E1 D0 70 F4 4C 55 C7 A4 C8 B1|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6040
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-131
 classtype:attempted-user
 sid:36924
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office RTF parser heap overflow attempt"
 flow:to_server,established
 file_data
 content:"FF020202FF010101FF000000FF010101FF000000FF000000FF000000FF000000FF}}}|0D 0A|}}{|5C|shp"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0010
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-004
 classtype:attempted-user
 sid:37274
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office RTF parser heap overflow attempt"
 flow:to_client,established
 file_data
 content:"FF020202FF010101FF000000FF010101FF000000FF000000FF000000FF000000FF}}}|0D 0A|}}{|5C|shp"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0010
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-004
 classtype:attempted-user
 sid:37273
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office metafile conversion out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|87 03 05 95 16 01 29 15 B4 55 25 92 16 15 A9 15 12 BF 0A AA DA 5C 9F 77 6E D7 BE A4 4E 70 28 6A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0008
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-005
 classtype:attempted-user
 sid:37266
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office metafile conversion out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|87 03 05 95 16 01 29 15 B4 55 25 92 16 15 A9 15 12 BF 0A AA DA 5C 9F 77 6E D7 BE A4 4E 70 28 6A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0008
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-005
 classtype:attempted-user
 sid:37265
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office api-ms-win-core-winrt-l1-1-0.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/api-ms-win-core-winrt-l1-1-0.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0018
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37264
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office api-ms-win-core-winrt-l1-1-0.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"a|00|p|00|i|00|-|00|m|00|s|00|-|00|w|00|i|00|n|00|-|00|c|00|o|00|r|00|e|00|-|00|w|00|i|00|n|00|r|00|t|00|-|00|l|00|1|00|-|00|1|00|-|00|0|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0018
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37263
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office mfplat.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/mfplat.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0016
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37262
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office mfplat.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"m|00|f|00|p|00|l|00|a|00|t|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x17\\x00|\\x00\\x5C)\\x00m\\x00f\\x00p\\x00l\\x00a\\x00t\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0016
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37261
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel mso20win32client use after free attempt"
 flow:to_server,established
 file_data
 content:"|43 52 0D 7D 55 C6 3D 66 8C D0 9D 3F B6 C7 B8 18 AB 76 09 7D 62 91 D8 9B 9A EC 95 58 AA 3B 75 AE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0035
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-004
 classtype:attempted-user
 sid:37260
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel mso20win32client use after free attempt"
 flow:to_client,established
 file_data
 content:"|43 52 0D 7D 55 C6 3D 66 8C D0 9D 3F B6 C7 B8 18 AB 76 09 7D 62 91 D8 9B 9A EC 95 58 AA 3B 75 AE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0035
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-004
 classtype:attempted-user
 sid:37259
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word ActiveX object uninitialized memory access attempt"
 flow:to_server,established
 file_data
 content:"|37 D6 77 4E 4B C6 57 DE 7E 2E B7 6D 46 13 DE 5F 6F 8A 31 60 5E 44 24 71 47 F2 AA F6 BE 1A EE F2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1770
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:37410
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word ActiveX object uninitialized memory access attempt"
 flow:to_client,established
 file_data
 content:"|37 D6 77 4E 4B C6 57 DE 7E 2E B7 6D 46 13 DE 5F 6F 8A 31 60 5E 44 24 71 47 F2 AA F6 BE 1A EE F2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1770
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-059
 classtype:attempted-user
 sid:37409
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel hlink.dll string duplication input validation information disclosure attempt"
 flow:to_server,established
 file_data
 content:"|51 1E 3D C1 05 8C 48 E0 21 D3 05 65 66 61 40 75 6C 74 44 69 72 B4 06 5C 83 60 83 85 0B 27 20 4F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0059
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-recon
 sid:37617
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel hlink.dll string duplication input validation information disclosure attempt"
 flow:to_client,established
 file_data
 content:"|51 1E 3D C1 05 8C 48 E0 21 D3 05 65 66 61 40 75 6C 74 44 69 72 B4 06 5C 83 60 83 85 0B 27 20 4F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0059
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-recon
 sid:37616
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word rtf file bitmap width integer overflow attempt"
 flow:to_server,established
 file_data
 content:"{|5C|rtf1{|5C|pict|5C|wbitmap0|5C|picw117|5C|pi"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0052
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-015
 classtype:attempted-user
 sid:37607
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word rtf file bitmap width integer overflow attempt"
 flow:to_client,established
 file_data
 content:"{|5C|rtf1{|5C|pict|5C|wbitmap0|5C|picw117|5C|pi"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0052
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-015
 classtype:attempted-user
 sid:37606
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Powerpoint shape objects null pointer dereference memory corruption attempt"
 flow:to_server,established
 file_data
 content:"word/_rels/webSettings.xml.rels"
 fast_pattern:only
 content:"|01 02 2D 00 14 00 06 00 08 00 00 00 21 00 93 1C 78 62 E0 06|"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37601
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Powerpoint shape objects null pointer dereference memory corruption attempt"
 flow:to_client,established
 file_data
 content:"word/_rels/webSettings.xml.rels"
 fast_pattern:only
 content:"|01 02 2D 00 14 00 06 00 08 00 00 00 21 00 93 1C 78 62 E0 06|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37600
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word external document access use-after-free attempt"
 flow:to_server,established
 file_data
 content:"Target="
 nocase
 content:"http://"
 within:20
 nocase
 content:".docx"
 within:40
 nocase
 content:"TargetMode="
 within:40
 nocase
 content:"External"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37599
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word external document access use-after-free attempt"
 flow:to_client,established
 file_data
 content:"Target="
 nocase
 content:"http://"
 within:20
 nocase
 content:".docx"
 within:40
 nocase
 content:"TargetMode="
 within:40
 nocase
 content:"External"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37598
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel formula length heap corruption attempt"
 flow:to_server,established
 file_data
 content:"|35 3B D9 E5 CE C8 31 DA 9A BE 93 4B CB FD 0C 08 E1 7F E1 91 41 22 D3 5A B7 C9 43 CC 9F 74 E7 9F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0054
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37593
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel formula length heap corruption attempt"
 flow:to_client,established
 file_data
 content:"|35 3B D9 E5 CE C8 31 DA 9A BE 93 4B CB FD 0C 08 E1 7F E1 91 41 22 D3 5A B7 C9 43 CC 9F 74 E7 9F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0054
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37592
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office Word OLMAPI32.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"O|00|L|00|M|00|A|00|P|00|I|00|3|00|2|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-014
 classtype:attempted-user
 sid:37591
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office Word BCSRuntime.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"B|00|C|00|S|00|R|00|u|00|n|00|t|00|i|00|m|00|e|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-014
 classtype:attempted-user
 sid:37590
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office Word OLMAPI32.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/OLMAPI32.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-014
 classtype:attempted-user
 sid:37589
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office Word BCSRuntime.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/BCSRuntime.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-014
 classtype:attempted-user
 sid:37588
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Powerpoint shape object null pointer dereference attempt"
 flow:to_server,established
 file_data
 content:"|0B 11 37 5D 88 62 8B F8 13 DC 15 DD 48 89 8B E9 B4 52 48 8B 07 2E 3C E7 E5 9C 73 EF 3D E7 5E 48|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0055
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37580
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Powerpoint shape object null pointer dereference attempt"
 flow:to_client,established
 file_data
 content:"|0B 11 37 5D 88 62 8B F8 13 DC 15 DD 48 89 8B E9 B4 52 48 8B 07 2E 3C E7 E5 9C 73 EF 3D E7 5E 48|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0055
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-015
 classtype:attempted-user
 sid:37579
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word rtf file ffdefres integer underflow attempt"
 flow:to_server,established
 file_data
 flowbits:isset,file.rtf|file.ole
 content:"|5C|rtf"
 content:"|5C|field"
 distance:0
 content:"|5C|fldinst"
 within:50
 content:"|5C|formfield"
 distance:0
 content:"|5C|ffdefres-"
 within:50
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0053
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-015
 classtype:attempted-user
 sid:37560
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word rtf file ffdefres integer underflow attempt"
 flow:to_client,established
 file_data
 flowbits:isset,file.rtf|file.ole
 content:"|5C|rtf"
 content:"|5C|field"
 distance:0
 content:"|5C|fldinst"
 within:50
 content:"|5C|formfield"
 distance:0
 content:"|5C|ffdefres-"
 within:50
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0053
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-015
 classtype:attempted-user
 sid:37559
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office phoneinfo.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"p|00|h|00|o|00|n|00|e|00|i|00|n|00|f|00|o|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0041
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-014
 classtype:attempted-user
 sid:37558
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office msdaora.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"m|00|s|00|d|00|a|00|o|00|r|00|a|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0041
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-014
 classtype:attempted-user
 sid:37557
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office phoneinfo.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/phoneinfo.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0041
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-014
 classtype:attempted-user
 sid:37556
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office msdaora.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/msdaora.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0041
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-014
 classtype:attempted-user
 sid:37555
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|49 65 19 4F A9 DA D6 B6 DA 4A D1 7E B4 AD 95 FA 13 FC 81 17 A2 49 40 04 04 AB 28 A8 B1 45 9D 78|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37707
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|49 65 19 4F A9 DA D6 B6 DA 4A D1 7E B4 AD 95 FA 13 FC 81 17 A2 49 40 04 04 AB 28 A8 B1 45 9D 78|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37706
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|B6 9A 62 AD 55 6B 6D B5 2D DE C3 A5 06 D4 2A 28 22 2A 08 B6 A2 07 43 2B 2A 62 50 F4 BC 7B 4E B0|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37705
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|B6 9A 62 AD 55 6B 6D B5 2D DE C3 A5 06 D4 2A 28 22 2A 08 B6 A2 07 43 2B 2A 62 50 F4 BC 7B 4E B0|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37704
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|6B 3B D4 89 B3 B6 B2 4E 6A 2F E2 61 78 04 DE 80 37 80 47 80 2B 07 DE 80 86 35 4D A4 14 09 A9 70|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37703
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|6B 3B D4 89 B3 B6 B2 4E 6A 2F E2 61 78 04 DE 80 37 80 47 80 2B 07 DE 80 86 35 4D A4 14 09 A9 70|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37702
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|B4 03 3C C4 29 20 6B 0F 74 00 3A 02 9D 00 2F A0 33 D0 05 F0 06 7C 80 AE 80 2F D0 0D E8 0E F4 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37701
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|B4 03 3C C4 29 20 6B 0F 74 00 3A 02 9D 00 2F A0 33 D0 05 F0 06 7C 80 AE 80 2F D0 0D E8 0E F4 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37700
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word ipdesign.dll ActiveX object access attempt"
 flow:to_server,established
 file_data
 content:"496e666f506174682e44657369676e6572576f7264496d706f7274"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-029
 classtype:attempted-user
 sid:38129
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word ipdesign.dll ActiveX object access attempt"
 flow:to_server,established
 file_data
 content:"496e666f506174682e44657369676e6572457863656c496d706f7274"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-029
 classtype:attempted-user
 sid:38128
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word ipdesign.dll ActiveX object access attempt"
 flow:to_client,established
 file_data
 content:"496e666f506174682e44657369676e6572576f7264496d706f7274"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-029
 classtype:attempted-user
 sid:38127
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word ipdesign.dll ActiveX object access attempt"
 flow:to_client,established
 file_data
 content:"496e666f506174682e44657369676e6572457863656c496d706f7274"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-029
 classtype:attempted-user
 sid:38126
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word bitmap stream parsing remote code execution attempt"
 flow:to_server,established
 file_data
 content:"0900000026060F000800FFFFFFFF01000000040000002D0100000400"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0091
 reference:cve,2016-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-030 
 classtype:attempted-user
 sid:38111
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word bitmap stream parsing remote code execution attempt"
 flow:to_client,established
 file_data
 content:"0900000026060F000800FFFFFFFF01000000040000002D0100000400"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0091
 reference:cve,2016-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-030 
 classtype:attempted-user
 sid:38110
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll invalid pointer read attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|08 00 29 59 02 58 B3 6C 08 FF 17 53 AC 4E B5 6B 09 FF B0 65 3A 67 3A 57 39 65 BF 7E 08 FF 00 4E|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0134
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-029
 classtype:attempted-user
 sid:38101
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib.dll invalid pointer read attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|08 00 29 59 02 58 B3 6C 08 FF 17 53 AC 4E B5 6B 09 FF B0 65 3A 67 3A 57 39 65 BF 7E 08 FF 00 4E|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0134
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-029
 classtype:attempted-user
 sid:38100
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel msxml6 ParseElementN use after free attempt"
 flow:to_server,established
 file_data
 content:"|40 97 A6 92 FA 90 D1 E7 DD 26 B8 A3 C4 79 A1 2B A1 8C 86 8C BE 81 A3 F7 EB CF 9F 56 83 B1 C7 5F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0122
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-042
 classtype:attempted-user
 sid:38482
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel msxml6 ParseElementN use after free attempt"
 flow:to_client,established
 file_data
 content:"|40 97 A6 92 FA 90 D1 E7 DD 26 B8 A3 C4 79 A1 2B A1 8C 86 8C BE 81 A3 F7 EB CF 9F 56 83 B1 C7 5F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0122
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-042
 classtype:attempted-user
 sid:38481
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel sheet object use after free attempt"
 flow:to_server,established
 file_data
 content:"|29 00 00 00 00 00 00 5D 00 CE 00 20 00 7C 02 AC 00 01 00 0C 00 F2 04 38 34 00 00 00 00 00 00 5D 00 CE 00 20 00 7C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0139
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-042
 classtype:attempted-user
 sid:38472
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel sheet object use after free attempt"
 flow:to_client,established
 file_data
 content:"|29 00 00 00 00 00 00 5D 00 CE 00 20 00 7C 02 AC 00 01 00 0C 00 F2 04 38 34 00 00 00 00 00 00 5D 00 CE 00 20 00 7C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0139
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-042
 classtype:attempted-user
 sid:38471
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE RFT document malformed header"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|7B 5C|rtvpn"
 depth:7
 metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service smtp
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:38581
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE RFT document malformed header"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|7B 5C|rtvpn"
 depth:7
 metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:38580
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office document with auto-start VBA macro detected"
 flow:to_server,established
 file_data
 content:"|00|Document_Open"
 content:"|00|Run"
 content:"|00|CreateObject"
 content:"|00|CallByName"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 classtype:attempted-user
 sid:38640
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office document with auto-start VBA macro detected"
 flow:to_client,established
 file_data
 content:"|00|Document_Open"
 content:"|00|Run"
 content:"|00|CreateObject"
 content:"|00|CallByName"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 classtype:attempted-user
 sid:38639
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word TTF out-of-bounds memory access attempt"
 flow:to_server,established
 flowbits:isset,file.docx
 file_data
 content:"|BE B9 76 67 F6 9C 9D 63 67 47 D7 EE 0A 59 08 04 36 08 24 64 AD 0C 26 8A C4 19 21 09 01 06 1C 1B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0126
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-054
 classtype:attempted-user
 sid:38783
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word TTF out-of-bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.docx
 file_data
 content:"|BE B9 76 67 F6 9C 9D 63 67 47 D7 EE 0A 59 08 04 36 08 24 64 AD 0C 26 8A C4 19 21 09 01 06 1C 1B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0126
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-054
 classtype:attempted-user
 sid:38782
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel malformed XLS out of bounds memory read attempt"
 flow:to_server,established
 file_data
 content:"|03 E4 72 94 46 3F A5 AA 28 94 8C 1A 73 9E EE B5 4E 76 C4 08 A9 E6 09 A9 6C 7A 96 08 B9 8C 32 E8|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3233
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-070
 classtype:attempted-user
 sid:39224
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel malformed XLS out of bounds memory read attempt"
 flow:to_client,established
 file_data
 content:"|03 E4 72 94 46 3F A5 AA 28 94 8C 1A 73 9E EE B5 4E 76 C4 08 A9 E6 09 A9 6C 7A 96 08 B9 8C 32 E8|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3233
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-070
 classtype:attempted-user
 sid:39223
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word mso.dll subcomponent use after free attempt"
 flow:to_server,established
 file_data
 content:"|31 24 01 61 24 02 00 0B 10 00 03 24 01 0C 24 01 13 A4 78 00 14 A4 78 00 31 24 01 61 24 01 00 0B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0025
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-070
 classtype:attempted-user
 sid:39222
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word mso.dll subcomponent use after free attempt"
 flow:to_client,established
 file_data
 content:"|31 24 01 61 24 02 00 0B 10 00 03 24 01 0C 24 01 13 A4 78 00 14 A4 78 00 31 24 01 61 24 01 00 0B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0025
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-070
 classtype:attempted-user
 sid:39221
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FF FE|"
 depth:2
 offset:28
 content:"|03 91 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|D2 7D|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39428
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FF FE|"
 depth:2
 offset:28
 content:"|03 91 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|9B A3|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39427
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|A9 03 00 00|"
 distance:0
 isdataat:50,relative
 content:!"|00|"
 within:50
 content:"|D6 06|"
 within:2
 distance:50
 isdataat:885,relative
 content:!"|00|"
 within:885
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39426
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|91 03 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|A3 9B|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39425
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|91 03 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|7D D2|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39424
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|03 A9 00 00|"
 distance:0
 isdataat:50,relative
 content:!"|00|"
 within:50
 content:"|06 D6|"
 within:2
 distance:50
 isdataat:885,relative
 content:!"|00|"
 within:885
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39423
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FF FE|"
 depth:2
 offset:28
 content:"|03 A9 00 00|"
 distance:0
 isdataat:50,relative
 content:!"|00|"
 within:50
 content:"|06 D6|"
 within:2
 distance:50
 isdataat:885,relative
 content:!"|00|"
 within:885
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39422
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FF FE|"
 depth:2
 offset:28
 content:"|03 91 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|D2 7D|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39421
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FF FE|"
 depth:2
 offset:28
 content:"|03 91 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|9B A3|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39420
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|A9 03 00 00|"
 distance:0
 isdataat:50,relative
 content:!"|00|"
 within:50
 content:"|D6 06|"
 within:2
 distance:50
 isdataat:885,relative
 content:!"|00|"
 within:885
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39419
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|91 03 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|A3 9B|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39418
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Symantec multiple product Dec2SS PowerPoint file buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ppt
 file_data
 content:"|FE FF|"
 depth:2
 offset:28
 content:"|91 03 00 00|"
 distance:0
 isdataat:502,relative
 content:!"|00|"
 within:502
 content:"|7D D2|"
 within:2
 distance:502
 isdataat:409,relative
 content:!"|00|"
 within:409
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2209
 reference:url,symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&year=&suid=20160628_00
 classtype:attempted-user
 sid:39417
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE RTF document incorrect file magic attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|7B 5C|rt|0D 3C|"
 depth:6
 metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service smtp
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:39527
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE RTF document incorrect file magic attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|7B 5C|rt|0D 3C|"
 depth:6
 metadata:policy balanced-ips drop, policy security-ips drop, ruleset community, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1641
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-033
 classtype:attempted-user
 sid:39526
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel empty bookViews element denial of service attempt"
 flow:to_server,established
 flowbits:isset,file.xlsx
 file_data
 content:"/workbook.xml|8D 91 4D 6A C3 30 10 85 AF 22 B4 8F 65 17 5A 8A B1 9D 4D 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3284
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-dos
 sid:39525
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel empty bookViews element denial of service attempt"
 flow:to_client,established
 flowbits:isset,file.xlsx
 file_data
 content:"/workbook.xml|8D 91 4D 6A C3 30 10 85 AF 22 B4 8F 65 17 5A 8A B1 9D 4D 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3284
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-dos
 sid:39524
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word unsupported XML schema out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|68 00 74 00 74 00 70 00 3A 00 2F 00 2F 00|"
 content:"|00 2E 00 78 00 6D 00 6C 00 00 00|"
 within:150
 content:"|FF FF 00 00 00 00|"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3282
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39523
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word unsupported XML schema out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|68 00 74 00 74 00 70 00 3A 00 2F 00 2F 00|"
 content:"|00 2E 00 78 00 6D 00 6C 00 00 00 FF FF 00 00 00 00|"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3282
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39522
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word unsupported XML schema out of bounds read attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|68 00 74 00 74 00 70 00 3A 00 2F 00 2F 00|"
 content:"|00 2E 00 78 00 6D 00 6C 00 00 00 FF FF 00 00 00 00|"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3282
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39520
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib out of bounds memory access attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"dpgroup"
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3280
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39519
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib out of bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"dpgroup"
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 content:"dpgroup"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3280
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39518
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib out-of-bounds memory access attempt"
 flow:to_server,established
 flowbits:isset,file.doc
 file_data
 content:"|F4 C7 01 00 02 C8 01 00 04 C8 01 00 7C C8 01 00 8A C8 01 00 8C C8 01 00 C4 C8 01 00 C8 C8 01 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3281
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39504
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib out-of-bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.doc
 file_data
 content:"|F4 C7 01 00 02 C8 01 00 04 C8 01 00 7C C8 01 00 8A C8 01 00 8C C8 01 00 C4 C8 01 00 C8 C8 01 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3281
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-088
 classtype:attempted-user
 sid:39503
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office mso.dll out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"|80 1E 34 54 DE 2A DA E2 35 5A 2E CA 24 DE 32 A4 2D 0A 2F 1F 80 DE EC F2 BE 20 E4 07 CD F2 08 EB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3313
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-099
 classtype:attempted-user
 sid:39838
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office mso.dll out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"|80 1E 34 54 DE 2A DA E2 35 5A 2E CA 24 DE 32 A4 2D 0A 2F 1F 80 DE EC F2 BE 20 E4 07 CD F2 08 EB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3313
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-099
 classtype:attempted-user
 sid:39837
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Word malformed jpeg memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|5C|*|5C|shppict"
 nocase
 content:"|5C|pict"
 within:100
 nocase
 content:"|5C|jpegblip"
 within:100
 nocase
 content:"0000000000000000"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3318
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-099
 classtype:attempted-admin
 sid:39836
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Word malformed jpeg memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|5C|*|5C|shppict"
 nocase
 content:"|5C|pict"
 within:100
 nocase
 content:"|5C|jpegblip"
 within:100
 nocase
 content:"0000000000000000"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3318
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-099
 classtype:attempted-admin
 sid:39835
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Word wwlib out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|nesttableprops"
 fast_pattern:only
 content:"|5C|nestrow"
 nocase
 content:"|5C|nestcell"
 nocase
 content:"|5C|gridtbl"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3317
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-099
 classtype:attempted-recon
 sid:39832
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Word wwlib out of bounds read attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|nesttableprops"
 fast_pattern:only
 content:"|5C|nestrow"
 nocase
 content:"|5C|nestcell"
 nocase
 content:"|5C|gridtbl"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3317
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-099
 classtype:attempted-recon
 sid:39831
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"FILE-OFFICE Microsoft Windows RTF file with embedded object package SMTP upload attempt"
 flow:to_server,established
 file_data
 content:"{|5C|rt"
 nocase
 content:"{|5C|object|5C|objemb{|5C|*|5C|objclass Package}"
 distance:0
 nocase
 flowbits:set,file.rtf.embed
 metadata:service smtp
 reference:url,en.wikipedia.org/wiki/Rich_Text_Format
 classtype:misc-activity
 sid:39903
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office PowerPoint ppcore invalid pointer reference attempt"
 flow:to_server,established
 file_data
 content:"|7D EB 06 A6 AC AB F5 A3 CF 3A 1E 85 5E 66 15 7F 04 50 5A 7A 68 D6 1F B3 CA 42 28 60 16 8A A8 1A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3360
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40148
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office PowerPoint ppcore invalid pointer reference attempt"
 flow:to_client,established
 file_data
 content:"|7D EB 06 A6 AC AB F5 A3 CF 3A 1E 85 5E 66 15 7F 04 50 5A 7A 68 D6 1F B3 CA 42 28 60 16 8A A8 1A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3360
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40147
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsb
 file_data
 content:"|34 67 E6 CC F4 FB BE 7B EE 39 67 CE 3C 15 78 22 FC 81 E4 CE A7 0F DF 3C DB 5F AE CC 46 43 9F 37|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3381
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40122
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsb
 file_data
 content:"|34 67 E6 CC F4 FB BE 7B EE 39 67 CE 3C 15 78 22 FC 81 E4 CE A7 0F DF 3C DB 5F AE CC 46 43 9F 37|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3381
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40121
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsb
 file_data
 content:"|C4 83 0F 66 E6 9B 79 F3 7D 6F DE DC 23 AC 52 26 EB FE 7E FD FC FD 68 E7 ED 99 4A 69 F6 CD 87 AF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3362
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40117
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsb
 file_data
 content:"|C4 83 0F 66 E6 9B 79 F3 7D 6F DE DC 23 AC 52 26 EB FE 7E FD FC FD 68 E7 ED 99 4A 69 F6 CD 87 AF|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3362
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40116
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsb
 file_data
 content:"|DA 83 58 E8 CD 43 51 A4 D0 43 0F F5 D4 AB 2D 5E 3C 08 DE 43 C6 DF FB 66 76 E6 65 76 12 07 E2 34|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3359
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40107
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsb
 file_data
 content:"|DA 83 58 E8 CD 43 51 A4 D0 43 0F F5 D4 AB 2D 5E 3C 08 DE 43 C6 DF FB 66 76 E6 65 76 12 07 E2 34|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3359
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40106
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsb
 file_data
 content:"|56 5B 44 D6 D0 D6 5F D0 10 0D 35 37 B5 37 94 B8 B4 B9 47 75 EE 67 61 75 1F EF BD 7B EE 3B 3F DE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3358
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40105
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsb
 file_data
 content:"|56 5B 44 D6 D0 D6 5F D0 10 0D 35 37 B5 37 94 B8 B4 B9 47 75 EE 67 61 75 1F EF BD 7B EE 3B 3F DE|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3358
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40104
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_server,established
 flowbits:isset,file.xlsb
 file_data
 content:"|AB DF 46 F9 3B 44 51 1A A1 97 22 14 C1 F2 D4 0E 6F 11 3D 15 F4 56 F4 D5 20 B5 A3 5F BE 45 94 1E|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3358
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40103
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel xlsb use-after-free attempt"
 flow:to_client,established
 flowbits:isset,file.xlsb
 file_data
 content:"|AB DF 46 F9 3B 44 51 1A A1 97 22 14 C1 F2 D4 0E 6F 11 3D 15 F4 56 F4 D5 20 B5 A3 5F BE 45 94 1E|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3358
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-admin
 sid:40102
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel Ordinal43 out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|0D 00 FF 00 00 00 00 00 80 01 34 00 08 02 10 00 16 00 00 00 0D 00 FF 00 00 00 00 00 80 01 34 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3363
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40083
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel Ordinal43 out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|0D 00 FF 00 00 00 00 00 80 01 34 00 08 02 10 00 16 00 00 00 0D 00 FF 00 00 00 00 00 80 01 34 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3363
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40082
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OFFICE Microsoft Office Visio visdlgu.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"v|00|i|00|s|00|d|00|l|00|g|00|u|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-3364
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40080
 rev:3
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OFFICE Microsoft Office Visio visdlgu.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/visdlgu.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-3364
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40079
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Office Excel LPenHelper out of bounds write attempt"
 flow:to_server,established
 file_data
 content:"|D8 F7 6F DB 46 14 00 60 93 C7 13 49 D9 F2 88 57 9C 38 71 3C E3 BD 92 36 A3 49 9C D9 BD F7 DE BB E8 04 BA 0B 74|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3365
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40076
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Office Excel LPenHelper out of bounds write attempt"
 flow:to_client,established
 file_data
 content:"|D8 F7 6F DB 46 14 00 60 93 C7 13 49 D9 F2 88 57 9C 38 71 3C E3 BD 92 36 A3 49 9C D9 BD F7 DE BB E8 04 BA 0B 74|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3365
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-107
 classtype:attempted-user
 sid:40075
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Word RTF file parsing buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|objemb"
 content:"|5C|objclass otkloadr."
 distance:0
 fast_pattern
 content:"|5C|objdata"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-7193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-121
 classtype:attempted-user
 sid:40369
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Word RTF file parsing buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|objemb"
 content:"|5C|objclass otkloadr."
 distance:0
 fast_pattern
 content:"|5C|objdata"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-7193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-121
 classtype:attempted-user
 sid:40368
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OFFICE Microsoft Excel malicious cce value following a PtgMemFunc token"
 flow:to_server,established
 flowbits:isset,file.xls
 file_data
 content:"|06 00 26 00 9C 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05 00 29 08 01 00 00 00|"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1315
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:40460
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OFFICE Microsoft Excel malicious cce value following a PtgMemFunc token"
 flow:to_client,established
 flowbits:isset,file.xls
 file_data
 content:"|06 00 26 00 9C 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 05 00 29 08 01 00 00 00|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1315
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-073
 classtype:attempted-user
 sid:40459
 rev:1
)\n']
