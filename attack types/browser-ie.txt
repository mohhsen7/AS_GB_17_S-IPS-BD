['alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"
 flow:to_client,established
 file_data
 content:"CollectGarbage()"
 fast_pattern:only
 content:".createElement"
 nocase
 content:"xml"
 within:10
 nocase
 content:".setAttributeNode"
 within:100
 nocase
 content:".XMLDocument"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3114
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26890
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"
 flow:to_server,established
 file_data
 content:"jquery"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:".document.body.appendChild"
 within:100
 nocase
 content:".replaceAll"
 within:150
 nocase
 pcre:"/css\\s*?\\x28\\s*?[\\x22\\x27]margin[^\\x29]*?[\\x22\\x27]\\s*?\\x2c\\s*?[\\x22\\x27]\\d{12,}\\s*?px/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26889
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"jquery"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:".document.body.appendChild("
 within:100
 nocase
 content:".replaceAll("
 within:150
 nocase
 pcre:"/css\\s*?\\x28\\s*?[\\x22\\x27]margin[^\\x29]*?[\\x22\\x27]\\s*?\\x2c\\s*?[\\x22\\x27]\\d{12,}\\s*?px/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26888
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_server,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"location.reload("
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?location\\.reload\\(.*?<body[^>]*?onload\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26887
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_server,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"history.go(0)"
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?history\\.go\\(\\s*0\\s*\\).*?<body[^>]*?onload\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26886
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_server,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"<meta"
 content:"http-equiv=|22|refresh|22|"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26885
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_client,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"location.reload("
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?location\\.reload\\(.*?<body[^>]*?onload\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26884
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_client,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"history.go(0)"
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?history\\.go\\(\\s*0\\s*\\).*?<body[^>]*?onload\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26883
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_client,established
 file_data
 content:"<body onload"
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"<meta"
 content:"http-equiv=|22|refresh|22|"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26882
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 tree element use after free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementById"
 nocase
 content:"appendChild"
 within:50
 nocase
 content:"ClientRects"
 within:50
 fast_pattern
 nocase
 content:"p id"
 distance:0
 content:"p id"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3110
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26878
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 cached display node use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagName(|22|input|22|)[0].focus()"
 content:"document.getElementsByTagName(|22|input|22|)[0].applyElement(a)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3116
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26876
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTreeNodeobject use-after-free attempt"
 flow:to_client,established
 file_data
 content:"div1.removeEventListener( |27|DOMNodeRemoved|27|, callback, true )"
 fast_pattern:only
 content:"addEventListener"
 content:"DOMNodeRemoved"
 within:40
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3119
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26875
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 CSS rules cache use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementsByTagName(|22|link|22|)[0].href"
 fast_pattern:only
 content:"document.createStyleSheet"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26874
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CSS rules cache use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagName(|22|link|22|)[0].href"
 fast_pattern:only
 content:"document.createStyleSheet"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3117
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26873
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_server,established
 file_data
 content:"www.w3.org"
 nocase
 content:"document.getElementsByTagNameNS("
 within:100
 nocase
 content:"removeAttributeNS("
 within:100
 nocase
 content:"null"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26872
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"www.w3.org"
 nocase
 content:"document.getElementsByTagNameNS("
 within:100
 nocase
 content:"removeAttributeNS("
 within:100
 nocase
 content:"null"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26871
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.getElementsByTagNameNS("
 nocase
 content:"www.w3.org"
 within:50
 nocase
 content:"removeAttributeNS("
 nocase
 content:"null"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26870
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagNameNS("
 nocase
 content:"www.w3.org"
 within:50
 nocase
 content:"removeAttributeNS("
 nocase
 content:"null"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26869
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 select element deleted object access attempt"
 flow:to_server,established
 file_data
 content:"document.body.appendChild(document.createElement(\'select\'))"
 fast_pattern:only
 content:"document.getElementsByTagName(\'select\')"
 nocase
 content:"parentNode.removeChild(document.getElementsByTagName(\'select\')"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3139
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26868
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 select element deleted object access attempt"
 flow:to_client,established
 file_data
 content:"document.body.appendChild(document.createElement(\'select\'))"
 fast_pattern:only
 content:"document.getElementsByTagName(\'select\')"
 nocase
 content:"parentNode.removeChild(document.getElementsByTagName(\'select\')"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3139
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26867
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer create-add range on DOM objects memory corruption attempt"
 flow:to_server,established
 file_data
 content:".addRange("
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".createRange()"
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26853
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer create-add range on DOM objects memory corruption attempt"
 flow:to_client,established
 file_data
 content:".addRange("
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".addRange("
 within:1024
 content:".createRange()"
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 content:".createRange()"
 within:1024
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26852
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 5 compatibility mode use after free attempt"
 flow:to_client,established
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"
 fast_pattern:only
 content:".runtimeStyle.setExpression"
 content:"document.body.innerHTML"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3121
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26851
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer superscript use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand"
 nocase
 content:"selectall"
 within:20
 nocase
 content:"setTimeout"
 nocase
 content:"Node("
 within:170
 nocase
 content:"document."
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3111
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26849
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_client,established
 file_data
 content:"for (var i = 0|3B| i < param.childNodes.length|3B| i++)"
 content:"document.selection.createRange().pasteHTML(\'<td>2<nobr>\')"
 fast_pattern:only
 content:"document.selection.createRange().pasteHTML(\'<td>3\')"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3125
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26847
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 insertImage with designMode on deleted object access attempt"
 flow:to_server,established
 file_data
 content:"window.open"
 nocase
 content:".eval"
 distance:0
 content:"document.designMode"
 distance:0
 nocase
 content:"on"
 distance:0
 nocase
 content:"window.getSelection"
 distance:0
 nocase
 content:"document.designMode"
 distance:0
 nocase
 content:"off"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3120
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26846
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 insertImage with designMode on deleted object access attempt"
 flow:to_client,established
 file_data
 content:"window.open"
 nocase
 content:".eval"
 distance:0
 content:"document.designMode"
 distance:0
 fast_pattern
 nocase
 content:"on"
 distance:0
 nocase
 content:"window.getSelection"
 distance:0
 nocase
 content:"document.designMode"
 distance:0
 nocase
 content:"off"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3120
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26845
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 layout engine memory corruption attempt"
 flow:to_client,established
 file_data
 content:"}catch|28|"
 content:"|29|{}try{"
 within:10
 content:"obj,obj,obj,obj,obj"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3122
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26844
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 array element property use after free attempt"
 flow:to_client,established
 file_data
 content:"new Array"
 content:".push|28|"
 distance:0
 content:".appendChild|28|"
 content:"onpropertychange"
 content:"applyElement"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3112
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:26843
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"
 flow:to_server,established
 file_data
 content:"<input type=|22|text|22| style=|22|zoom:10|22|/>"
 fast_pattern:only
 content:"<body onload=|22|history.go(0)|22|>"
 content:"<img style=|22|float:right|22|/>"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1309
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26754
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"
 flow:to_client,established
 file_data
 content:"<input type=|22|text|22| style=|22|zoom:10|22|/>"
 fast_pattern:only
 content:"<body onload=|22|history.go(0)|22|>"
 content:"<img style=|22|float:right|22|/>"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1309
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26753
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"
 flow:to_client,established
 content:"offsetParent"
 fast_pattern
 content:"null"
 within:10
 nocase
 content:"createElement"
 content:"datalist"
 within:20
 content:"createElement"
 content:"table"
 within:20
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038
 classtype:attempted-user
 sid:26668
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ANIMATECOLOR SMIL access attempt"
 flow:to_client,established
 file_data
 content:"<?IMPORT namespace=|22|t|22| implementation=|22|#default#time2|22|>"
 fast_pattern:only
 content:"<t:ANIMATECOLOR id=|22|myanim|22|/>"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1347
 classtype:attempted-user
 sid:26666
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.createElement("
 nocase
 content:".runtimeStyle"
 within:100
 fast_pattern
 nocase
 content:".border"
 within:100
 nocase
 pcre:"/var\\s+?(?P<var>[^\\s]+?)\\s*?=\\s*?document\\.createElement\\(.*?(?P=var)\\.runtimeStyle.*?\\.border[^=\\x3b]*?=\\s*?[^\\x3b]*?[\\x22\\x27](\\d+?\\s|\\s+?\\d)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1307
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26642
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer runtimeStyle memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.createElement("
 nocase
 content:".runtimeStyle"
 within:100
 fast_pattern
 nocase
 content:".border"
 within:100
 nocase
 pcre:"/var\\s+?(?P<var>[^\\s]+?)\\s*?=\\s*?document\\.createElement\\(.*?(?P=var)\\.runtimeStyle.*?\\.border[^=\\x3b]*?=\\s*?[^\\x3b]*?[\\x22\\x27](\\d+?\\s|\\s+?\\d)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1307
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26641
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML array with negative length memory corruption attempt"
 flow:to_client,established
 file_data
 content:"#default#VML"
 content:".dashstyle.array.length"
 fast_pattern:only
 pcre:"/\\.dashstyle\\.array\\.length\\s*?=[^\\x3b]*?-\\s*?\\d/i"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,58570
 reference:cve,2013-2551
 reference:url,osvdb.org/show/osvdb/91197
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26638
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DCOMTextNode object use after free attempt"
 flow:to_server,established
 file_data
 file_data
 content:".getSelection"
 content:".anchorNode.splitText("
 fast_pattern
 content:".focusNode"
 within:60
 content:"CollectGarbage"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1312
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26637
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DCOMTextNode object use after free attempt"
 flow:to_client,established
 file_data
 file_data
 content:".getSelection"
 content:".anchorNode.splitText("
 content:".focusNode"
 within:60
 content:"CollectGarbage"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1312
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26636
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.createElement|28|"
 nocase
 content:".innerHTML"
 distance:0
 nocase
 content:"document.body.appendChild|28|"
 distance:0
 content:"document.styleSheets"
 distance:0
 nocase
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"setTimeout|28|function"
 distance:0
 nocase
 content:"onload=|27|setTimeout"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1311
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26635
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.createElement|28|"
 depth:100
 nocase
 content:".innerHTML"
 distance:0
 nocase
 content:"document.body.appendChild|28|"
 distance:0
 content:"document.styleSheets"
 distance:0
 nocase
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"setTimeout|28|function"
 distance:0
 nocase
 content:"onload=|27|setTimeout"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1311
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26634
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer html reload loop attempt"
 flow:to_client,established
 file_data
 content:"onload"
 content:"location.reload"
 within:25
 content:"|3C|iframe"
 pcre:"/onload\\s*\\x3D\\s*[\\x22\\x27]?location\\.reload\\s*\\x28/smi"
 metadata:policy security-ips drop, policy balanced-ips alert, service http
 reference:bugtraq,59745
 reference:cve,2013-1306
 reference:url,osvdb.org/show/osvdb/93291
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037
 classtype:misc-activity
 sid:26633
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"
 flow:to_server,established
 file_data
 content:"<q class=|22|border float zoom|22| xml:space=|22|preserve|22|>"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1309
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26631
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispNode float css element use after free attempt"
 flow:to_client,established
 file_data
 content:"<q class=|22|border float zoom|22| xml:space=|22|preserve|22|>"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1309
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:26630
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setInterval focus use after free attempt"
 flow:to_client,established
 file_data
 content:"setInterval"
 content:".focus()"
 within:100
 content:"history.go(0)"
 fast_pattern:only
 pcre:"/setInterval\\s*\\x28[^\\x29]+\\x2efocus\\x28\\x29/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-1308
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037
 classtype:attempted-admin
 sid:26629
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"
 flow:to_server,established
 file_data
 content:"Base64.decode"
 base64_decode:bytes 10000,offset 2, relative
 base64_data
 content:"offsetParent"
 fast_pattern
 content:"null"
 within:10
 nocase
 content:"createElement"
 content:"datalist"
 within:20
 content:"createElement"
 content:"table"
 within:20
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038
 classtype:attempted-user
 sid:26572
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"
 flow:to_server,established
 file_data
 content:"offsetParent"
 fast_pattern
 content:"null"
 within:10
 nocase
 content:"createElement"
 content:"datalist"
 within:20
 content:"createElement"
 content:"table"
 within:20
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038
 classtype:attempted-user
 sid:26571
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer null object access attempt"
 flow:to_client,established
 file_data
 content:"offsetParent"
 fast_pattern
 content:"null"
 within:10
 nocase
 content:"createElement"
 content:"datalist"
 within:20
 content:"createElement"
 content:"table"
 within:20
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-038
 classtype:attempted-user
 sid:26569
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_server,established
 content:"setTimeout(\'window.print()"
 content:"onbeforeprint=\'document.write"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26420
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_client,established
 file_data
 content:"setTimeout(\'window.print()"
 content:"onbeforeprint=\'document.write"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26419
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandvalue("
 nocase
 content:"copy"
 within:5
 nocase
 content:"onbeforecopy"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26225
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandvalue("
 nocase
 content:"paste"
 within:6
 nocase
 content:"onbeforepaste"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26224
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandindeterm("
 nocase
 content:"cut"
 within:4
 nocase
 content:"onbeforecut"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26223
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandindeterm("
 nocase
 content:"copy"
 within:5
 nocase
 content:"onbeforecopy"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26222
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandindeterm("
 nocase
 content:"paste"
 within:6
 nocase
 content:"onbeforepaste"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26221
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandenabled("
 nocase
 content:"cut"
 within:4
 nocase
 content:"onbeforecut"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26220
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandenabled("
 nocase
 content:"copy"
 within:5
 nocase
 content:"onbeforecopy"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26219
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandenabled("
 nocase
 content:"paste"
 within:6
 nocase
 content:"onbeforepaste"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26218
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandstate("
 nocase
 content:"cut"
 within:4
 nocase
 content:"onbeforecut"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26217
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandstate("
 nocase
 content:"copy"
 within:5
 nocase
 content:"onbeforecopy"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:26216
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor use after free attempt"
 flow:to_server,established
 file_data
 content:"onload="
 content:"document.onfocusin"
 fast_pattern:only
 content:"document.open(|22 22|)"
 content:"content=|27|IE=9|27|"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0090
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26169
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor use after free attempt"
 flow:to_client,established
 file_data
 content:"onload="
 content:"document.onfocusin"
 fast_pattern:only
 content:"document.open(|22 22|)"
 content:"content=|27|IE=9|27|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0090
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26168
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint="
 content:"document.write"
 within:15
 content:"document.write"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26162
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_server,established
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint"
 fast_pattern:only
 content:"document.write"
 pcre:"/<body.*?onbeforeprint\\s*=\\s*[\\x22\\x27]?(?P<func>\\w*).*?<script.*?function\\s*(?P=func)\\s*\\x28\\x29.*?\\x7b[^\\x7d]*?document\\x2ewrite/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26161
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint"
 fast_pattern:only
 content:"document.write"
 pcre:"/<script.*?function\\s*(?P<func>\\w*)\\s*\\x28\\x29.*?\\x7b[^\\x7d]*?document\\x2ewrite.*?<body.*?onbeforeprint\\s*=\\s*[\\x22\\x27]?(?P=func)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26160
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint="
 content:"document.write"
 within:15
 content:"document.write"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26159
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint"
 fast_pattern:only
 content:"document.write"
 pcre:"/<body.*?onbeforeprint\\s*=\\s*[\\x22\\x27]?(?P<func>\\w*).*?<script.*?function\\s*(?P=func)\\s*\\x28\\x29.*?\\x7b[^\\x7d]*?document\\x2ewrite/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26158
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onbeforeprint use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand"
 content:"print"
 within:15
 nocase
 content:"onbeforeprint"
 fast_pattern:only
 content:"document.write"
 pcre:"/<script.*?function\\s*(?P<func>\\w*)\\s*\\x28\\x29.*?\\x7b[^\\x7d]*?document\\x2ewrite.*?<body.*?onbeforeprint\\s*=\\s*[\\x22\\x27]?(?P=func)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26157
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 onBeforeCopy use after free attempt"
 flow:to_server,established
 file_data
 content:"<body onload=|27|document.execCommand(|22|SelectAll|22|)|3B 27| onbeforecopy="
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0093
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26138
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 onBeforeCopy use after free attempt"
 flow:to_client,established
 file_data
 content:"<body onload=|27|document.execCommand(|22|SelectAll|22|)|3B 27| onbeforecopy="
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0093
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26137
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"
 flow:to_server,established
 file_data
 content:".saveHistory {behavior|3A|url(#default#savehistory)|3B|}"
 fast_pattern:only
 content:"CLASS=saveHistory onsave="
 nocase
 content:"setTimeout"
 content:"document.open()"
 content:"document.createElement("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0089
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26136
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"
 flow:to_client,established
 file_data
 content:".saveHistory {behavior|3A|url(#default#savehistory)|3B|}"
 fast_pattern:only
 content:"CLASS=saveHistory onsave="
 nocase
 content:"setTimeout"
 content:"document.open()"
 content:"document.createElement("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0089
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26135
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<title onreadystatechange ="
 content:"style = \'-ms-behavior: url("
 within:50
 distance:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0091
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26134
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"
 flow:to_server,established
 file_data
 content:"<meta"
 nocase
 content:"name="
 nocase
 content:"save"
 within:15
 nocase
 content:"content="
 nocase
 content:"history"
 within:20
 content:"behavior:"
 nocase
 content:"url"
 within:10
 nocase
 content:"#default#savehistory"
 within:50
 fast_pattern
 nocase
 content:"setTimeout"
 nocase
 content:"history.go(0)"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-dos
 sid:26133
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer saveHistory use after free attempt"
 flow:to_client,established
 file_data
 content:"<meta"
 nocase
 content:"name="
 nocase
 content:"save"
 within:15
 nocase
 content:"content="
 nocase
 content:"history"
 within:20
 content:"behavior:"
 nocase
 content:"url"
 within:10
 nocase
 content:"#default#savehistory"
 within:50
 fast_pattern
 nocase
 content:"setTimeout"
 nocase
 content:"history.go(0)"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-dos
 sid:26132
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer htc file use after free attempt"
 flow:to_server,established
 file_data
 content:"PUBLIC:COMPONENT>"
 content:"<PUBLIC:PROPERTY"
 content:"PUT"
 distance:0
 content:"CollectGarbage()"
 fast_pattern:only
 pcre:"/<PUBLIC:PROPERTY[^>]*?PUT\\s*=\\s*[\\x22\\x27](?P<func>\\w*).*?function\\s*(?P=func).*?\\x7b[^\\x7c]*?CollectGarbage\\x28\\x29/sm"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26130
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer htc file use after free attempt"
 flow:to_client,established
 file_data
 content:"PUBLIC:COMPONENT>"
 content:"<PUBLIC:PROPERTY"
 content:"PUT"
 distance:0
 content:"CollectGarbage()"
 fast_pattern:only
 pcre:"/<PUBLIC:PROPERTY[^>]*?PUT\\s*=\\s*[\\x22\\x27](?P<func>\\w*).*?function\\s*(?P=func).*?\\x7b[^\\x7c]*?CollectGarbage\\x28\\x29/sm"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-021
 classtype:attempted-user
 sid:26129
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG object use after free attempt"
 flow:to_client,established
 file_data
 content:"image x=|22|60|22| y=|22|50|22| width=|22|240|22| height=|22|240|22| xlink|3A|href=|22|2.svg"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0023
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-admin
 sid:25792
 rev:3
)\n', 'alert tcp $HOME_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode invalid memory access attempt"
 flow:to_server,established
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"
 nocase
 content:"attachEvent|28|"
 content:"onreadystatechange"
 within:25
 fast_pattern
 content:".createElement(|22|div|22|)"
 distance:0
 nocase
 content:".removeChild"
 within:256
 nocase
 content:".createElement(|22|div|22|)"
 within:256
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25791
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode invalid memory access attempt"
 flow:to_client,established
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=7|22|"
 nocase
 content:"attachEvent|28|"
 content:"onreadystatechange"
 within:25
 fast_pattern
 content:".createElement(|22|div|22|)"
 distance:0
 nocase
 content:".removeChild"
 within:256
 nocase
 content:".createElement(|22|div|22|)"
 within:256
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25790
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe use after free attempt"
 flow:to_server,established
 file_data
 content:"<iframe"
 nocase
 content:!"src="
 within:40
 content:"></iframe"
 fast_pattern:only
 content:"window.open"
 nocase
 content:"name"
 nocase
 pcre:"/<iframe[^>]+name\\s*=\\s*[\\x22\\x27](?P<iframe_name>\\w+)[\\x22\\x27].*?><\\x2fiframe\\s*>.*?window\\x2eopen\\x28.{1,30}(?P=iframe_name).*?window\\x2eopen\\x28.{1,60}(?P=iframe_name)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0019
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25789
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe use after free attempt"
 flow:to_client,established
 file_data
 content:"<iframe"
 nocase
 content:!"src="
 within:40
 content:"window.open"
 nocase
 content:"></iframe"
 fast_pattern:only
 content:"name"
 nocase
 pcre:"/<iframe(\\s*(name|height|width)\\s*=\\s*[\\x22\\x27]?(?P<iframe_name>\\w+)[\\x22\\x27]?)*><\\x2fiframe\\s*>.*?window\\x2eopen\\x28.{1,30}(?P=iframe_name).*?window\\x2eopen\\x28.{1,60}(?P=iframe_name)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0019
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25788
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<script>"
 nocase
 content:"SelectAll"
 within:60
 nocase
 content:"execCommand|28 22|Justify"
 within:40
 nocase
 content:"execCommand|28 22|Justify"
 within:60
 nocase
 content:"SelectAll"
 within:45
 nocase
 content:"</script>"
 within:16
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,57832
 reference:cve,2013-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25787
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<script>"
 nocase
 content:"SelectAll"
 within:60
 nocase
 content:"execCommand|28 22|Justify"
 within:40
 nocase
 content:"execCommand|28 22|Justify"
 within:60
 nocase
 content:"SelectAll"
 within:45
 nocase
 content:"</script>"
 within:16
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,57832
 reference:cve,2013-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25786
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer text layout calculation use after free attempt"
 flow:to_server,established
 file_data
 content:"<figure"
 nocase
 content:"dir"
 within:50
 nocase
 content:"rtl"
 within:50
 nocase
 content:"&"
 within:50
 pcre:"/<figure[^>]+?dir\\s*?=\\s*?[\\x22\\x27]\\s*?rtl\\s*?[\\x22\\x27].*?(&#?x?[a-z\\d]{2,4}\\x3b){100}/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0022
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25785
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer text layout calculation use after free attempt"
 flow:to_client,established
 file_data
 content:"<figure"
 nocase
 content:"dir"
 within:50
 nocase
 content:"rtl"
 within:50
 nocase
 content:"&"
 within:50
 pcre:"/<figure[^>]+?dir\\s*?=\\s*?[\\x22\\x27]\\s*?rtl\\s*?[\\x22\\x27].*?(&#?x?[a-z\\d]{2,4}\\x3b){100}/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0022
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25784
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG use after free attempt"
 flow:to_client,established
 file_data
 content:".setCapture("
 fast_pattern:only
 content:"<svg"
 nocase
 content:" id="
 distance:0
 nocase
 content:".getElementById("
 distance:0
 nocase
 content:".setCapture("
 distance:0
 nocase
 pcre:"/<svg[^>]*?>.*?<[^>]*?\\sid=(?P<q1>(\\x22|\\x27|))(?P<id1>[^\\x22\\x27\\s>]+?)(?P=q1).*?<[^>]*?\\s+id=(?P<q2>(\\x22|\\x27|))(?P<id2>[^\\x22\\x27\\s>]+?)(?P=q2).*?<\\x2fsvg>.*?<script[^>]*?>.*?(document\\.getElementById\\([^)]*?((?P=id1)|(?P=id2))[^)]*?\\).*?\\.setCapture\\(.*?\\).*?){2}/smiO"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0018
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25778
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.selection.createRange("
 content:"getElementsByTagName("
 within:50
 content:"moveToElementText("
 within:50
 content:"collapse("
 within:50
 content:"select("
 within:50
 content:"pasteHTML("
 within:50
 pcre:"/var\\s+?(?P<range>[^\\s]+?)\\s*?=\\s*?document\\.selection\\.createRange\\([^\\(]*?\\).*?var\\s+?(?P<elements>[^\\s]+?)\\s*?=\\s*?document\\.body\\.getElementsByTagName\\(\\s*?[\\x22\\x27]\\s*?\\*\\s*?[\\x22\\x27]\\s*?\\).*?var\\s+?(?P<el>[^\\s]+?)\\s*?=\\s*?(?P=elements)\\s*?\\[\\s*?\\d\\s*?\\].*?(?P=range)\\.moveToElementText\\(\\s*?(?P=el)\\s*?\\).*?(?P=range)\\.collapse\\(\\s*?true\\s*?\\).*?(?P=range)\\.select\\(.*?(?P=range)\\.pasteHTML\\(/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0024
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25777
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"getElementsByTagName("
 content:"document.selection.createRange("
 within:100
 content:"moveToElementText("
 within:50
 content:"collapse("
 within:50
 content:"select("
 within:50
 content:"pasteHTML("
 within:50
 pcre:"/var\\s+?(?P<elements>[^\\s]+?)\\s*?=\\s*?document\\.body\\.getElementsByTagName\\(\\s*?[\\x22\\x27]\\s*?\\*\\s*?[\\x22\\x27]\\s*?\\).*?var\\s+?(?P<el>[^\\s]+?)\\s*?=\\s*?(?P=elements)\\s*?\\[\\s*?\\d\\s*?\\].*?var\\s+?(?P<range>[^\\s]+?)\\s*?=\\s*?document\\.selection\\.createRange\\([^\\(]*?\\).*?(?P=range)\\.moveToElementText\\(\\s*?(?P=el)\\s*?\\).*?(?P=range)\\.collapse\\(\\s*?true\\s*?\\).*?(?P=range)\\.select\\(.*?(?P=range)\\.pasteHTML\\(/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0024
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25776
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pre-line use after free attempt"
 flow:to_client,established
 file_data
 content:".style.whiteSpace = |22|pre-line|22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0025
 reference:cve,2013-1288
 reference:cve,2015-6050
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-021
 classtype:attempted-user
 sid:25775
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML shape object malformed path attempt"
 flow:to_client,established
 file_data
 content:"document.createElement("
 nocase
 content:"shape"
 nocase
 content:"setAttribute("
 distance:0
 fast_pattern
 nocase
 content:"path"
 within:5
 distance:1
 nocase
 isdataat:506,relative
 content:!")"
 within:506
 pcre:"/var\\s*?(?P<m1>\\w+)s*?=s*?document.createElement\\s*?\\([\\x22\\x27][\\w]s*?[\\x3a\\x3b]\\s*?shape[\\x22\\x27]\\).*?(?P=m1)s*?.\\s*?setAttribute\\s*?\\(\\s*?[\\x22\\x27]\\s*?path\\s*?[\\x22\\x27]\\s*?,\\s*?[\\x22\\x27][^\\x29]{506}.*?(?P=m1)\\.s*?path/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0030
 classtype:attempted-user
 sid:25773
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"
 flow:to_client,established
 file_data
 content:"onbeforeeditfocus"
 nocase
 content:"document.write"
 within:30
 pcre:"/onbeforeeditfocus\\s*?=\\s*?[\\x22\\x27]document\\x2ewrite/ism"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0029
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25772
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer custom cursor file use after free attempt"
 flow:to_client,established
 file_data
 content:"location.reload()"
 nocase
 content:"style"
 distance:0
 nocase
 content:"cursor"
 within:256
 nocase
 content:"|3A|"
 within:5
 content:"URL"
 within:5
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0028
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25771
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"DOMParser"
 fast_pattern:only
 content:"createCDATASection"
 nocase
 content:"|2E|cloneNode"
 nocase
 content:"adoptNode"
 distance:0
 nocase
 content:"CollectGarbage()"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0020
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:25770
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor object use after free attempt"
 flow:to_client,established
 file_data
 content:"querycommandstate("
 nocase
 content:"paste"
 within:6
 nocase
 content:"onbeforepaste"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0027
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:25769
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:"window.location"
 content:"unescape"
 within:30
 content:"http"
 within:30
 pcre:"/window\\x2elocation\\s*=\\s*unescape\\s*\\x28\\s*["\']\\x25[^"\']*https?\\x3a/"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25235
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:"window.location"
 content:"unescape"
 within:30
 content:"http"
 within:30
 pcre:"/window\\x2elocation\\s*=\\s*unescape\\s*\\x28\\s*["\']\\x25[^"\']*https?\\x3a/"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25234
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:"appendChild|28|"
 content:"document.createElement|28|"
 within:50
 content:"button"
 within:20
 content:"outerText"
 within:200
 pcre:"/appendChild\\x28\\s*document\\x2ecreateElement\\x28\\s*[\\x22\\x27]button[\\x22\\x27].*?outerText\\s*=\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25134
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:"|EB D7 77 82 93 D0 7C F6 8B 08 73 08 FD 8B 6B FD|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25133
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:"D27CDB6E-AE6D-11cf-96B8-444553540000"
 content:"<param name=|5C 22|movie|5C 22| value=|5C 22|today.swf|5C 22| />"
 fast_pattern:only
 content:"<iframe src=news.html></iframe>"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25132
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:"jj76jj61jj72jj20jj65jj30jj20jj3D"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25131
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_server,established
 file_data
 content:".replace|28|/jj/g,|22|%|22 29 3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25130
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:"appendChild|28|"
 content:"document.createElement|28|"
 within:50
 content:"button"
 within:20
 content:"outerText"
 within:200
 pcre:"/appendChild\\x28\\s*document\\x2ecreateElement\\x28\\s*[\\x22\\x27]button[\\x22\\x27].*?outerText\\s*=\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25129
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:"|EB D7 77 82 93 D0 7C F6 8B 08 73 08 FD 8B 6B FD|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25128
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:"D27CDB6E-AE6D-11cf-96B8-444553540000"
 content:"<param name=|5C 22|movie|5C 22| value=|5C 22|today.swf|5C 22| />"
 fast_pattern:only
 content:"<iframe src=news.html></iframe>"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25127
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:"jj76jj61jj72jj20jj65jj30jj20jj3D"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 classtype:attempted-user
 sid:25126
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted button use after free attempt"
 flow:to_client,established
 file_data
 content:".replace|28|/jj/g,|22|%|22 29 3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-4792
 reference:url,technet.microsoft.com/en-us/security/advisory/2794220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-008
 classtype:attempted-user
 sid:25125
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTreeNodeobject use-after-free attempt"
 flow:to_client,established
 file_data
 content:"ele1.addEventListener( |27|DOMNodeRemoved|27|, eHandler, false )"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3119
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:26988
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<rect id="
 nocase
 content:"clip-path=|22 22|/>"
 within:25
 nocase
 content:".removeAttributeNS(|22 22|,|22|clip-path|22 29 3B|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:27101
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer double-free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<rect id="
 nocase
 content:"clip-path=|22 22|/>"
 within:25
 nocase
 content:".removeAttributeNS(|22 22|,|22|clip-path|22 29 3B|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:27100
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"
 flow:to_server,established
 file_data
 content:".innerHTML"
 nocase
 content:"document.body.appendChild|28|"
 distance:0
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"setTimeout|28|"
 distance:0
 nocase
 content:"onload=\'setTimeout"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1311
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:27062
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 deleted object access via timer memory corruption attempt"
 flow:to_client,established
 file_data
 content:".innerHTML"
 nocase
 content:"document.body.appendChild|28|"
 distance:0
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"setTimeout|28|"
 distance:0
 nocase
 content:"onload=\'setTimeout"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1311
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-037
 classtype:attempted-user
 sid:27061
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table column-count integer overflow attempt"
 flow:to_server,established
 file_data
 content:"<table"
 nocase
 content:"<td"
 distance:0
 content:".getElementsByTagName("
 content:"column-count"
 distance:0
 pcre:"/var\\s*(?P<var>\\w+)\\s*=\\s*\\w+\\.getElementsByTagName\\(\\s*[\\x22\\x27]td[\\x22\\x27]\\s*\\)\\.item(\\(\\s*0\\s*\\)|\\.first)\\s*\\x3b.*?(?P=var)\\.style\\.(column-count\\s*=|setAttribute\\s*\\(\\s*[\\x22\\x27]column-count[\\x22\\x27]\\s*,)\\s*[\\x22\\x27]?(0x)?[a-f\\d]{8}/msi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3146
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27157
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table column-count integer overflow attempt"
 flow:to_client,established
 file_data
 content:"<table"
 nocase
 content:"<td"
 distance:0
 content:".getElementsByTagName("
 content:"column-count"
 distance:0
 pcre:"/var\\s*(?P<var>\\w+)\\s*=\\s*\\w+\\.getElementsByTagName\\(\\s*[\\x22\\x27]td[\\x22\\x27]\\s*\\)\\.item(\\(\\s*0\\s*\\)|\\.first)\\s*\\x3b.*?(?P=var)\\.style\\.(column-count\\s*=|setAttribute\\s*\\(\\s*[\\x22\\x27]column-count[\\x22\\x27]\\s*,)\\s*[\\x22\\x27]?(0x)?[a-f\\d]{8}/msi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3146
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27156
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pElement member use after free attempt"
 flow:to_client,established
 file_data
 content:".removeChild(document.getElementsByTagName("
 nocase
 content:"bdo"
 within:10
 nocase
 content:"CollectGarbage()"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3145
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27154
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"
 flow:to_server,established
 file_data
 content:"function"
 nocase
 content:"document.write"
 within:50
 nocase
 content:"onbeforeeditfocus="
 within:100
 nocase
 content:"<input"
 within:25
 nocase
 content:"</input>"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27149
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"
 flow:to_client,established
 file_data
 content:"function"
 nocase
 content:"document.write"
 within:50
 nocase
 content:"onbeforeeditfocus="
 within:100
 nocase
 content:"<input"
 within:25
 nocase
 content:"</input>"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27148
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 IE5 compatibility mode use after free attempt"
 flow:established,to_client
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"
 fast_pattern:only
 content:"event.srcElement.parentNode.removeChild|28|"
 content:"document.body.appendChild|28|"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3144
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-admin
 sid:27147
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.body.innerHTML"
 nocase
 content:"document.styleSheets[0].cssText"
 within:250
 nocase
 content:"document.body.innerHTML"
 within:250
 nocase
 content:"onload="
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3164
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27138
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.body.innerHTML"
 nocase
 content:"document.styleSheets[0].cssText"
 within:250
 nocase
 content:"document.body.innerHTML"
 within:250
 nocase
 content:"onload="
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3164
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27137
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:".createTHead"
 content:".insertAdjacentHTML"
 fast_pattern:only
 content:".scrollIntoView"
 content:".insertRow"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3152
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27135
 rev:2
)\n', 'alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer display node use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementsByTagName|28|"
 content:"input"
 within:8
 content:".height"
 distance:0
 content:".focus|28 29|"
 distance:0
 content:"document.body.noWrap"
 distance:0
 content:".disabled"
 distance:0
 pcre:"/(?P<var>\\w+)\\s*=\\s*[\\w.]+\\.getElementsByTagName\\(\\s*[\\x22\\x27]input[\\x22\\x27]\\s*\\)(\\[\\s*0\\s*]|\\.first)\\s*\\x3b.{0,256}(?P=var)\\.height\\s*=\\s*0\\s*\\x3b.{0,512}(?P=var)\\.disabled\\s*=\\s*true/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3115
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27134
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer display node use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementsByTagName|28|"
 content:"input"
 within:8
 content:".height"
 distance:0
 content:".focus|28 29|"
 distance:0
 content:"document.body.noWrap"
 distance:0
 content:".disabled"
 distance:0
 pcre:"/(?P<var>\\w+)\\s*=\\s*[\\w.]+\\.getElementsByTagName\\(\\s*[\\x22\\x27]input[\\x22\\x27]\\s*\\)(\\[\\s*0\\s*]|\\.first)\\s*\\x3b.{0,256}(?P=var)\\.height\\s*=\\s*0\\s*\\x3b.{0,512}(?P=var)\\.disabled\\s*=\\s*true/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3115
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27133
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer PreviousTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:".onpropertychange"
 content:".swapNode|28|"
 within:64
 pcre:"/\\.onpropertychange\\s*=\\s*function[^{]*?\\{[^}]*?\\w+\\.swapNode\\x28/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3153
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27132
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:"appendChild(document.createElement(\'q\'))|3B|document.body.appendChild(document.createElement(\'q\'))|3B|document.body.appendChild(document.createElement(\'progress\'))|3B|document.getElementsByTagName"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3151
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27131
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 use after free attempt"
 flow:to_server,established
 file_data
 content:"onbeforecopy=|27|document.write(|22 22|)|27|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3148
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27130
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 use after free attempt"
 flow:to_client,established
 file_data
 content:"onbeforecopy=|27|document.write(|22 22|)|27|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3148
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27129
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use-after-free attempt"
 flow:to_server,established
 file_data
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:50
 nocase
 content:"document.write"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3143
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27128
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTreePos use-after-free attempt"
 flow:to_client,established
 file_data
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:50
 nocase
 content:"document.write"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3143
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27127
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setCapture use after free attempt"
 flow:to_client,established
 file_data
 content:".getElementById("
 nocase
 content:".setCapture("
 within:50
 fast_pattern
 nocase
 content:".getElementById("
 within:50
 nocase
 content:".setCapture("
 within:50
 nocase
 content:".getElementById("
 within:50
 nocase
 content:".setCapture("
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3150
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27126
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer merged stylesheet array use after free attempt"
 flow:to_client,established
 file_data
 content:"createStyleSheet"
 content:".sheet"
 content:".removeRule"
 within:50
 fast_pattern
 pcre:"/function\\s+(?P<n>\\w+)\\s*\\([^\\)]*?\\)\\s*\\{[^\\}]*?\\x2e\\s*(getElement[s]*ByTagName[^\\}]*?sheet\\s*\\x2e\\s*removeRule\\s*\\(\\s*\\w\\s*\\)|sheet\\s*\\x2e\\s*removeRule\\s*\\(\\s*\\w\\s*\\)[^\\}]*?\\x2e\\s*getElement[s]*ByTagName)[^\\}]*?(?P=n)\\s*\\(/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3191
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27620
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 6 usp10.dll Bengali font stack overrun attempt"
 flow:to_server,established
 file_data
 content:"charset=UTF-8"
 content:"|8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3181
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-060
 classtype:attempted-dos
 sid:27619
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 6 usp10.dll Bengali font stack overrun attempt"
 flow:to_client,established
 file_data
 content:"charset=UTF-8"
 content:"|8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2 80 8C E2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3181
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-060
 classtype:attempted-dos
 sid:27618
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand"
 nocase
 content:"SelectAll"
 within:9
 distance:2
 nocase
 content:"document.execCommand"
 within:200
 content:"RemoveFormat"
 within:12
 distance:2
 nocase
 content:"document.getElementsByTagName"
 within:200
 nocase
 content:"tbody"
 within:5
 distance:2
 nocase
 content:".innerHTML ="
 within:12
 distance:5
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27614
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand"
 nocase
 content:"SelectAll"
 within:9
 distance:2
 nocase
 content:"document.execCommand"
 within:200
 content:"RemoveFormat"
 within:12
 distance:2
 nocase
 content:"document.getElementsByTagName"
 within:200
 nocase
 content:"tbody"
 within:5
 distance:2
 nocase
 content:".innerHTML ="
 within:12
 distance:5
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27613
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupPointer with SVG use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.createRange()"
 fast_pattern:only
 content:"setStart"
 nocase
 content:"insertNode"
 within:40
 nocase
 content:"insertNode"
 within:25
 nocase
 content:"setStart"
 within:25
 nocase
 content:"document.write"
 within:40
 nocase
 content:"<svg"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3194
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27612
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object CSS text overflow attempt"
 flow:to_client,established
 file_data
 content:"text-overflow|3A|ellipsis|3B|overflow-x|3A|hidden"
 nocase
 content:"onload=|22|"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3189
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-dos
 sid:27608
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer content generation use after free attempt"
 flow:to_client,established
 file_data
 content:".setAttribute("
 content:"<svg>"
 nocase
 content:" id="
 within:30
 nocase
 content:" id="
 within:30
 nocase
 content:"surroundContents("
 fast_pattern:only
 content:"surroundContents("
 nocase
 content:"document.getElementById("
 within:24
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3187
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27607
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSelectionManager use after free attempt"
 flow:to_client,established
 file_data
 content:"document.write|28|"
 nocase
 content:".className=|22|"
 within:100
 nocase
 content:"document.execCommand|28 22|Undo|22 29|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3199
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-admin
 sid:27606
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TreeNode use after free attempt"
 flow:to_client,established
 file_data
 content:"style.unicodeBidi"
 fast_pattern:only
 content:"document.body.innerHTML"
 nocase
 pcre:"/var\\s*(?P<obj>\\w+)\\s*=\\s*document\\.createElement.*?(?P=obj)\\.innerHTML\\s*=\\s*"\\??"\\s*\\x3b.*?\\w+\\.appendChild\\(\\s*(?P=obj)\\s*\\).*?(?P=obj)\\.style\\.unicodeBidi/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3188
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27605
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"onload="
 nocase
 content:"execCommand|28 22|Justify"
 within:30
 distance:1
 nocase
 content:"<script>"
 within:45
 nocase
 content:"execCommand|28 22|SelectAll"
 within:32
 nocase
 content:"</script>"
 within:12
 nocase
 content:"<select>"
 within:82
 nocase
 content:"<script>"
 within:25
 nocase
 content:"execCommand|28 22|Justify"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,57832
 reference:cve,2013-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:27717
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"onload="
 nocase
 content:"execCommand|28 22|Justify"
 within:30
 distance:1
 nocase
 content:"<script>"
 within:45
 nocase
 content:"execCommand|28 22|SelectAll"
 within:32
 nocase
 content:"</script>"
 within:12
 nocase
 content:"<select>"
 within:82
 nocase
 content:"<script>"
 within:25
 nocase
 content:"execCommand|28 22|Justify"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,57832
 reference:cve,2013-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 classtype:attempted-user
 sid:27716
 rev:1
)\n', 'alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe execCommand use after free attempt"
 flow:to_server,established
 file_data
 content:"<object data="
 content:"onload="
 within:64
 content:".contentDocument|3B|"
 content:".execCommand|28|"
 within:64
 nocase
 content:".execCommand|28|"
 within:64
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3208
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27846
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe execCommand use after free attempt"
 flow:to_client,established
 file_data
 content:"<object data="
 content:"onload="
 within:64
 content:".contentDocument|3B|"
 content:".execCommand|28|"
 within:64
 nocase
 content:".execCommand|28|"
 within:64
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3208
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27845
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSegment object use after free attempt"
 flow:to_client,established
 file_data
 content:"for=|22|document|22| event=|22|onreadystatechange|22|>g()"
 fast_pattern:only
 content:"fieldset style=|22|border:expression(f())"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3209
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27842
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 MutationEvent use after free attempt"
 flow:to_client,established
 file_data
 content:"initMutationEvent("
 content:"DOMNodeRemoved"
 within:30
 content:"initMutationEvent("
 within:200
 content:"DOMNodeRemoved"
 within:30
 pcre:"/initMutationEvent\\x28\\s*[\\x22\\x27]?DOMNodeRemoved[\\x22\\x27]?\\s*,([^,]+,){2}\\s*(?P<relatedNode>[^,]+)\\s*,([^,]+,){2}\\s*(?P<attrName>[^,]+)\\s*,.*?initMutationEvent\\x28\\s*[\\x22\\x27]?DOMNodeRemoved[\\x22\\x27]?\\s*,[^,]+,\\s*(false|0)\\s*,\\s*(?P=relatedNode)\\s*,([^,]+,){2}\\s*(?P=attrName)\\s*,\\s*(modification|1)\\s*\\x29/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3207
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-admin
 sid:27841
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer range markup switch use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createRange("
 fast_pattern
 nocase
 content:".selectNode("
 within:50
 nocase
 content:".deleteContents("
 within:50
 nocase
 content:".insertNode("
 within:50
 nocase
 content:".reload("
 within:50
 nocase
 content:"<object "
 distance:0
 nocase
 pcre:"/var\\s+?(?P<obj>[^\\s=\\x3b]+?)\\s*?=\\s*?document\\.createRange\\(.*?(?P=obj)\\.selectNode\\(\\s*?(?P<sel>[^\\s\\)\\x3b]+?)\\s*?\\).*?(?P=obj)\\.deleteContents\\(.*?(?P=obj)\\.insertNode\\(\\s*?(?P=sel)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3206
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27840
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer range markup switch use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createRange("
 fast_pattern
 nocase
 content:".selectNode("
 within:50
 nocase
 content:".deleteContents("
 within:50
 nocase
 content:".insertNode("
 within:50
 nocase
 content:".reload("
 within:50
 nocase
 content:"<object "
 distance:0
 nocase
 pcre:"/var\\s+?(?P<obj>[^\\s=\\x3b]+?)\\s*?=\\s*?document\\.createRange\\(.*?(?P=obj)\\.selectNode\\(\\s*?(?P<sel>[^\\s\\)\\x3b]+?)\\s*?\\).*?(?P=obj)\\.deleteContents\\(.*?(?P=obj)\\.insertNode\\(\\s*?(?P=sel)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3206
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27839
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer AddOption use after free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"
 nocase
 content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"
 within:200
 nocase
 content:".options.remove|28 29 3B|"
 within:100
 nocase
 content:".getElementsByTagName|28 22|option|22 29 5B|0|5D 3B|"
 within:200
 nocase
 content:".add|28|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3204
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27836
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer AddOption use after free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"
 nocase
 content:"document.getElementsByTagName|28 22|select|22 29 5B|0|5D 3B|"
 within:200
 nocase
 content:".options.remove|28 29 3B|"
 within:100
 nocase
 content:".getElementsByTagName|28 22|option|22 29 5B|0|5D 3B|"
 within:200
 nocase
 content:".add|28|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3204
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27835
 rev:2
)\n', 'alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript apply method type confusion attempt"
 flow:to_server,established
 file_data
 content:".onfocus|3B|"
 nocase
 content:".apply|28|"
 within:64
 nocase
 content:"0x"
 within:5
 content:"onload="
 content:"onfocus="
 within:32
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)\\s*=\\s*\\w+\\.(onfocus|onload)\\x3b((?!<\\/script).)*?(?P=var)\\.apply\\x28\\s*0x/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27834
 rev:1
)\n', 'alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"
 flow:to_server,established
 file_data
 content:".onfocus|3B|"
 nocase
 content:".call|28|"
 within:64
 nocase
 content:"0x"
 within:5
 content:"onload="
 content:"onfocus="
 within:32
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)\\s*=\\s*\\w+\\.(onfocus|onload)\\x3b((?!<\\/script).)*?(?P=var)\\.call\\x28\\s*0x/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27833
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript apply method type confusion attempt"
 flow:to_client,established
 file_data
 content:".onfocus|3B|"
 nocase
 content:".apply|28|"
 within:64
 nocase
 content:"0x"
 within:5
 content:"onload="
 content:"onfocus="
 within:32
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)\\s*=\\s*\\w+\\.(onfocus|onload)\\x3b((?!<\\/script).)*?(?P=var)\\.apply\\x28\\s*0x/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27832
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"
 flow:to_client,established
 file_data
 content:".onfocus|3B|"
 nocase
 content:".call|28|"
 within:64
 nocase
 content:"0x"
 within:5
 content:"onload="
 content:"onfocus="
 within:32
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)\\s*=\\s*\\w+\\.(onfocus|onload)\\x3b((?!<\\/script).)*?(?P=var)\\.call\\x28\\s*0x/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27831
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS any (msg:"BROWSER-IE Microsoft Internet Explorer hgroup element DOM reset use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementsByTagName(|22|hgroup|22|)"
 content:"<table>"
 nocase
 content:"<hgroup>"
 within:100
 nocase
 content:"<section>"
 nocase
 content:!"</section>"
 within:400
 nocase
 content:"<address>"
 nocase
 content:!"</address>"
 within:400
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3202
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27830
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer hgroup element DOM reset use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementsByTagName(|22|hgroup|22|)"
 content:"<table>"
 nocase
 content:"<hgroup>"
 within:100
 nocase
 content:"<section>"
 nocase
 content:!"</section>"
 within:400
 nocase
 content:"<address>"
 nocase
 content:!"</address>"
 within:400
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3202
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27829
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CPhraseElement use after free attempt"
 flow:to_server,established
 file_data
 content:"mstime_malloc("
 fast_pattern:only
 content:"urn:schemas-microsoft-com:time"
 nocase
 content:":ANIMATECOLOR"
 nocase
 pcre:"/mstime_malloc\\([^\\)]+?objId:\\s*?[\\x22\\x27](?P<smil_obj>[^\\x22\\x27]+)[\\x22\\x27].*?:ANIMATECOLOR[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P=smil_obj)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,60975
 reference:cve,2013-3163
 reference:url,osvdb.org/show/osvdb/94981
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27909
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CPhraseElement use after free attempt"
 flow:to_client,established
 file_data
 content:"mstime_malloc("
 fast_pattern:only
 content:"urn:schemas-microsoft-com:time"
 nocase
 content:":ANIMATECOLOR"
 nocase
 pcre:"/mstime_malloc\\([^\\)]+?objId:\\s*?[\\x22\\x27](?P<smil_obj>[^\\x22\\x27]+)[\\x22\\x27].*?:ANIMATECOLOR[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P=smil_obj)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,60975
 reference:cve,2013-3163
 reference:url,osvdb.org/show/osvdb/94981
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:27908
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"
 flow:to_client,established
 file_data
 content:"getElementsByTagName"
 nocase
 content:"nosmartquotes"
 within:30
 nocase
 content:"onreadystatechange"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3886
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080
 classtype:attempted-user
 sid:28204
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:".execCommand(\'Delete\', false)"
 nocase
 content:".execCommand"
 within:200
 nocase
 content:"removeformat"
 within:50
 nocase
 content:".execCommand"
 within:400
 distance:-200
 nocase
 content:"delete"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3874
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:28160
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLayoutBlock use after free attempt"
 flow:to_server,established
 file_data
 content:"document.write("
 nocase
 content:"<ruby>"
 within:15
 distance:1
 fast_pattern
 nocase
 content:"document.getElementsByTagName("
 within:150
 nocase
 content:".length"
 within:25
 distance:4
 nocase
 content:"document.getElementsByTagName("
 within:55
 distance:6
 nocase
 content:"|5D|.clientWidth|3B|"
 within:35
 distance:5
 nocase
 pcre:"/function\\s*?(?P<ruby1>\\w+).*?document\\.write\\x28\\s*?[\\x22\\x27]\\s*?\\x3c\\s*?ruby\\s*?\\x3e\\s*?[\\x22\\x27].*?function\\s*?(?P<enum>\\w+).*?for\\s*?\\x28\\s*?\\w+\\x3d\\s*?0\\s*?\\x3b\\s*?\\w+\\s*?\\x3c\\s*?document\\.getElementsByTagName\\x28\\s*?[\\x22\\x27]\\s*?(?P<badtag>\\w+)\\s*?[\\x22\\x27]\\s*?\\x29\\.length\\s*?\\x3b\\s*?\\w+\\x2b\\x2b\\s*?\\x29.*?document\\.getElementsByTagName\\x28\\s*?[\\x22\\x27](?P=badtag)\\s*?[\\x22\\x27]\\s*?\\x29\\s*?\\x5b.*?\\x5d\\.clientWidth.*?\\x3cruby\\x3e.*?\\x3cscript\\x3e\\s*?(?P=ruby1).*?\\x3cscript\\x3e\\s*?(?P=enum).*?\\x3cscript\\x3e(?P=enum)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3875
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:28159
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLayoutBlock use after free attempt"
 flow:to_client,established
 file_data
 content:"document.write("
 nocase
 content:"<ruby>"
 within:15
 distance:1
 fast_pattern
 nocase
 content:"document.getElementsByTagName("
 within:150
 nocase
 content:".length"
 within:25
 distance:4
 nocase
 content:"document.getElementsByTagName("
 within:55
 distance:6
 nocase
 content:"|5D|.clientWidth|3B|"
 within:35
 distance:5
 nocase
 pcre:"/function\\s*?(?P<ruby1>\\w+).*?document\\.write\\x28\\s*?[\\x22\\x27]\\s*?\\x3c\\s*?ruby\\s*?\\x3e\\s*?[\\x22\\x27].*?function\\s*?(?P<enum>\\w+).*?for\\s*?\\x28\\s*?\\w+\\x3d\\s*?0\\s*?\\x3b\\s*?\\w+\\s*?\\x3c\\s*?document\\.getElementsByTagName\\x28\\s*?[\\x22\\x27]\\s*?(?P<badtag>\\w+)\\s*?[\\x22\\x27]\\s*?\\x29\\.length\\s*?\\x3b\\s*?\\w+\\x2b\\x2b\\s*?\\x29.*?document\\.getElementsByTagName\\x28\\s*?[\\x22\\x27](?P=badtag)\\s*?[\\x22\\x27]\\s*?\\x29\\s*?\\x5b.*?\\x5d\\.clientWidth.*?\\x3cruby\\x3e.*?\\x3cscript\\x3e\\s*?(?P=ruby1).*?\\x3cscript\\x3e\\s*?(?P=enum).*?\\x3cscript\\x3e(?P=enum)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3875
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:28158
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer STextBlockPosition use after free attempt"
 flow:to_client,established
 file_data
 content:"thead"
 fast_pattern:only
 content:"caption"
 content:"getElement"
 pcre:"/\\.getElements?By(Id|TagName)\\x28\\s*[\\x22\\x27]caption[\\x22\\x27]\\s*\\x29.*?innerHTML\\s*\\x3d\\s*[\\x22\\x27]\\x3cthead/sm"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3885
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:28151
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"
 flow:to_server,established
 file_data
 content:".onfocus"
 nocase
 content:".call|28|"
 within:64
 nocase
 content:"onclick="
 content:"onfocus="
 within:64
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)(\\s*=\\s*\\w+)?\\.(onclick|onfocus|onload)\\.(call|apply)\\x28\\s*(0x)?\\d+/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:28232
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript call method type confusion attempt"
 flow:to_client,established
 file_data
 content:".onfocus"
 nocase
 content:".call|28|"
 within:64
 nocase
 content:"onclick="
 content:"onfocus="
 within:64
 pcre:"/<script((?!<\\/script).)*?(var|function)\\s*\\w+\\s*(=\\s*function\\s*\\x28\\s*\\x29)?((?!<\\/script).)*?(var\\s*)?(?P<var>\\w+)(\\s*=\\s*\\w+)?\\.(onclick|onfocus|onload)\\.(call|apply)\\x28\\s*(0x)?\\d+/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:28231
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer generic use after free attempt"
 flow:to_server,established
 file_data
 content:"onload="
 nocase
 content:"onselectstart="
 within:64
 nocase
 content:"execCommand("
 content:"InsertInputReset"
 within:20
 content:"body.contentEditable"
 content:"true"
 within:10
 content:"body.contentEditable"
 distance:0
 content:"false"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3916
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088
 classtype:attempted-recon
 sid:28524
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer generic use after free attempt"
 flow:to_client,established
 file_data
 content:"onload="
 nocase
 content:"onselectstart="
 within:64
 nocase
 content:"execCommand("
 content:"InsertInputReset"
 within:20
 content:"body.contentEditable"
 content:"true"
 within:10
 content:"body.contentEditable"
 distance:0
 content:"false"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3916
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088
 classtype:attempted-user
 sid:28523
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer undo use after free attempt"
 flow:to_client,established
 file_data
 content:"applyElement|28|"
 content:"execCommand|28 22|InsertInputHidden|22 29 3B|"
 content:"innerHTML|3D 22 22 3B|"
 within:35
 content:"CollectGarbage|28 29|"
 within:30
 content:"execCommand|28 22|Undo|22 29 3B|"
 within:55
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3915
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088
 classtype:attempted-user
 sid:28504
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer createRange user after free attempt"
 flow:to_client,established
 file_data
 content:" document.body.innerHTML +="
 content:" document.execCommand|28|"
 within:100
 content:".createRange|28|"
 distance:0
 metadata:policy balanced-ips alert, policy security-ips drop, service http
 reference:cve,2013-3910
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088
 classtype:attempted-user
 sid:28496
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer execCommand CTreePos memory corruption attempt"
 flow:to_server,established
 file_data
 content:".execCommand"
 nocase
 content:"undo"
 within:15
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"redo"
 within:15
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"undo"
 within:15
 nocase
 pcre:"/\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*undo\\s*[\\x22\\x27].*?\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*redo\\s*[\\x22\\x27].*?\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*undo\\s*[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3914
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088
 classtype:attempted-user
 sid:28495
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer execCommand CTreePos memory corruption attempt"
 flow:to_client,established
 file_data
 content:".execCommand"
 nocase
 content:"undo"
 within:15
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"redo"
 within:15
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"undo"
 within:15
 nocase
 pcre:"/\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*undo\\s*[\\x22\\x27].*?\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*redo\\s*[\\x22\\x27].*?\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*undo\\s*[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3914
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088
 classtype:attempted-user
 sid:28494
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer freed CTreePos object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"function selectRange(nodes"
 nocase
 content:"removeAllRanges()"
 within:80
 nocase
 content:"selectRange(nodes"
 distance:0
 nocase
 content:"document.selection.createRange().pasteHTML"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3912
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088
 classtype:attempted-user
 sid:28492
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CEditAdorner use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement|28|"
 content:"canvas"
 within:7
 distance:1
 content:".createControlRange|28 29|"
 within:100
 content:".select|28 29|"
 within:100
 content:".addBehavior"
 within:100
 content:"#default#VML"
 within:17
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3911
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-088
 classtype:attempted-user
 sid:28491
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"
 flow:to_client,established
 file_data
 content:"outerHTML"
 nocase
 content:"document.execCommand"
 within:100
 nocase
 content:"designMode=|22|off|22|"
 within:200
 nocase
 content:"contenteditable=|22|true|22|"
 within:200
 fast_pattern
 content:"onresize=|22|"
 within:200
 nocase
 pcre:"/outerhtml\\s*?\\+\\=\\s*?\\x22/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-3917
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088
 classtype:attempted-user
 sid:28490
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"
 flow:to_server,established
 file_data
 content:"beforeeditfocus"
 nocase
 content:".focus"
 within:250
 nocase
 content:"document.write"
 nocase
 pcre:"/function\\s+(?P<vuln>\\w+)\\s*\\x28[^\\x7B]+?\\x7B[^\\x7D]+?document\\.write.*?onbeforeeditfocus\\s*[\\x22\\x27]\\s*\\x2C\\s*(?P=vuln)/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,60966
 reference:cve,2013-3147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:28855
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer beforeeditfocus use after free exploit attempt"
 flow:to_client,established
 file_data
 content:"beforeeditfocus"
 nocase
 content:".focus"
 within:250
 nocase
 content:"document.write"
 nocase
 pcre:"/function\\s+(?P<vuln>\\w+)\\s*\\x28[^\\x7B]+?\\x7B[^\\x7D]+?document\\.write.*?onbeforeeditfocus\\s*[\\x22\\x27]\\s*\\x2C\\s*(?P=vuln)/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,60966
 reference:cve,2013-3147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-055
 classtype:attempted-user
 sid:28854
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CElement Use After Free exploit attempt"
 flow:to_client,established
 file_data
 content:"|2E|select|28|"
 nocase
 content:"oncontrolselect="
 nocase
 content:"document.write|28|"
 within:16
 nocase
 content:"contentEditable="
 nocase
 content:"true"
 within:5
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5052
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28880
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"all_elements_list|5B|2|5D|.appendChild|28|document.createElement|28 22|div|22 29 29 3B|"
 fast_pattern:only
 content:"all_elements_list.push|28|document.getElementById|28 22|t9|22 29 29 3B|"
 content:"obj|5B 27|appendChild|27 5D 28|all_elements_list|5B|2|5D 29 3B|"
 within:250
 distance:150
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5047
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-097
 classtype:attempted-user
 sid:28874
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"all_elements_list|5B|2|5D|.appendChild|28|document.createElement|28 22|div|22 29 29 3B|"
 fast_pattern:only
 content:"all_elements_list.push|28|document.getElementById|28 22|t9|22 29 29 3B|"
 content:"obj|5B 27|appendChild|27 5D 28|all_elements_list|5B|2|5D 29 3B|"
 within:250
 distance:150
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5047
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-097
 classtype:attempted-user
 sid:28873
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table sub structure use after free attempt"
 flow:to_client,established
 file_data
 content:"<table "
 nocase
 content:"<table "
 within:256
 nocase
 content:".appendChild("
 content:".insertRow("
 within:256
 content:".deleteRow("
 within:256
 fast_pattern
 pcre:"/<table[^>]*?>((?!<\\/table>).)*?<t(head|body|footer) id=.*?<\\/table>.{0,256}<table[^>]*?>((?!<\\/table>).)*?<t(head|body|footer) id=.*?<\\/table>/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5048
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28866
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table sub structure use after free attempt"
 flow:to_server,established
 file_data
 content:"<table "
 nocase
 content:"<table "
 within:256
 nocase
 content:".appendChild("
 content:".insertRow("
 within:256
 content:".deleteRow("
 within:256
 fast_pattern
 pcre:"/<table[^>]*?>((?!<\\/table>).)*?<t(head|body|footer) id=.*?<\\/table>.{0,256}<table[^>]*?>((?!<\\/table>).)*?<t(head|body|footer) id=.*?<\\/table>/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5048
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28865
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer CViewportChangeInvalidation use after free attempt"
 flow:to_server,established
 file_data
 content:"<marquee"
 fast_pattern:only
 content:"<a"
 content:"<i"
 within:50
 content:"</a"
 within:15
 content:"<b"
 distance:0
 content:"<h"
 within:15
 content:"</b"
 within:15
 content:"<marquee"
 within:50
 content:"</i"
 within:55
 metadata:policy balanced-ips drop, service smtp
 reference:cve,2013-5051
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28863
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CViewportChangeInvalidation use after free attempt"
 flow:to_client,established
 file_data
 content:"<marquee"
 fast_pattern:only
 content:"<a"
 content:"<i"
 within:50
 content:"</a"
 within:15
 content:"<b"
 distance:0
 content:"<h"
 within:15
 content:"</b"
 within:15
 content:"<marquee"
 within:50
 content:"</i"
 within:55
 metadata:policy balanced-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5051
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28862
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 CElement Use After Free exploit attempt"
 flow:to_client,established
 file_data
 content:"function "
 nocase
 content:"{"
 distance:0
 content:"document.write"
 within:20
 nocase
 content:"oncontrolselect="
 fast_pattern:only
 content:"contentEditable="
 nocase
 content:"true"
 within:5
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:bugtraq,64124
 reference:cve,2013-5052
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:29036
 rev:2
)\n', 'alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer cmarkup methods use after free attempt"
 flow:to_server,established
 file_data
 content:"|3C 64 69 76 20 69 64 3D 22 64 69 76 31 61 22 20 73 74 79 6C 65 3D 22 68 65 69 67 68 74 3A 32 30 30 30 70 78 22 3E 26 6E 62 73 70 3B 3C 2F 64 69 76 3E|"
 fast_pattern:only
 content:"|65 6C 73 65 69 66 20 28 66 6C 61 67 31 20 25 20 31 30 30 30 20 3D 3D 20 30 29 20 7B|"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0269
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29738
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cmarkup methods use after free attempt"
 flow:to_client,established
 file_data
 content:"|3C 64 69 76 20 69 64 3D 22 64 69 76 31 61 22 20 73 74 79 6C 65 3D 22 68 65 69 67 68 74 3A 32 30 30 30 70 78 22 3E 26 6E 62 73 70 3B 3C 2F 64 69 76 3E|"
 fast_pattern:only
 content:"|65 6C 73 65 69 66 20 28 66 6C 61 67 31 20 25 20 31 30 30 30 20 3D 3D 20 30 29 20 7B|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0269
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29737
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer list element use after free attempt"
 flow:to_server,established
 file_data
 content:"|3C|nl"
 content:"|3C|ruby"
 distance:0
 pcre:"/^.{0,200}(?!r[tp])\\x3c\\x2fruby.{0,200}\\x3c\\x2fnl/Rmsi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0270
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29732
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer list element use after free attempt"
 flow:to_client,established
 file_data
 content:"|3C|nl"
 content:"|3C|ruby"
 distance:0
 pcre:"/^.{0,200}(?!r[tp])\\x3c\\x2fruby.{0,200}\\x3c\\x2fnl/Rmsi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0270
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29731
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_server,established
 file_data
 content:"<area"
 nocase
 content:".attachEvent"
 within:250
 fast_pattern
 nocase
 content:".detachEvent"
 within:250
 nocase
 content:"document.open"
 within:100
 nocase
 pcre:"/<area\\s[^>]*?id\\s*?=\\s*?[\\x22\\x27]?(?P<area_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?(?P=area_id)\\.attachEvent\\s*?\\x28[^\\x29]+?,[^\\x29]*?(?<func>[^\\x29\\s]+)[\\s\\x29].*?(?P=func)[^\\x7b]+?\\x7b[^\\x7d]*?(?P=area_id)\\.detachEvent\\s*?\\x28[^\\x7d]+?document\\.open/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29730
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_server,established
 file_data
 content:".attachEvent"
 fast_pattern
 nocase
 content:".detachEvent"
 within:250
 nocase
 content:"document.open"
 within:100
 nocase
 content:"<area"
 within:250
 nocase
 pcre:"/(?P<area_id>\\w+)\\.attachEvent\\s*?\\x28[^\\x29]+?,[^\\x29]*?(?<func>[^\\x29\\s]+)[\\s\\x29].*?(?P=func)[^\\x7b]+?\\x7b[^\\x7d]*?(?P=area_id)\\.detachEvent\\s*?\\x28[^\\x7d]+?document\\.open.*?<area\\s[^>]*?id\\s*?=\\s*?[\\x22\\x27]?(?P=area_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29729
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_client,established
 file_data
 content:"<area"
 nocase
 content:".attachEvent"
 within:250
 fast_pattern
 nocase
 content:".detachEvent"
 within:250
 nocase
 content:"document.open"
 within:100
 nocase
 pcre:"/<area\\s[^>]*?id\\s*?=\\s*?[\\x22\\x27]?(?P<area_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?(?P=area_id)\\.attachEvent\\s*?\\x28[^\\x29]+?,[^\\x29]*?(?<func>[^\\x29\\s]+)[\\s\\x29].*?(?P=func)[^\\x7b]+?\\x7b[^\\x7d]*?(?P=area_id)\\.detachEvent\\s*?\\x28[^\\x7d]+?document\\.open/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29728
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_client,established
 file_data
 content:".attachEvent"
 fast_pattern
 nocase
 content:".detachEvent"
 within:250
 nocase
 content:"document.open"
 within:100
 nocase
 content:"<area"
 within:250
 nocase
 pcre:"/(?P<area_id>\\w+)\\.attachEvent\\s*?\\x28[^\\x29]+?,[^\\x29]*?(?<func>[^\\x29\\s]+)[\\s\\x29].*?(?P=func)[^\\x7b]+?\\x7b[^\\x7d]*?(?P=area_id)\\.detachEvent\\s*?\\x28[^\\x7d]+?document\\.open.*?<area\\s[^>]*?id\\s*?=\\s*?[\\x22\\x27]?(?P=area_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29727
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"outerText = |22|&nbsp|3B 22|"
 content:"|22|div|3A|first-letter{background|3A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0279
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29722
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"outerText = |22|&nbsp|3B 22|"
 content:"|22|div|3A|first-letter{background|3A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0279
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29721
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer text node use after free attempt"
 flow:to_server,established
 file_data
 content:".createTextNode"
 content:".addRange"
 within:200
 content:"delete"
 within:250
 content:"undo"
 within:250
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0289
 reference:cve,2014-0298
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:29718
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer text node use after free attempt"
 flow:to_client,established
 file_data
 content:".createTextNode"
 content:".addRange"
 within:200
 content:"delete"
 within:250
 content:"undo"
 within:250
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0289
 reference:cve,2014-0298
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:29717
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<meta http-equiv=|22|Content-Type|22| content=|22|text/html|3B| charset=UTF-8|22|>"
 content:"<meta http-equiv=|22|X-UA-Compatible|22|content=|22|IE=EmulateIE7|22|>"
 content:"src : url(|22|"
 content:"<body> <div id=|22|titlebar|22|><div id=|22|left|22|><div class=|22|title|22|>|E4 B8 AD E5 9B BD E4 BA BA|</div></div></div></body>|0A|</html>"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0267
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29716
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTree Node use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.offsetHeight"
 nocase
 content:"document.styleSheets["
 within:150
 nocase
 content:"].deleteRule"
 within:16
 nocase
 content:"document.body.offsetHeight"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0281
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29712
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTree Node use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.offsetHeight"
 nocase
 content:"document.styleSheets["
 within:150
 nocase
 content:"].deleteRule"
 within:16
 nocase
 content:"document.body.offsetHeight"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0281
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29711
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer fontFamily attribute deleted object access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<style id"
 nocase
 content:"@font-face"
 within:30
 nocase
 content:"src|3A|"
 within:80
 nocase
 content:"getElementbyID"
 within:300
 nocase
 content:"innerHTML"
 within:50
 nocase
 content:"style.fontFamily"
 within:36
 nocase
 pcre:"/\\<style\\s+?id\\s?=\\s?\\"(?P<fontstyle>\\w{1,20})\\".*?\\@font-face.*?src\\:\\s?.*\\.(ttf|).*?getElementByID\\(\\\'(?P=fontstyle)\'\\).*?innerHTML.*?style.fontFamily/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0284
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29710
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer fontFamily attribute deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<style id"
 nocase
 content:"@font-face"
 within:30
 nocase
 content:"src|3A|"
 within:80
 nocase
 content:"getElementbyID"
 within:300
 nocase
 content:"innerHTML"
 within:50
 nocase
 content:"style.fontFamily"
 within:36
 nocase
 pcre:"/\\<style\\s+?id\\s?=\\s?\\"(?P<fontstyle>\\w{1,20})\\".*?\\@font-face.*?src\\:\\s?.*\\.(ttf|).*?getElementByID\\(\\\'(?P=fontstyle)\'\\).*?innerHTML.*?style.fontFamily/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0284
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29709
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS uninitialized object access attempt detected"
 flow:to_client,established
 file_data
 content:".dir="
 nocase
 content:"rtl"
 within:4
 nocase
 content:"word-wrap|3A|break-word"
 fast_pattern:only
 content:"style="
 nocase
 content:"border"
 within:7
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0278
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29708
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access attempt detected"
 flow:to_server,established
 file_data
 content:"window.navigate("
 nocase
 content:"document.open()"
 within:50
 nocase
 content:"<marquee "
 fast_pattern:only
 content:"<marquee "
 nocase
 content:"onactivate|3D|"
 within:50
 nocase
 content:"<legend"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0285
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29707
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access attempt detected"
 flow:to_client,established
 file_data
 content:"window.navigate("
 nocase
 content:"document.open()"
 within:50
 nocase
 content:"<marquee "
 fast_pattern:only
 content:"<marquee "
 nocase
 content:"onactivate|3D|"
 within:50
 nocase
 content:"<legend"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0285
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29706
 rev:2
)\n', 'alert tcp any any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer swap node user after free"
 flow:to_server,established
 file_data
 content:"javascript"
 content:"document|2E|execCommand|28|"
 distance:14
 content:"InsertUnorderedList"
 within:25
 distance:1
 content:"swapNode|28|"
 distance:0
 content:"document|2E|execCommand|28|"
 distance:0
 content:"Undo"
 within:8
 distance:1
 pcre:"/document\\.execCommand\\(\\s*[\\x22\\x27]InsertUnorderedList[\\x22\\x27]\\s*\\)\\s*\\x3B.{0,250}\\s*\\w+\\.swapNode\\(\\s*[A-Za-z\\(\\)\\"\\\'\\.\\=\\ ]{1,75}\\s*\\)\\s*document\\.execCommand\\(\\s*[\\x22\\x27]Undo[\\x22\\x27]\\s*\\)\\s*\\x3B/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0290
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29679
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer swap node user after free"
 flow:to_client,established
 file_data
 content:"javascript"
 content:"document|2E|execCommand|28|"
 distance:14
 content:"InsertUnorderedList"
 within:25
 distance:1
 content:"swapNode|28|"
 distance:0
 content:"document|2E|execCommand|28|"
 distance:0
 content:"Undo"
 within:8
 distance:1
 pcre:"/document\\.execCommand\\(\\s*[\\x22\\x27]InsertUnorderedList[\\x22\\x27]\\s*\\)\\s*\\x3B.{0,250}\\s*\\w+\\.swapNode\\(\\s*[A-Za-z\\(\\)\\"\\\'\\.\\=\\ ]{1,75}\\s*\\)\\s*document\\.execCommand\\(\\s*[\\x22\\x27]Undo[\\x22\\x27]\\s*\\)\\s*\\x3B/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0290
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29678
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"
 flow:to_client,established
 file_data
 content:"language=|22|vbscript|22|"
 fast_pattern:only
 content:"Public Default Property Get"
 content:"language=|22|jscript|22|"
 pcre:"/Set\\s+(?P<class>[a-z0-9]+)\\s+\\x3D\\s+new.*var\\s+[a-z0-9]\\s+\\x3D\\s+(?P=class)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0271
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-011
 classtype:attempted-user
 sid:29675
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_server,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"outerHTML"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29674
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_server,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"innerHTML"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29673
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_client,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"outerHTML"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29672
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_client,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"innerHTML"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29671
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos deleted object access attempt"
 flow:to_server,established
 file_data
 content:"getElementById"
 nocase
 content:"appendChild"
 within:30
 nocase
 content:"innerHTML"
 within:250
 nocase
 content:"<table id"
 within:200
 nocase
 pcre:"/getElementById\\s?\\(\\"(?P<child>\\w{1,10})\\"\\)\\.appendChild.*?innerHTML.*\\<table\\s?id\\s?=\\"(?P=child)\\"/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0277
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29668
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos deleted object access attempt"
 flow:to_client,established
 file_data
 content:"getElementById"
 nocase
 content:"appendChild"
 within:30
 nocase
 content:"innerHTML"
 within:250
 nocase
 content:"<table id"
 within:200
 nocase
 pcre:"/getElementById\\s?\\(\\"(?P<child>\\w{1,10})\\"\\)\\.appendChild.*?innerHTML.*\\<table\\s?id\\s?=\\"(?P=child)\\"/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0277
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29667
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement|28|"
 content:"document.body.appendChild|28|"
 distance:0
 content:".applyElement|28|"
 distance:0
 content:"document.body.contentEditable|3D 22|true|22|"
 distance:0
 content:".execCommand|28|"
 distance:0
 content:".applyElement"
 distance:0
 content:"document.createElement"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0272
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29655
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"
 flow:to_server,established
 file_data
 content:"createAttributeNS"
 fast_pattern:only
 content:"getElementById("
 nocase
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"getElementById("
 distance:0
 nocase
 pcre:"/getElementById\\x28[\\\'\\"](?P<deleted_object>\\w{1,20})[\\\'\\"].*?CollectGarbage\\x28\\x29.*?getElementbyID\\x28[\\\'\\"](?P=deleted_object)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0288
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29742
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object access memory corruption attempt"
 flow:to_client,established
 file_data
 content:"createAttributeNS"
 fast_pattern:only
 content:"getElementById("
 nocase
 content:"CollectGarbage()"
 distance:0
 nocase
 content:"getElementById("
 distance:0
 nocase
 pcre:"/getElementById\\x28[\\\'\\"](?P<deleted_object>\\w{1,20})[\\\'\\"].*?CollectGarbage\\x28\\x29.*?getElementbyID\\x28[\\\'\\"](?P=deleted_object)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0288
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29741
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_server,established
 file_data
 content:"<body "
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"document.writeln(|22 22|)"
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?document\\.writeln\\([\\x22\\x27]{2}\\).*?<body[^>]*?on(scroll|load)\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:29989
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onscroll use after free attempt"
 flow:to_client,established
 file_data
 content:"<body "
 nocase
 content:"onscroll="
 within:50
 fast_pattern
 content:"document.writeln(|22 22|)"
 pcre:"/<script\\s*>((?!<\\/script>).)*?function (?P<onload>\\w+).*?\\{[^}]*?document\\.writeln\\([\\x22\\x27]{2}\\).*?<body[^>]*?on(scroll|load)\\s*=\\s*[\\x22\\x27](?P=onload)/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3123
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-047
 classtype:attempted-user
 sid:29988
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ruby text tag heap-based buffer overflow attempt"
 flow:to_server,established
 file_data
 content:"<rt"
 nocase
 content:"-ms-hyphens:"
 fast_pattern:only
 pcre:"/<rt[^?]*?style\\s*=\\s*[\\x22\\x27]?-ms-hyphens\\s*\\x3A\\s*auto\\s*\\x3B\\s*[\\x27\\x22]?\\>[\\w\\W]{680}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0313
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,www.w3schools.com/tags/tag_rt.asp
 classtype:attempted-dos
 sid:30145
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ruby text tag heap-based buffer overflow attempt"
 flow:to_client,established
 file_data
 content:"<rt"
 nocase
 content:"-ms-hyphens:"
 fast_pattern:only
 pcre:"/<rt[^?]*?style\\s*=\\s*[\\x22\\x27]?-ms-hyphens\\s*\\x3A\\s*auto\\s*\\x3B\\s*[\\x27\\x22]?\\>[\\w\\W]{680}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0313
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,www.w3schools.com/tags/tag_rt.asp
 classtype:attempted-dos
 sid:30144
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"
 flow:to_server,established
 file_data
 content:"= document.createElement|28 22|html"
 content:".scrollLeft="
 fast_pattern:only
 content:"onmove="
 content:".swapNode(document.createElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0324
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30143
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"
 flow:to_client,established
 file_data
 content:"= document.createElement|28 22|html"
 content:".scrollLeft="
 fast_pattern:only
 content:"onmove="
 content:".swapNode(document.createElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0324
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30142
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"
 flow:to_server,established
 file_data
 content:"= document.createElement|28 22|html"
 content:".scrollTop="
 fast_pattern:only
 content:"onmove="
 content:".swapNode(document.createElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0324
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30141
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer OnMove use after free attempt"
 flow:to_client,established
 file_data
 content:"= document.createElement|28 22|html"
 content:".scrollTop="
 fast_pattern:only
 content:"onmove="
 content:".swapNode(document.createElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0324
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30140
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ruby element in media element use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement|28|"
 content:"media"
 within:20
 content:"innerHTML"
 content:"<ruby>"
 within:20
 content:"insertInputSubmit"
 content:"insertInputHidden"
 pcre:"/(?P<var>[a-z0-9]+)\\s*\\x3D\\s*document\\x2EcreateElement\\x28[\\x22\\x27]media[\\x22\\x27]\\x29.*?(?P=var)\\x2EinnerHTML\\s*\\x3D\\s*[\\x22\\x27]\\x3Cruby\\x3E[\\x22\\x27].*?(?P=var)\\x2EinnerHTML\\s*\\x3D\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0309
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30132
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ruby element in media element use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement|28|"
 content:"media"
 within:20
 content:"innerHTML"
 content:"<ruby>"
 within:20
 content:"insertInputSubmit"
 content:"insertInputHidden"
 pcre:"/(?P<var>[a-z0-9]+)\\s*\\x3D\\s*document\\x2EcreateElement\\x28[\\x22\\x27]media[\\x22\\x27]\\x29.*?(?P=var)\\x2EinnerHTML\\s*\\x3D\\s*[\\x22\\x27]\\x3Cruby\\x3E[\\x22\\x27].*?(?P=var)\\x2EinnerHTML\\s*\\x3D\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0309
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30131
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Nested Tables use after free attempt"
 flow:to_server,established
 file_data
 content:"table"
 nocase
 content:"].removeNode(false)"
 within:23
 fast_pattern
 nocase
 content:"document.write"
 nocase
 content:"<table>"
 within:11
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0299
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30130
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Nested Tables use after free attempt"
 flow:to_client,established
 file_data
 content:"table"
 nocase
 content:"].removeNode(false)"
 within:23
 fast_pattern
 nocase
 content:"document.write"
 nocase
 content:"<table>"
 within:11
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0299
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30129
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free memory corruption attempt"
 flow:to_server,established
 file_data
 content:".contentEditable"
 nocase
 content:".execCommand|28|"
 within:100
 nocase
 content:"Delete"
 within:10
 nocase
 content:".createTextRange|28 29|.execCommand|28|"
 within:100
 nocase
 content:"SelectAll"
 within:15
 nocase
 content:"HTML"
 within:55
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0304
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30128
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free memory corruption attempt"
 flow:to_client,established
 file_data
 content:".contentEditable"
 nocase
 content:".execCommand|28|"
 within:100
 nocase
 content:"Delete"
 within:10
 nocase
 content:".createTextRange|28 29|.execCommand|28|"
 within:100
 nocase
 content:"SelectAll"
 within:15
 nocase
 content:"HTML"
 within:55
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0304
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30127
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeDataPos object use after free attempt"
 flow:to_server,established
 file_data
 content:"all[1].setAttribute(|22|className|22|, all[1].previousSibling)"
 content:"setTimeout(\'CollectGarbage()|3B|all[0].outerText = |22|aaaa|22 3B|document.body.innerHTML += |22|a|22|\', 1000)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0311
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30126
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeDataPos object use after free attempt"
 flow:to_client,established
 file_data
 content:"all[1].setAttribute(|22|className|22|, all[1].previousSibling)"
 content:"setTimeout(\'CollectGarbage()|3B|all[0].outerText = |22|aaaa|22 3B|document.body.innerHTML += |22|a|22|\', 1000)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0311
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30125
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_server,established
 file_data
 content:".createRange|28|"
 nocase
 content:".deleteContents|28|"
 within:250
 nocase
 content:".execCommand|28|"
 within:100
 nocase
 content:"insertIFrame"
 within:20
 fast_pattern
 nocase
 pcre:"/function.*?\\x28[^\\x7b]+?\\x7b[^\\x7d]+?var\\s*?(?P<var>\\w+)\\s*?\\x3d[^\\x7d]+?\\.createRange\\x28[^\\x7d]+?(?P=var)\\.deleteContents\\x28[^\\x7d]+?\\.execCommand\\x28\\s*?[\\x22\\x27]\\s*?insertIFrame/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0297
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30124
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:".createRange|28|"
 nocase
 content:".deleteContents|28|"
 within:250
 nocase
 content:".execCommand|28|"
 within:100
 nocase
 content:"insertIFrame"
 within:20
 fast_pattern
 nocase
 pcre:"/function.*?\\x28[^\\x7b]+?\\x7b[^\\x7d]+?var\\s*?(?P<var>\\w+)\\s*?\\x3d[^\\x7d]+?\\.createRange\\x28[^\\x7d]+?(?P=var)\\.deleteContents\\x28[^\\x7d]+?\\.execCommand\\x28\\s*?[\\x22\\x27]\\s*?insertIFrame/ims"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0297
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30123
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSelectElement SetCurSel remote code execution attempt"
 flow:to_client,established
 file_data
 content:"<select"
 nocase
 content:"attachEvent("
 nocase
 content:"onpropertychange"
 within:50
 nocase
 content:"selected"
 nocase
 content:"true"
 within:15
 nocase
 content:"setTimeout"
 nocase
 content:"CollectGarbage"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0312
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30122
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer button element onreadystatechange use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement"
 content:"button"
 within:20
 content:"onreadystatechange"
 content:"CollectGarbage"
 pcre:"/(?P<button>[a-z0-9]+)\\s*\\x3D\\s*document\\.createElement\\x28[\\x22\\x27]button[\\x22\\x27]\\x29.*?(?P=button)\\.onreadystatechange\\s*\\x3D\\s*.*?(?P=button)\\.addBehavior.*?CollectGarbage\\x28/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0302
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30117
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer button element onreadystatechange use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement"
 content:"button"
 within:20
 content:"onreadystatechange"
 content:"CollectGarbage"
 pcre:"/(?P<button>[a-z0-9]+)\\s*\\x3D\\s*document\\.createElement\\x28[\\x22\\x27]button[\\x22\\x27]\\x29.*?(?P=button)\\.onreadystatechange\\s*\\x3D\\s*.*?(?P=button)\\.addBehavior.*?CollectGarbage\\x28/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0302
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30116
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:"<body"
 nocase
 content:"behavior"
 within:75
 nocase
 content:"<body"
 within:150
 nocase
 content:"onreadystatechange"
 within:75
 fast_pattern
 nocase
 pcre:"/<body[^>]+?style\\s*=\\s*[\\x22\\x27](-ms-)?behavior\\s*:.*?<body[^>]+?onreadystatechange\\s*=[^>]+?>[\\s\\t\\r\\n]*?<\\/body/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,66028
 reference:cve,2014-0303
 reference:cve,2014-2799
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:30113
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:"<body"
 nocase
 content:"onreadystatechange"
 within:75
 fast_pattern
 nocase
 content:"<body"
 within:150
 nocase
 content:"behavior"
 within:75
 nocase
 pcre:"/<body[^>]+?onreadystatechange\\s*=.*?<body[^>]+?style\\s*=\\s*[\\x22\\x27](-ms-)?behavior\\s*:[^\\x22\\x27]+?[\\x22\\x27][^>]*?>[\\s\\t\\r\\n]*?<\\/body/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,66028
 reference:cve,2014-0303
 reference:cve,2014-2799
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:30112
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:"<body"
 nocase
 content:"behavior"
 within:75
 nocase
 content:"<body"
 within:150
 nocase
 content:"onreadystatechange"
 within:75
 fast_pattern
 nocase
 pcre:"/<body[^>]+?style\\s*=\\s*[\\x22\\x27](-ms-)?behavior\\s*:.*?<body[^>]+?onreadystatechange\\s*=[^>]+?>[\\s\\t\\r\\n]*?<\\/body/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,66028
 reference:cve,2014-0303
 reference:cve,2014-2799
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:30111
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:"<body"
 nocase
 content:"onreadystatechange"
 within:75
 fast_pattern
 nocase
 content:"<body"
 within:150
 nocase
 content:"behavior"
 within:75
 nocase
 pcre:"/<body[^>]+?onreadystatechange\\s*=.*?<body[^>]+?style\\s*=\\s*[\\x22\\x27](-ms-)?behavior\\s*:[^\\x22\\x27]+?[\\x22\\x27][^>]*?>[\\s\\t\\r\\n]*?<\\/body/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,66028
 reference:cve,2014-0303
 reference:cve,2014-2799
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:30110
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Remove Format use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.appendChild"
 nocase
 content:"createTextRange()"
 nocase
 content:"moveToElementText(document.body.all[0])"
 fast_pattern:only
 content:".execCommand(\'Underline\'"
 nocase
 content:".execCommand(\'RemoveFormat\'"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0306
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30109
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Remove Format use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.appendChild"
 nocase
 content:"createTextRange()"
 nocase
 content:"moveToElementText(document.body.all[0])"
 fast_pattern:only
 content:".execCommand(\'Underline\'"
 nocase
 content:".execCommand(\'RemoveFormat\'"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0306
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:30108
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_server,established
 file_data
 content:"t.parentNode.runtimeStyle.posWidth = -1|3B|"
 content:"t.focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:30105
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_server,established
 file_data
 content:"b.runtimeStyle.posWidth = 100|3B|"
 content:"t.focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:30104
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_client,established
 file_data
 content:"t.parentNode.runtimeStyle.posWidth = -1|3B|"
 content:"t.focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:30103
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_client,established
 file_data
 content:"b.runtimeStyle.posWidth = 100|3B|"
 content:"t.focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:30102
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_server,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"outerText"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:30082
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_server,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"innerText"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:30081
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_client,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"outerText"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:30080
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SVG handling use after free attempt"
 flow:to_client,established
 file_data
 content:"<clipPath"
 fast_pattern
 nocase
 content:"clip-path"
 within:50
 nocase
 content:"url|28|"
 within:25
 nocase
 content:"<svg"
 nocase
 content:"</svg"
 within:250
 nocase
 content:"innerText"
 nocase
 pcre:"/<clipPath[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<clip_id>[^\\x22\\x27\\s>]+)[\\x22\\x27]?[\\s>].*?<clipPath[^>]+?clip-path\\s*?=\\s*?[\\x22\\x27]?url\\x28\\x23(?P=clip_id)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,65382
 reference:cve,2014-0283
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:30079
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS uninitialized object access attempt detected"
 flow:to_server,established
 file_data
 content:".dir="
 nocase
 content:"rtl"
 within:4
 nocase
 content:"word-wrap|3A|break-word"
 fast_pattern:only
 content:"style="
 nocase
 content:"border"
 within:7
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0278
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:30169
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer merged stylesheet array use after free attempt"
 flow:to_server,established
 file_data
 content:"createStyleSheet"
 content:".sheet"
 content:".removeRule"
 within:50
 fast_pattern
 pcre:"/function\\s+(?P<n>\\w+)\\s*\\([^\\)]*?\\)\\s*\\{[^\\}]*?\\x2e\\s*(getElement[s]*ByTagName[^\\}]*?sheet\\s*\\x2e\\s*removeRule\\s*\\(\\s*\\w\\s*\\)|sheet\\s*\\x2e\\s*removeRule\\s*\\(\\s*\\w\\s*\\)[^\\}]*?\\x2e\\s*getElement[s]*ByTagName)[^\\}]*?(?P=n)\\s*\\(/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3191
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:30201
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"
 flow:to_server,established
 file_data
 content:"onbeforeeditfocus"
 nocase
 content:"document.write"
 within:30
 pcre:"/onbeforeeditfocus\\s*?=\\s*?[\\x22\\x27]document\\x2ewrite/ism"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0029
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:30345
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer nth-child use after free attempt"
 flow:to_server, established
 file_data
 content:"|3A|nth-child|28|"
 fast_pattern
 content:".createRange|28|"
 distance:0
 content:"extractContents"
 distance:0
 content:"|3C|li "
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1755
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:30502
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nth-child use after free attempt"
 flow:to_client, established
 file_data
 content:"|3A|nth-child|28|"
 fast_pattern
 content:".createRange|28|"
 distance:0
 content:"extractContents"
 distance:0
 content:"|3C|li "
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1755
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:30501
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer remote code execution attempt"
 flow:to_server,established
 file_data
 content:"outerText="
 nocase
 content:"execCommand(|22|SelectAll|22|)"
 distance:0
 fast_pattern
 nocase
 content:"onselectstart="
 distance:0
 nocase
 content:"Element"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1751
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:30500
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer remote code execution attempt"
 flow:to_client,established
 file_data
 content:"outerText="
 nocase
 content:"execCommand(|22|SelectAll|22|)"
 distance:0
 fast_pattern
 nocase
 content:"onselectstart="
 distance:0
 nocase
 content:"Element"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1751
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-018
 classtype:attempted-user
 sid:30499
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer failed large copy clonenode attempt"
 flow:to_server,established
 file_data
 content:"document.createElement("
 content:".setAttribute("
 within:50
 content:".cloneNode("
 within:100
 fast_pattern
 content:"<body onload="
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1753
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-018
 classtype:attempted-user
 sid:30498
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer failed large copy clonenode attempt"
 flow:to_client,established
 file_data
 content:"document.createElement("
 content:".setAttribute("
 within:50
 content:".cloneNode("
 within:100
 fast_pattern
 content:"<body onload="
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1753
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-018
 classtype:attempted-user
 sid:30497
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_server,established
 file_data
 content:"url|28 23|default|23|VML|29|"
 fast_pattern:only
 content:"schemas-microsoft-com|3A|vml"
 nocase
 content:"removeNode"
 nocase
 content:"onpropertychange"
 distance:0
 nocase
 pcre:"/function\\s+?(?P<func>\\w+)\\s*?\\x28\\s*?\\x29\\s*?\\x7b((?!function).)*?removeNode.*?\\x2eonpropertychange\\s*?=\\s*?(?P=func)/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,67075
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:30803
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_client,established
 file_data
 content:"url|28 23|default|23|VML|29|"
 fast_pattern:only
 content:"schemas-microsoft-com|3A|vml"
 nocase
 content:"removeNode"
 nocase
 content:"onpropertychange"
 distance:0
 nocase
 pcre:"/function\\s+?(?P<func>\\w+)\\s*?\\x28\\s*?\\x29\\s*?\\x7b((?!function).)*?removeNode.*?\\x2eonpropertychange\\s*?=\\s*?(?P=func)/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,67075
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:30794
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"
 flow:to_server,established
 file_data
 content:"language=|22|vbscript|22|"
 fast_pattern:only
 content:"Public Default Property Get"
 content:"language=|22|jscript|22|"
 pcre:"/Set\\s+(?P<class>[a-z0-9]+)\\s+\\x3D\\s+new.*var\\s+[a-z0-9]\\s+\\x3D\\s+(?P=class)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0271
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006
 classtype:attempted-user
 sid:30851
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"
 flow:to_server,established
 file_data
 content:"Class "
 content:"Public Default Property Get "
 distance:0
 content:"End Property"
 within:100
 content:"Set"
 distance:0
 content:"New"
 within:50
 nocase
 pcre:"/Class\\s(?P<class>[a-z0-9]+).*?Public\\sDefault\\sProperty\\sGet\\s(?P<property>[a-z0-9]+)\\s+(?P=property)[^\\x3D]+?End\\sProperty.*?Set\\s(?P<var>[a-z0-9]+)\\s\\x3D\\sNew\\s(?P=class).*?(?P=var)\\.(?P=property)\\s\\x3D/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0271
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006
 classtype:attempted-user
 sid:30850
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer type confusion attempt"
 flow:to_client,established
 file_data
 content:"Class "
 content:"Public Default Property Get "
 distance:0
 content:"End Property"
 within:100
 content:"Set"
 distance:0
 content:"New"
 within:50
 nocase
 pcre:"/Class\\s(?P<class>[a-z0-9]+).*?Public\\sDefault\\sProperty\\sGet\\s(?P<property>[a-z0-9]+)\\s+(?P=property)[^\\x3D]+?End\\sProperty.*?Set\\s(?P<var>[a-z0-9]+)\\s\\x3D\\sNew\\s(?P=class).*?(?P=var)\\.(?P=property)\\s\\x3D/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-0271
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-006
 classtype:attempted-user
 sid:30849
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_server,established
 file_data
 content:".attachEvent"
 fast_pattern
 content:"onfocus"
 within:15
 nocase
 content:"document.write"
 within:150
 content:"<area"
 within:250
 nocase
 pcre:"/(?<area>\\w+)\\x2EattachEvent\\s*\\x28[\\x27\\x22]\\s*onfocus(out|in)\\s*[\\x27\\x22]\\s*,\\s*(?<func>\\w+)\\s*?\\x29.*?function\\s*(?P=func)\\s*?\\x28[^\\x29]*?\\x29\\s*\\x7b[^\\x7d]*?document\\x2Ewrite(ln)?\\s*\\x28\\s*[\\x27\\x22][^\\x29]*?[\\x27\\x22]\\s*?\\x29.*?<area\\s*id\\s*=[\\x27\\x22]\\s*(?P=area)\\s*[\\x27\\x22]/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-005
 classtype:attempted-user
 sid:30848
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement event handler use after free attempt"
 flow:to_client,established
 file_data
 content:".attachEvent"
 fast_pattern
 content:"onfocus"
 within:15
 nocase
 content:"document.write"
 within:150
 content:"<area"
 within:250
 nocase
 pcre:"/(?<area>\\w+)\\x2EattachEvent\\s*\\x28[\\x27\\x22]\\s*onfocus(out|in)\\s*[\\x27\\x22]\\s*,\\s*(?<func>\\w+)\\s*?\\x29.*?function\\s*(?P=func)\\s*?\\x28[^\\x29]*?\\x29\\s*\\x7b[^\\x7d]*?document\\x2Ewrite(ln)?\\s*\\x28\\s*[\\x27\\x22][^\\x29]*?[\\x27\\x22]\\s*?\\x29.*?<area\\s*id\\s*=[\\x27\\x22]\\s*(?P=area)\\s*[\\x27\\x22]/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0275
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-005
 classtype:attempted-user
 sid:30847
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_server,established
 file_data
 content:"|C2 06 62 06 25 80 02 15 DF FF FF 24 00 63 07 24 00 82 63 09 10 34 00 00 09 62 07 D2 62 09 66|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:30895
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_client,established
 file_data
 content:"|C2 06 62 06 25 80 02 15 DF FF FF 24 00 63 07 24 00 82 63 09 10 34 00 00 09 62 07 D2 62 09 66|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:30894
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_server,established
 file_data
 content:"<marquee"
 fast_pattern
 nocase
 content:".applyElement"
 distance:0
 nocase
 content:".createElement"
 within:100
 nocase
 content:"frameset"
 within:50
 nocase
 content:".createRange"
 within:250
 nocase
 pcre:"/<marquee[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<elem>\\w+)[\\x22\\x27]?[\\s>].*?(?P=elem)\\.applyElement\\s*?\\x28[^\\x29]*?createElement\\s*?\\x28\\s*?[\\x22\\x27]frameset[\\x22\\x27]\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1815
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30964
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_server,established
 file_data
 content:"applyElement"
 nocase
 content:"createElement"
 nocase
 content:"frameset"
 within:50
 nocase
 content:"createRange"
 within:250
 nocase
 content:"<marquee"
 fast_pattern:only
 content:"onload"
 nocase
 content:"onresize"
 content:"contentEditable"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1815
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30963
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:"<marquee"
 fast_pattern
 nocase
 content:".applyElement"
 distance:0
 nocase
 content:".createElement"
 within:100
 nocase
 content:"frameset"
 within:50
 nocase
 content:".createRange"
 within:250
 nocase
 pcre:"/<marquee[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<elem>\\w+)[\\x22\\x27]?[\\s>].*?(?P=elem)\\.applyElement\\s*?\\x28[^\\x29]*?createElement\\s*?\\x28\\s*?[\\x22\\x27]frameset[\\x22\\x27]\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1815
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30962
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:"applyElement"
 nocase
 content:"createElement"
 nocase
 content:"frameset"
 within:50
 nocase
 content:"createRange"
 within:250
 nocase
 content:"<marquee"
 fast_pattern:only
 content:"onload"
 nocase
 content:"onresize"
 content:"contentEditable"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1815
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30961
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<dir"
 nocase
 content:"<sub"
 nocase
 content:"fireEvent"
 nocase
 content:"onfocus"
 within:20
 content:"attachEvent"
 nocase
 content:"onfocusout"
 within:20
 nocase
 content:"attachEvent"
 distance:0
 nocase
 content:"onfocusout"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0310
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30957
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer deleted object memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<dir"
 nocase
 content:"<sub"
 nocase
 content:"fireEvent"
 nocase
 content:"onfocus"
 within:20
 content:"attachEvent"
 nocase
 content:"onfocusout"
 within:20
 nocase
 content:"attachEvent"
 distance:0
 nocase
 content:"onfocusout"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0310
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-029
 classtype:attempted-user
 sid:30956
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer pastHTML use after free"
 flow:to_server,established
 file_data
 content:"document.body.contentEditable="
 content:"true"
 within:20
 content:"document.execCommand"
 within:200
 content:"InsertInputSubmit"
 within:50
 content:".addBehavior"
 within:50
 content:"document.execCommand"
 within:50
 content:"SelectAll"
 within:20
 content:"document.selection.createRange|28 29|.pasteHTML|28|"
 within:100
 content:"event="
 distance:0
 content:"onreadystatechange"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0305
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30121
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer pastHTML use after free"
 flow:to_client,established
 file_data
 content:"document.body.contentEditable="
 content:"true"
 within:20
 content:"document.execCommand"
 within:200
 content:"InsertInputSubmit"
 within:50
 content:".addBehavior"
 within:50
 content:"document.execCommand"
 within:50
 content:"SelectAll"
 within:20
 content:"document.selection.createRange|28 29|.pasteHTML|28|"
 within:100
 content:"event="
 distance:0
 content:"onreadystatechange"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0305
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30120
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer setEndPoint use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.createTextRange|28 29|"
 content:".moveToElementText"
 within:200
 content:".moveToElementText"
 within:220
 content:".setEndPoint"
 within:420
 content:"EndToStart"
 within:30
 content:".select"
 within:500
 content:"document.execCommand|28|"
 within:120
 content:"delete"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0314
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30119
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setEndPoint use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.createTextRange|28 29|"
 content:".moveToElementText"
 within:200
 content:".moveToElementText"
 within:220
 content:".setEndPoint"
 within:420
 content:"EndToStart"
 within:30
 content:".select"
 within:500
 content:"document.execCommand|28|"
 within:120
 content:"delete"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0314
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30118
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer WindowedMarkupContext use after free attempt"
 flow:to_server,established
 file_data
 content:".getSVGDocument"
 fast_pattern
 nocase
 content:".createRange"
 within:250
 nocase
 content:".getSelection"
 within:250
 nocase
 content:".addRange"
 within:50
 nocase
 pcre:"/var\\s+?(?P<elem>\\w+)\\s*?=\\s*?\\w+\\.getSVGDocument\\s*?\\x28.*?(?P=elem)\\.createRange\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1805
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31220
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer WindowedMarkupContext use after free attempt"
 flow:to_client,established
 file_data
 content:".getSVGDocument"
 fast_pattern
 nocase
 content:".createRange"
 within:250
 nocase
 content:".getSelection"
 within:250
 nocase
 content:".addRange"
 within:50
 nocase
 pcre:"/var\\s+?(?P<elem>\\w+)\\s*?=\\s*?\\w+\\.getSVGDocument\\s*?\\x28.*?(?P=elem)\\.createRange\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1805
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31219
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"<ul "
 nocase
 content:"style=|22|white-space:pre|3B 22|"
 fast_pattern:only
 content:"document.createElement(|22|header|22|)"
 nocase
 content:"applyElement"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1802
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31216
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"<ul "
 nocase
 content:"style=|22|white-space:pre|3B 22|"
 fast_pattern:only
 content:"document.createElement(|22|header|22|)"
 nocase
 content:"applyElement"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1802
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31215
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreePos child element use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementByID"
 fast_pattern
 nocase
 content:"innerText"
 within:40
 nocase
 content:"parentNode.removeChild"
 within:50
 nocase
 pcre:"/var\\s?(?P<ctreepos>\\w+).*?(?P=ctreepos)\\.innerText\\s?=\\s?[\\x22\\x27]{2}.*?(?P=ctreepos)\\.parentNode\\.removeChild\\x28(?P=ctreepos)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1800
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31207
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CTreePos child element use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementByID"
 fast_pattern
 nocase
 content:"innerText"
 within:40
 nocase
 content:"parentNode.removeChild"
 within:50
 nocase
 pcre:"/var\\s?(?P<ctreepos>\\w+).*?(?P=ctreepos)\\.innerText\\s?=\\s?[\\x22\\x27]{2}.*?(?P=ctreepos)\\.parentNode\\.removeChild\\x28(?P=ctreepos)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1800
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31206
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"
 flow:to_server,established
 file_data
 content:"checkbox"
 content:"window.setTimeout|28|"
 distance:0
 content:"document.getElementById|28|"
 distance:0
 content:"|29|.onpropertychange"
 within:50
 distance:3
 content:"document.getElementById|28|"
 within:100
 distance:3
 content:"|29|.click|28 29 3B|"
 within:50
 distance:3
 content:"document.write|28|"
 distance:5
 pcre:"/\\<input\\s*type\\s*\\=\\s*[\\x22\\x27]checkbox[\\x22\\x27]\\s*id\\s*\\=\\s*[\\x22\\x27]\\w+[\\x22\\x27]\\s*\\>\\s*\\<\\/input\\>.{0,500}window.setTimeout\\(\\s*function\\s*\\(\\s*\\)\\s*.{0,500}document.getElementById\\(\\s*[\\x22\\x27]\\w+[\\x22\\x27]\\s*\\).onpropertychange\\s*\\=\\s*(?P<var2>\\w+)\\s*\\x3B.{0,500}function\\s*(?P=var2)\\s*\\(\\s*\\)\\s*\\{.{0,100}document.write\\(\\s*[\\x22\\x27]\\<html\\>\\<\\/html\\>[\\x22\\x27]\\s*\\)\\s*\\x3B/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0282
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31205
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"
 flow:to_client,established
 file_data
 content:"checkbox"
 content:"window.setTimeout|28|"
 distance:0
 content:"document.getElementById|28|"
 distance:0
 content:"|29|.onpropertychange"
 within:50
 distance:3
 content:"document.getElementById|28|"
 within:100
 distance:3
 content:"|29|.click|28 29 3B|"
 within:50
 distance:3
 content:"document.write|28|"
 distance:5
 pcre:"/\\<input\\s*type\\s*\\=\\s*[\\x22\\x27]checkbox[\\x22\\x27]\\s*id\\s*\\=\\s*[\\x22\\x27]\\w+[\\x22\\x27]\\s*\\>\\s*\\<\\/input\\>.{0,500}window.setTimeout\\(\\s*function\\s*\\(\\s*\\)\\s*.{0,500}document.getElementById\\(\\s*[\\x22\\x27]\\w+[\\x22\\x27]\\s*\\).onpropertychange\\s*\\=\\s*(?P<var2>\\w+)\\s*\\x3B.{0,500}function\\s*(?P=var2)\\s*\\(\\s*\\)\\s*\\{.{0,100}document.write\\(\\s*[\\x22\\x27]\\<html\\>\\<\\/html\\>[\\x22\\x27]\\s*\\)\\s*\\x3B/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0282
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31204
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CRangeSaver use after free attempt"
 flow:to_server,established
 file_data
 content:".createRange"
 nocase
 content:".set"
 within:250
 nocase
 content:"NaN"
 within:50
 content:".addRange"
 within:250
 nocase
 content:".execCommand"
 within:250
 fast_pattern
 nocase
 pcre:"/(?P<range>\\w+)\\.set(Start|End)\\s*?\\x28[^\\x2c]+?\\x2c\\s*?NaN\\s*?\\x29.*?\\.addRange\\x28\\s*?(?P=range)\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1772
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31203
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CRangeSaver use after free attempt"
 flow:to_client,established
 file_data
 content:".createRange"
 nocase
 content:".set"
 within:250
 nocase
 content:"NaN"
 within:50
 content:".addRange"
 within:250
 nocase
 content:".execCommand"
 within:250
 fast_pattern
 nocase
 pcre:"/(?P<range>\\w+)\\.set(Start|End)\\s*?\\x28[^\\x2c]+?\\x2c\\s*?NaN\\s*?\\x29.*?\\.addRange\\x28\\s*?(?P=range)\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1772
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31202
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"onload="
 content:"onresize="
 distance:0
 nocase
 content:".applyElement(document.createElement("
 fast_pattern:only
 content:"<tr>"
 nocase
 content:"<tt"
 distance:0
 nocase
 content:"</tt>"
 distance:0
 nocase
 content:"</tr>"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1804
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31199
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"onload="
 content:"onresize="
 distance:0
 nocase
 content:".applyElement(document.createElement("
 fast_pattern:only
 content:"<tr>"
 nocase
 content:"<tt"
 distance:0
 nocase
 content:"</tt>"
 distance:0
 nocase
 content:"</tr>"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1804
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31198
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode onmousemove use-after-free attempt"
 flow:to_server,established
 file_data
 content:"onmousemove"
 nocase
 content:"setCapture"
 distance:0
 nocase
 content:"removeNode(true)"
 nocase
 content:"CollectGarbage"
 within:18
 nocase
 content:"setCapture"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1791
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31197
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode onmousemove use-after-free attempt"
 flow:to_client,established
 file_data
 content:"onmousemove"
 nocase
 content:"setCapture"
 distance:0
 nocase
 content:"removeNode(true)"
 nocase
 content:"CollectGarbage"
 within:18
 nocase
 content:"setCapture"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1791
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31196
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onpagehide use after free attempt"
 flow:to_client,established
 file_data
 content:"contentEditable"
 content:"true"
 within:14
 content:"onpagehide"
 fast_pattern:only
 content:".execCommand"
 content:"Refresh"
 within:10
 content:".createTextRange"
 distance:0
 content:".execCommand"
 within:15
 content:"SelectAll"
 within:15
 content:"InsertInputSubmit"
 content:"document.write"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-1795
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31194
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer RemoveSplice use-after-free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:20
 fast_pattern
 nocase
 content:".execCommand"
 content:"SelectAll"
 within:15
 nocase
 content:".execCommand"
 distance:0
 content:"Insert"
 within:15
 nocase
 pcre:"/(?P<target>\\w+)\\x2eaddEventListener\\s*\\x28\\s*[\\x22\\x27]\\s*DOMNodeRemoved\\s*[\\x22\\x27]\\s*\\x2c.*?(?P=target)\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*SelectAll\\s*[\\x22\\x27]\\s*\\x29.*?(?P=target)\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*Insert[^B(HT)]\\w+[\\x22\\x27]\\s*\\x2c/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1785
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:31191
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer RemoveSplice use-after-free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:20
 fast_pattern
 nocase
 content:".execCommand"
 content:"SelectAll"
 within:15
 nocase
 content:".execCommand"
 distance:0
 content:"Insert"
 within:15
 nocase
 pcre:"/(?P<target>\\w+)\\x2eaddEventListener\\s*\\x28\\s*[\\x22\\x27]\\s*DOMNodeRemoved\\s*[\\x22\\x27]\\s*\\x2c.*?(?P=target)\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*SelectAll\\s*[\\x22\\x27]\\s*\\x29.*?(?P=target)\\x2eexecCommand\\s*\\x28\\s*[\\x22\\x27]\\s*Insert[^B(HT)]\\w+[\\x22\\x27]\\s*\\x2c/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1785
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:31190
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer isIndex attribute overflow attempt"
 flow:to_server,established
 file_data
 content:"for(i=0|3B| i<0xfffe|3B| i++)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-1797
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31189
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer isIndex attribute overflow attempt"
 flow:to_client,established
 file_data
 content:"for(i=0|3B| i<0xfffe|3B| i++)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-1797
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31188
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"
 flow:to_server,established
 file_data
 content:"window.history.replaceState("
 fast_pattern:only
 content:"document|2E|createElement"
 content:"applet"
 within:20
 content:"getElement"
 content:"appendChild|28|"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2804
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:31391
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"
 flow:to_client,established
 file_data
 content:"window.history.replaceState("
 fast_pattern:only
 content:"document|2E|createElement"
 content:"applet"
 within:20
 content:"getElement"
 content:"appendChild|28|"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2804
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:31390
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer improper object cast memory corruption attempt"
 flow:to_server,established
 file_data
 content:"sca5=document.createElement"
 nocase
 content:"document.body.createTextRange().execCommand"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2787
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:31389
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer improper object cast memory corruption attempt"
 flow:to_client,established
 file_data
 content:"sca5=document.createElement"
 nocase
 content:"document.body.createTextRange().execCommand"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2787
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:31388
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized object use after free attempt"
 flow:to_server,established
 file_data
 content:".createRange("
 content:".createTextNode("
 within:100
 distance:20
 content:"CollectGarbage("
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2797
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037
 classtype:attempted-user
 sid:31383
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized object use after free attempt"
 flow:to_client,established
 file_data
 content:".createRange("
 content:".createTextNode("
 within:100
 distance:20
 content:"CollectGarbage("
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2797
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037
 classtype:attempted-user
 sid:31382
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 onpropertychange remote code execution attempt"
 flow:to_server,established
 file_data
 content:"style"
 nocase
 content:"font"
 within:150
 nocase
 content:"onpropertychange"
 fast_pattern
 nocase
 content:"removeAttribute"
 within:450
 distance:-250
 nocase
 content:"style"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,66244
 reference:cve,2014-1765
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037
 classtype:attempted-user
 sid:31381
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 onpropertychange remote code execution attempt"
 flow:to_client,established
 file_data
 content:"style"
 nocase
 content:"font"
 within:150
 nocase
 content:"onpropertychange"
 fast_pattern
 nocase
 content:"removeAttribute"
 within:450
 distance:-250
 nocase
 content:"style"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,66244
 reference:cve,2014-1765
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-037
 classtype:attempted-user
 sid:31380
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"
 flow:to_server,established
 file_data
 content:"getElementById"
 content:"HTML"
 within:100
 content:"getElementById"
 within:200
 content:"checked"
 within:100
 content:"getElementById"
 within:100
 content:"onpropertychange"
 within:200
 content:".reset|28 29|"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0282
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31404
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer celement use after free"
 flow:to_client,established
 file_data
 content:"getElementById"
 content:"HTML"
 within:100
 content:"getElementById"
 within:200
 content:"checked"
 within:100
 content:"getElementById"
 within:100
 content:"onpropertychange"
 within:200
 content:".reset|28 29|"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0282
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:31403
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"
 flow:to_server,established
 file_data
 content:"onbeforeeditfocus"
 nocase
 content:"document.write"
 within:90
 content:"getElementsByTagName"
 fast_pattern:only
 pcre:"/(?P<editfocus>onbeforeeditfocus\\s?=\\s?[\\x22\\x27])(?P<focus>\\w+?\\x28\\x29)[\\x22\\x27].*?(?P=editfocus)(?P=focus).*?(?P=focus)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0029
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:31486
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onbeforeeditfocus element attribute use after free attempt"
 flow:to_client,established
 file_data
 content:"onbeforeeditfocus"
 nocase
 content:"document.write"
 within:90
 content:"getElementsByTagName"
 fast_pattern:only
 pcre:"/(?P<editfocus>onbeforeeditfocus\\s?=\\s?[\\x22\\x27])(?P<focus>\\w+?\\x28\\x29)[\\x22\\x27].*?(?P=editfocus)(?P=focus).*?(?P=focus)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0029
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-009
 classtype:attempted-user
 sid:31485
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS .ipsum layout use-after-free attempt"
 flow:to_server,established
 file_data
 content:"text/css"
 nocase
 content:".ipsum"
 fast_pattern:only
 pcre:"/\\.ipsum\\s*?{[^>}]*?(position|float|display|zoom):/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,59751
 reference:cve,2013-1310
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037
 reference:url,yuhongbao.blogspot.ca/2013/07/how-i-found-cve-2013-1310.html
 classtype:attempted-user
 sid:31585
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS .ipsum layout use-after-free attempt"
 flow:to_client,established
 file_data
 content:"text/css"
 nocase
 content:".ipsum"
 fast_pattern:only
 pcre:"/\\.ipsum\\s*?{[^>}]*?(position|float|display|zoom):/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,59751
 reference:cve,2013-1310
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-037
 reference:url,yuhongbao.blogspot.ca/2013/07/how-i-found-cve-2013-1310.html
 classtype:attempted-user
 sid:31584
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer margin overflow use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement("
 nocase
 content:"header"
 within:20
 nocase
 content:".createElement("
 nocase
 content:".execCommand("
 fast_pattern
 content:"Indent"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2824
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31635
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer margin overflow use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement("
 nocase
 content:"header"
 within:20
 nocase
 content:".createElement("
 nocase
 content:".execCommand("
 fast_pattern
 content:"Indent"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2824
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31634
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup insertMarquee use after free attempt"
 flow:to_server,established
 file_data
 content:"onpropertychange"
 nocase
 content:".execCommand"
 within:60
 nocase
 content:"InsertMarquee"
 within:60
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4057
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31630
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup insertMarquee use after free attempt"
 flow:to_client,established
 file_data
 content:"onpropertychange"
 nocase
 content:".execCommand"
 within:60
 nocase
 content:"InsertMarquee"
 within:60
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4057
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31629
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS [25,2525,465,587] (msg:"BROWSER-IE Microsoft Internet Explorer cdomuievent use after free attempt "
 flow:to_server,established
 file_data
 content:"document.createEvent("
 fast_pattern:only
 content:"window.open"
 content:"document.createEvent("
 within:200
 content:".init"
 within:200
 content:"event"
 within:20
 nocase
 content:"FocusIn"
 within:50
 nocase
 content:"dispatchEvent("
 within:200
 content:"document.write"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,69116
 reference:cve,2014-2820
 reference:url,cwe.mitre.org/data/definitions/416.html
 reference:url,osvdb.org/show/osvdb/109951
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31628
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cdomuievent use after free attempt "
 flow:to_client,established
 file_data
 content:"document.createEvent("
 fast_pattern:only
 content:"window.open"
 content:"document.createEvent("
 within:200
 content:".init"
 within:200
 content:"event"
 within:20
 nocase
 content:"FocusIn"
 within:50
 nocase
 content:"dispatchEvent("
 within:200
 content:"document.write"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,69116
 reference:cve,2014-2820
 reference:url,cwe.mitre.org/data/definitions/416.html
 reference:url,osvdb.org/show/osvdb/109951
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31627
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Use after free attempt"
 flow:to_server,established
 file_data
 content:"hgroup.appendChild(iElement)"
 content:"document.execCommand(|22|justifyCenter|22| , false, |22 22|)|3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2823
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31626
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Use after free attempt"
 flow:to_client,established
 file_data
 content:"hgroup.appendChild(iElement)"
 content:"document.execCommand(|22|justifyCenter|22| , false, |22 22|)|3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2823
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31625
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"
 flow:to_server,established
 file_data
 content:"onreadystatechange"
 fast_pattern:only
 content:"selectAll"
 nocase
 content:"Indent"
 within:150
 nocase
 content:"selectAll"
 distance:0
 nocase
 content:"fieldset"
 distance:0
 nocase
 content:"changeStyles"
 within:50
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service smtp
 reference:cve,2014-4063
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31622
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"
 flow:to_client,established
 file_data
 content:"onreadystatechange"
 fast_pattern:only
 content:"selectAll"
 nocase
 content:"Indent"
 within:150
 nocase
 content:"selectAll"
 distance:0
 nocase
 content:"fieldset"
 distance:0
 nocase
 content:"changeStyles"
 within:50
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4063
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31621
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer kbd element use-after-free attempt"
 flow:to_server,established
 file_data
 content:"<object>"
 content:"<kbd>"
 within:50
 content:"|2A 3A|nth-child|28|-"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4050
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31620
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer kbd element use-after-free attempt"
 flow:to_client,established
 file_data
 content:"<object>"
 content:"<kbd>"
 within:50
 content:"|2A 3A|nth-child|28|-"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4050
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:31619
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementsBytagName"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/\\x3C(?P<obj>\\w+)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+)\\s*?\\x28.*?function\\s+?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementsByTagName\\x28[\\x22\\x27](?P=obj)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:31763
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementByID"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementByID\\x28[\\x22\\x27](?P<obj>\\w+?)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28.*?(?P=obj)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:31762
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementByID"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/\\x3C(?P<obj>\\w+)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+)\\s*?\\x28.*?function\\s+?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementByID\\x28[\\x22\\x27](?P=obj)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:31761
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:"ElementsBytagName"
 nocase
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 content:"CollectGarbage()"
 fast_pattern:only
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7d]*?ElementsByTagName[^\\x7d]*?removeChild\\s*?\\x28.*?object\\s[^\\x3e]*?onerror\\s*?\\x3D\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:31760
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 InsertInputSubmit use after free attempt"
 flow:to_server,established
 file_data
 content:".applyElement"
 nocase
 content:"document.createElement"
 within:55
 nocase
 content:".createTextRange"
 within:250
 nocase
 content:".execCommand"
 within:55
 nocase
 content:"InsertInputSubmit"
 within:40
 fast_pattern
 nocase
 content:".innerHTML"
 within:250
 nocase
 content:".execCommand"
 within:250
 nocase
 content:"Undo"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052
 classtype:attempted-user
 sid:31802
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 InsertInputSubmit use after free attempt"
 flow:to_client,established
 file_data
 content:".applyElement"
 nocase
 content:"document.createElement"
 within:55
 nocase
 content:".createTextRange"
 within:250
 nocase
 content:".execCommand"
 within:55
 nocase
 content:"InsertInputSubmit"
 within:40
 fast_pattern
 nocase
 content:".innerHTML"
 within:250
 nocase
 content:".execCommand"
 within:250
 nocase
 content:"Undo"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-052
 classtype:attempted-user
 sid:31801
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell Use After Free exploit attempt"
 flow:to_server,established
 file_data
 content:"document.addEventListener("
 content:"DOMNodeInserted"
 within:20
 content:".applyElement("
 content:"inside"
 within:25
 nocase
 content:"document.body.createTextRange().execCommand("
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31800
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell Use After Free exploit attempt"
 flow:to_client,established
 file_data
 content:"document.addEventListener("
 content:"DOMNodeInserted"
 within:20
 content:".applyElement("
 content:"inside"
 within:25
 nocase
 content:"document.body.createTextRange().execCommand("
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4092
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31799
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"
 flow:to_server,established
 file_data
 content:"document.createElement(|22|head|22|)"
 nocase
 content:"createTextRange().execCommand(|22|Outdent|22|)"
 nocase
 content:"createTextRange().execCommand(|22|InsertInputCheckbox|22|)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31795
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"
 flow:to_client,established
 file_data
 content:"document.createElement(|22|head|22|)"
 nocase
 content:"createTextRange().execCommand(|22|Outdent|22|)"
 nocase
 content:"createTextRange().execCommand(|22|InsertInputCheckbox|22|)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31794
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free attempt"
 flow:to_client,established
 file_data
 content:".createElement(|22|th|22|)"
 nocase
 content:"<v:oval"
 nocase
 content:".execCommand(|22|Indent|22|)"
 content:".execCommand(|22|Outdent|22|)"
 fast_pattern:only
 content:".onbeforeeditfocus"
 content:".createElement(|22|html|22|)"
 nocase
 content:".appendChild"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4084
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-046
 classtype:attempted-user
 sid:31793
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free attempt"
 flow:to_client,established
 file_data
 content:".createElement(|22|th|22|)"
 nocase
 content:"<v:oval"
 nocase
 content:".execCommand(|22|Indent|22|)"
 content:".execCommand(|22|Outdent|22|)"
 fast_pattern:only
 content:".onbeforeeditfocus"
 content:".createElement(|22|html|22|)"
 nocase
 content:".appendChild"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4084
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-046
 classtype:attempted-user
 sid:31792
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer justifying text with an incorrect type use after free attempt"
 flow:to_server,established
 file_data
 content:".applyElement"
 content:".createTextNode"
 content:".insertAdjacentHTML("
 content:"beforeBegin"
 within:18
 content:".execCommand("
 content:"Justify"
 within:12
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4080
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31789
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer justifying text with an incorrect type use after free attempt"
 flow:to_client,established
 file_data
 content:".applyElement"
 content:".createTextNode"
 content:".insertAdjacentHTML("
 content:"beforeBegin"
 within:18
 content:".execCommand("
 content:"Justify"
 within:12
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4080
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31788
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer style-image-url use after free attempt"
 flow:to_server,established
 file_data
 content:"onbeforeactivate"
 content:"list-style-image|3A|url"
 fast_pattern:only
 pcre:"/id=[\\x22\\x27\\s]*?(?P<id>[\\w\\d]+)[^\\x3e]*onbeforeactivate=[\\x22\\x27\\s]*(?P=id)\\x2e/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4087
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31787
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style-image-url use after free attempt"
 flow:to_client,established
 file_data
 content:"onbeforeactivate"
 content:"list-style-image|3A|url"
 fast_pattern:only
 pcre:"/id=[\\x22\\x27\\s]*?(?P<id>[\\w\\d]+)[^\\x3e]*onbeforeactivate=[\\x22\\x27\\s]*(?P=id)\\x2e/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4087
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31786
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor instance use after free attempt"
 flow:to_server,established
 file_data
 content:"progress"
 content:"source"
 content:"contentEditable"
 content:"removeNode"
 content:"moveToElementText"
 fast_pattern:only
 content:"moveEnd"
 content:"character"
 within:40
 content:"swapNode"
 content:"footer"
 within:40
 content:"file://"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31783
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditor instance use after free attempt"
 flow:to_client,established
 file_data
 content:"progress"
 content:"source"
 content:"contentEditable"
 content:"removeNode"
 content:"moveToElementText"
 fast_pattern:only
 content:"moveEnd"
 content:"character"
 within:40
 content:"swapNode"
 content:"footer"
 within:40
 content:"file://"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31782
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer integer overflow exploit attempt"
 flow:to_server,established
 file_data
 content:"createElement|28|"
 content:"samp"
 within:7
 content:"document|2E|body|2E|onbeforeactivate"
 content:"parentNode.applyElement|28|"
 within:50
 content:"document|2E|body|2E|contentEditable"
 content:"getSelection|28 29 2E|addRange("
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4082
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31810
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer integer overflow exploit attempt"
 flow:to_client,established
 file_data
 content:"createElement|28|"
 content:"samp"
 within:7
 content:"document|2E|body|2E|onbeforeactivate"
 content:"parentNode.applyElement|28|"
 within:50
 content:"document|2E|body|2E|contentEditable"
 content:"getSelection|28 29 2E|addRange|28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4082
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-052
 classtype:attempted-user
 sid:31809
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTransientLookaside object use after free attempt"
 flow:to_server,established
 file_data
 content:"|3A|nth-child|28|"
 fast_pattern:only
 content:"display|3A|"
 nocase
 content:"inline-table|3B|"
 within:20
 nocase
 content:"transition-duration|3A|"
 nocase
 content:"|3C|article"
 nocase
 content:"document.getElementById"
 nocase
 content:".parentNode.removeChild|28|"
 nocase
 pcre:"/\\x3carticle\\s*?id\\s*?\\x3d\\s*?[\\x22\\x27](?P<art>\\w+).*?(?P<elem>\\w+)\\s*?\\x3d\\s*?document\\.getElementById\\s*?\\x28\\s*?[\\x22\\x27](?P=art).*?(?P=elem)\\.parentNode\\.removeChild\\s*?\\x28\\s*?(?P=elem)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4126
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056
 classtype:attempted-user
 sid:32169
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTransientLookaside object use after free attempt"
 flow:to_client,established
 file_data
 content:"|3A|nth-child|28|"
 fast_pattern:only
 content:"display|3A|"
 nocase
 content:"inline-table|3B|"
 within:20
 nocase
 content:"transition-duration|3A|"
 nocase
 content:"|3C|article"
 nocase
 content:"document.getElementById"
 nocase
 content:".parentNode.removeChild|28|"
 nocase
 pcre:"/\\x3carticle\\s*?id\\s*?\\x3d\\s*?[\\x22\\x27](?P<art>\\w+).*?(?P<elem>\\w+)\\s*?\\x3d\\s*?document\\.getElementById\\s*?\\x28\\s*?[\\x22\\x27](?P=art).*?(?P=elem)\\.parentNode\\.removeChild\\s*?\\x28\\s*?(?P=elem)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4126
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056
 classtype:attempted-user
 sid:32168
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer superscript invalid parameter denial of service attempt"
 flow:to_server,established
 file_data
 content:"document.createElement"
 nocase
 content:"lang"
 within:300
 nocase
 content:"document.createElement"
 distance:0
 nocase
 content:"lang"
 within:300
 nocase
 content:"document.createElement"
 distance:0
 nocase
 content:"lang"
 within:300
 nocase
 content:"text_range.execCommand"
 distance:0
 nocase
 content:"superscript"
 within:20
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4133
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056
 classtype:attempted-dos
 sid:32162
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer superscript invalid parameter denial of service attempt"
 flow:to_client,established
 file_data
 content:"document.createElement"
 nocase
 content:"lang"
 within:300
 nocase
 content:"document.createElement"
 distance:0
 nocase
 content:"lang"
 within:300
 nocase
 content:"document.createElement"
 distance:0
 nocase
 content:"lang"
 within:300
 nocase
 content:"text_range.execCommand"
 distance:0
 nocase
 content:"superscript"
 within:20
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4133
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-056
 classtype:attempted-dos
 sid:32161
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup Object use after free attempt"
 flow:to_server,established
 file_data
 content:"obj.textContent = |22|%u33%u17%uB0%u5D%uCC%u84%u91%uD2%uE5%uDC|22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4132
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32160
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup Object use after free attempt"
 flow:to_client,established
 file_data
 content:"obj.textContent = |22|%u33%u17%uB0%u5D%uCC%u84%u91%uD2%uE5%uDC|22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4132
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32159
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CMarkup GetMarkupTitle use-after-free attempt"
 flow:to_server,established
 file_data
 content:"DOMAttrModified"
 nocase
 content:"currentTarget.parentNode.swapNode"
 fast_pattern:only
 content:"currentTarget.previousSibling"
 nocase
 content:"<iframe"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4130
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32158
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CMarkup GetMarkupTitle use-after-free attempt"
 flow:to_client,established
 file_data
 content:"DOMAttrModified"
 nocase
 content:"currentTarget.parentNode.swapNode"
 fast_pattern:only
 content:"currentTarget.previousSibling"
 nocase
 content:"<iframe"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4130
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32157
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer FormatContext Use after free attempt"
 flow:to_server,established
 file_data
 content:"table id="
 nocase
 content:"document.createElement(|22|bdo|22|)|3B|"
 nocase
 content:"document.createElement(|22|base|22|)|3B|"
 nocase
 content:", |22|inside|22|)|3B|"
 nocase
 content:"style.styleFloat=|27|right|27 3B|"
 nocase
 content:"document.createElement(|22|ruby|22|),|22|inside|22|)|3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4129
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32156
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer FormatContext Use after free attempt"
 flow:to_client,established
 file_data
 content:"table id="
 nocase
 content:"document.createElement(|22|bdo|22|)|3B|"
 nocase
 content:"document.createElement(|22|base|22|)|3B|"
 nocase
 content:", |22|inside|22|)|3B|"
 nocase
 content:"style.styleFloat=|27|right|27 3B|"
 nocase
 content:"document.createElement(|22|ruby|22|),|22|inside|22|)|3B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4129
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32155
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML use after free attempt"
 flow:to_server,established
 file_data
 content:"<v:line"
 fast_pattern:only
 content:".contentEditable"
 content:"true"
 within:10
 content:"execCommand"
 content:"Undo"
 within:10
 content:"innerHTML"
 pcre:"/title\\s+id=(?P<title>\\w+).*?(?P=title).innerHtml\\s*?=\\s*?(\\x22\\x22|\\x27\\x27)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4127
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32154
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer innerHTML use after free attempt"
 flow:to_client,established
 file_data
 content:"<v:line"
 fast_pattern:only
 content:".contentEditable"
 content:"true"
 within:10
 content:"execCommand"
 content:"Undo"
 within:10
 content:"innerHTML"
 pcre:"/title\\s+id=(?P<title>\\w+).*?(?P=title).innerHtml\\s*?=\\s*?(\\x22\\x22|\\x27\\x27)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4127
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32153
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DCOM sandbox escape attempt"
 flow:to_server,established
 file_data
 content:"|16 13 09 14 13 08 14 13 07 14 13 06 14 0D 14 13 05 28 3E 01 00 06 18 5A FE 0F 13 04 28 0F 00 00 06 13 08 1F 18 28 1E 01 00 06|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4073
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057
 classtype:attempted-user
 sid:32140
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DCOM sandbox escape attempt"
 flow:to_client,established
 file_data
 content:"|16 13 09 14 13 08 14 13 07 14 13 06 14 0D 14 13 05 28 3E 01 00 06 18 5A FE 0F 13 04 28 0F 00 00 06 13 08 1F 18 28 1E 01 00 06|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4073
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-057
 classtype:attempted-user
 sid:32139
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.all["
 nocase
 content:".setAttribute"
 within:175
 nocase
 content:"document.body.all["
 within:250
 nocase
 content:".setAttribute"
 within:175
 nocase
 content:"document.body.all["
 distance:0
 nocase
 content:"].appendChild|28|"
 within:30
 nocase
 content:"document.createElement|28|"
 within:300
 nocase
 content:".setAttribute|28|"
 within:300
 nocase
 pcre:"/document\\x2ebody\\x2eall\\x5b\\d*\\x5D\\x2eappendChild\\x28(?P<var>\\w+)\\x29.*?var\\s*(?P=var)\\s*?=\\s*document.createElement\\x28.*?(?P=var)\\x2esetAttribute\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4134
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32138
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.all["
 nocase
 content:".setAttribute"
 within:175
 nocase
 content:"document.body.all["
 within:250
 nocase
 content:".setAttribute"
 within:175
 nocase
 content:"document.body.all["
 distance:0
 nocase
 content:"].appendChild|28|"
 within:30
 nocase
 content:"document.createElement|28|"
 within:300
 nocase
 content:".setAttribute|28|"
 within:300
 nocase
 pcre:"/document\\x2ebody\\x2eall\\x5b\\d*\\x5D\\x2eappendChild\\x28(?P<var>\\w+)\\x29.*?var\\s*(?P=var)\\s*?=\\s*document.createElement\\x28.*?(?P=var)\\x2esetAttribute\\x28/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4134
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32137
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFunctionPointer use after free exploit attempt"
 flow:to_server,established
 file_data
 content:".getElementsByTagName("
 nocase
 content:"rt"
 within:3
 content:".execCommand("
 nocase
 content:"ms-beginUndoUnit"
 within:17
 fast_pattern
 nocase
 content:"document.body.parentElement"
 nocase
 content:"document.body.parentTextEdit"
 nocase
 content:".execCommand("
 nocase
 content:"Undo"
 within:5
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4141
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32185
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFunctionPointer use after free exploit attempt"
 flow:to_client,established
 file_data
 content:".getElementsByTagName("
 nocase
 content:"rt"
 within:3
 content:".execCommand("
 nocase
 content:"ms-beginUndoUnit"
 within:17
 fast_pattern
 nocase
 content:"document.body.parentElement"
 nocase
 content:"document.body.parentTextEdit"
 nocase
 content:".execCommand("
 nocase
 content:"Undo"
 within:5
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4141
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32184
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout AddRow out of bounds array access heap corruption attempt"
 flow:to_server,established
 file_data
 content:"createT"
 nocase
 content:"document.getElementById("
 distance:0
 nocase
 content:"deleteRow(-1)"
 within:80
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4137
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32183
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout AddRow out of bounds array access heap corruption attempt"
 flow:to_client,established
 file_data
 content:"createT"
 nocase
 content:"document.getElementById("
 distance:0
 nocase
 content:"deleteRow(-1)"
 within:80
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4137
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32182
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"
 flow:to_server,established
 file_data
 content:"onreadystatechange"
 nocase
 content:"execCommand|28|"
 within:50
 nocase
 content:"selectAll"
 within:25
 nocase
 content:"execCommand|28|"
 within:50
 nocase
 content:"Indent"
 within:25
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service smtp
 reference:cve,2014-4063
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:32318
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onreadystatechange use after free attempt"
 flow:to_client,established
 file_data
 content:"onreadystatechange"
 nocase
 content:"execCommand|28|"
 within:50
 nocase
 content:"selectAll"
 within:25
 nocase
 content:"execCommand|28|"
 within:50
 nocase
 content:"Indent"
 within:25
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4063
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-051
 classtype:attempted-user
 sid:32317
 rev:1
)\n', 'alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:32
 fast_pattern
 content:".createElement|28|"
 within:150
 content:"div"
 within:10
 content:".appendChild|28|"
 within:150
 content:".selectAllChildren|28|"
 within:150
 content:".deleteFromDocument|28|"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0274
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:32365
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_server,established
 file_data
 content:"url|28 23|default|23|VML|29|"
 fast_pattern:only
 content:"schemas-microsoft-com|3A|vml"
 nocase
 content:"onpropertychange"
 nocase
 content:"removeNode"
 distance:0
 nocase
 pcre:"/onpropertychange(\\x22\\x5d)?\\s*?=\\s*?function\\s*?\\x28\\s*?\\x29\\s*?\\x7b[^\\x7d]*?this[^\\x3b]+?removeNode[^\\x3b]*?\\x28true\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,67075
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:32363
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VML use after free attempt"
 flow:to_client,established
 file_data
 content:"url|28 23|default|23|VML|29|"
 fast_pattern:only
 content:"schemas-microsoft-com|3A|vml"
 nocase
 content:"onpropertychange"
 nocase
 content:"removeNode"
 distance:0
 nocase
 pcre:"/onpropertychange(\\x22\\x5d)?\\s*?=\\s*?function\\s*?\\x28\\s*?\\x29\\s*?\\x7b[^\\x7d]*?this[^\\x3b]+?removeNode[^\\x3b]*?\\x28true\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,67075
 reference:cve,2014-1776
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-021
 classtype:attempted-user
 sid:32362
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_server,established
 file_data
 content:"applyElement(document.createElement("
 nocase
 content:"frameset"
 within:10
 nocase
 content:"window.location.href"
 within:50
 nocase
 content:"quotes:none"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32498
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_client,established
 file_data
 content:"applyElement(document.createElement("
 nocase
 content:"frameset"
 within:10
 nocase
 content:"window.location.href"
 within:50
 nocase
 content:"quotes:none"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32497
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 CStyleSheet object use after free attempt"
 flow:to_server,established
 file_data
 content:".setAttribute|28 22|type|22|, null|29|"
 fast_pattern:only
 content:".addImport"
 content:".imports.item|28|"
 within:50
 content:".removeImport|28|"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6341
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32496
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 CStyleSheet object use after free attempt"
 flow:to_client,established
 file_data
 content:".setAttribute|28 22|type|22|, null|29|"
 fast_pattern:only
 content:".addImport"
 content:".imports.item|28|"
 within:50
 content:".removeImport|28|"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6341
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32495
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext use after free attempt"
 flow:to_server,established
 file_data
 content:".clearAttributes("
 fast_pattern:only
 content:".contentWindow.document"
 nocase
 content:"setTimeout("
 within:150
 nocase
 content:".contentWindow.document"
 within:800
 nocase
 content:"setTimeout("
 within:150
 nocase
 content:".contentWindow.document"
 within:800
 nocase
 content:"setTimeout("
 within:150
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service smtp
 reference:cve,2014-4143
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32479
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext use after free attempt"
 flow:to_client,established
 file_data
 content:".clearAttributes("
 fast_pattern:only
 content:".contentWindow.document"
 nocase
 content:"setTimeout("
 within:150
 nocase
 content:".contentWindow.document"
 within:800
 nocase
 content:"setTimeout("
 within:150
 nocase
 content:".contentWindow.document"
 within:800
 nocase
 content:"setTimeout("
 within:150
 nocase
 metadata:policy balanced-ips alert, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4143
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32478
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"redim"
 nocase
 content:"preserve"
 within:20
 nocase
 content:"(&h"
 within:20
 byte_test:6,>,1000,0,relative,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32473
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"redim"
 nocase
 content:"preserve"
 within:20
 nocase
 content:"("
 within:20
 byte_test:6,>,1000,0,relative,string,dec
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32472
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"redim"
 nocase
 content:"preserve"
 within:20
 nocase
 content:"(&h"
 within:20
 byte_test:6,>,1000,0,relative,string,hex
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32471
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"redim"
 nocase
 content:"preserve"
 within:20
 nocase
 content:"("
 within:20
 byte_test:6,>,1000,0,relative,string,dec
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32470
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CPtsTextParaclient out of bounds error remote code execution attempt"
 flow:to_server,established
 file_data
 content:"position: relative"
 nocase
 content:"position: fixed"
 nocase
 content:"display: block"
 nocase
 content:"appendChild(document.createElement"
 fast_pattern:only
 content:"addNode(document.documentElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6342
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-admin
 sid:32461
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CPtsTextParaclient out of bounds error remote code execution attempt"
 flow:to_client,established
 file_data
 content:"position: relative"
 nocase
 content:"position: fixed"
 nocase
 content:"display: block"
 nocase
 content:"appendChild(document.createElement"
 fast_pattern:only
 content:"addNode(document.documentElement"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6342
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-admin
 sid:32460
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElementIDContextList use after free attempt"
 flow:to_server,established
 file_data
 content:"|27|NaN|27|, |27|thick|27|, |27|DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD|27|, |27|dir"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6343
 reference:cve,2015-1662
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:32443
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElementIDContextList use after free attempt"
 flow:to_client,established
 file_data
 content:"|27|NaN|27|, |27|thick|27|, |27|DDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDDD|27|, |27|dir"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6343
 reference:cve,2015-1662
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:32442
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement(\'BUTTON\')"
 content:"id_1.insertBefore(id_14, id_1.childNodes[1])"
 fast_pattern:only
 content:"id_2.offsetLeft = id_2.offsetLeft"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6344
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32441
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement(\'BUTTON\')"
 content:"id_1.insertBefore(id_14, id_1.childNodes[1])"
 fast_pattern:only
 content:"id_2.offsetLeft = id_2.offsetLeft"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6344
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32440
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 CHTMLEditorProxy use after free attempt"
 flow:to_server,established
 file_data
 content:"|5C|u475046"
 fast_pattern:only
 content:"onkeydown"
 content:"window.location.reload"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6353
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32439
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CHTMLEditorProxy use after free attempt"
 flow:to_client,established
 file_data
 content:"|5C|u475046"
 fast_pattern:only
 content:"onkeydown"
 content:"window.location.reload"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6353
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-user
 sid:32438
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use-after-free remote code execution attempt"
 flow:to_server,established
 file_data
 content:"createRange().pasteHTML("
 nocase
 content:"createTextRange()"
 within:70
 nocase
 content:"moveToElementText(document.getElementsByTagName"
 within:100
 nocase
 content:"select()"
 within:100
 nocase
 content:"insertimage"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6348
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-admin
 sid:32431
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHeaderElement object use-after-free remote code execution attempt"
 flow:to_client,established
 file_data
 content:"createRange().pasteHTML("
 nocase
 content:"createTextRange()"
 within:70
 nocase
 content:"moveToElementText(document.getElementsByTagName"
 within:100
 nocase
 content:"select()"
 within:100
 nocase
 content:"insertimage"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6348
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-065
 classtype:attempted-admin
 sid:32430
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer contentEditable use after free attempt"
 flow:to_server,established
 file_data
 content:".contentEditable"
 nocase
 content:"true"
 within:15
 nocase
 content:"document.selection.createRange().scrollIntoView("
 within:100
 nocase
 content:".contentEditable"
 within:75
 nocase
 content:"false"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6337
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32427
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer contentEditable use after free attempt"
 flow:to_client,established
 file_data
 content:".contentEditable"
 nocase
 content:"true"
 within:15
 nocase
 content:"document.selection.createRange().scrollIntoView("
 within:100
 nocase
 content:".contentEditable"
 within:75
 nocase
 content:"false"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6337
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32426
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer object type confusion remote code execution attempt"
 flow:to_server,established
 file_data
 content:".createTextNode|28|"
 nocase
 content:".__proto__"
 within:100
 nocase
 content:"document.documentElement.dataset"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32425
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer object type confusion remote code execution attempt"
 flow:to_client,established
 file_data
 content:".createTextNode|28|"
 nocase
 content:".__proto__"
 within:100
 nocase
 content:"document.documentElement.dataset"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6347
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:32424
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"myarray"
 content:"chrw"
 within:10
 content:"chrw"
 within:20
 content:"32767"
 within:10
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32565
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"myarray"
 content:"chrw"
 within:10
 content:"chrw"
 within:20
 content:"32767"
 within:10
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32564
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"redim  Preserve arr(&h8000002)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32630
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"redim  Preserve arr(&h8000002)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:32629
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CButton object use after free attempt"
 flow:to_server,established
 file_data
 content:".attachEvent("
 nocase
 content:".fireEvent("
 within:100
 nocase
 content:".attachEvent("
 within:100
 nocase
 content:".fireEvent("
 within:100
 nocase
 content:".attachEvent("
 within:100
 nocase
 content:".fireEvent("
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6375
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32723
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CButton object use after free attempt"
 flow:to_client,established
 file_data
 content:".attachEvent("
 nocase
 content:".fireEvent("
 within:100
 nocase
 content:".attachEvent("
 within:100
 nocase
 content:".fireEvent("
 within:100
 nocase
 content:".attachEvent("
 within:100
 nocase
 content:".fireEvent("
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6375
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32722
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer element type confusion use after free attempt"
 flow:to_server,established
 file_data
 content:"attachEvent("
 nocase
 content:"onpropertychange"
 within:30
 nocase
 content:"createTFoot()"
 distance:0
 nocase
 content:"setAttribute("
 within:30
 nocase
 content:"innerHTML"
 within:20
 nocase
 content:"true"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-8966
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32721
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer element type confusion use after free attempt"
 flow:to_client,established
 file_data
 content:"attachEvent("
 nocase
 content:"onpropertychange"
 within:30
 nocase
 content:"createTFoot()"
 distance:0
 nocase
 content:"setAttribute("
 within:30
 nocase
 content:"innerHTML"
 within:20
 nocase
 content:"true"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-8966
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32720
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 7 CTreeNode object remote code execution attempt"
 flow:to_server,established
 file_data
 content:"contentEditable"
 content:"true"
 within:20
 content:"attachEvent"
 within:50
 content:"onpropertychange"
 within:50
 content:"applyElement"
 within:75
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6366
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32717
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 7 CTreeNode object remote code execution attempt"
 flow:to_client,established
 file_data
 content:"contentEditable"
 content:"true"
 within:20
 content:"attachEvent"
 within:50
 content:"onpropertychange"
 within:50
 content:"applyElement"
 within:75
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6366
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32716
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTableSection remote code execution attempt"
 flow:to_server,established
 file_data
 content:"createElement"
 content:"setAttribute"
 within:100
 content:"clearAttributes"
 within:50
 content:"null"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6369
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32715
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 CTableSection remote code execution attempt"
 flow:to_client,established
 file_data
 content:"createElement"
 content:"setAttribute"
 within:100
 content:"clearAttributes"
 within:50
 content:"null"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6369
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-080
 classtype:attempted-user
 sid:32714
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE VBScript RegEx use-after-free attempt"
 flow:to_client, established
 file_data
 content:"|7C|()*?"
 fast_pattern:only
 content:"New RegExp"
 content:".Global"
 within:100
 content:"True"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-6363
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-084
 classtype:attempted-user
 sid:32709
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use of rtf file in clipboard attempt"
 flow:to_server,established
 file_data
 content:"designMode"
 content:"execCommand"
 within:100
 content:"InsertInputFileUpload"
 within:50
 content:"execCommand"
 within:50
 content:"Copy"
 within:25
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6374
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32704
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use of rtf file in clipboard attempt"
 flow:to_client,established
 file_data
 content:"designMode"
 content:"execCommand"
 within:100
 content:"InsertInputFileUpload"
 within:50
 content:"execCommand"
 within:50
 content:"Copy"
 within:25
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6374
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32703
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer NodeFilter use after free attempt"
 flow:to_server,established
 file_data
 content:"NodeFilter.FILTER_REJECT"
 fast_pattern:only
 content:".createTreeWalker"
 nocase
 content:".execCommand"
 distance:0
 nocase
 content:".appendChild"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6330
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32692
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer NodeFilter use after free attempt"
 flow:to_client,established
 file_data
 content:"NodeFilter.FILTER_REJECT"
 fast_pattern:only
 content:".createTreeWalker"
 nocase
 content:".execCommand"
 distance:0
 nocase
 content:".appendChild"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6330
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32691
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer setTimeout use after free attempt"
 flow:to_server,established
 file_data
 content:"iframe"
 nocase
 content:"getElementById"
 within:300
 nocase
 content:".removeChild"
 within:50
 nocase
 content:"delete"
 within:20
 nocase
 content:".appendChild"
 distance:0
 nocase
 content:"setTimeout("
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6327
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32686
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer setTimeout use after free attempt"
 flow:to_client,established
 file_data
 content:"iframe"
 nocase
 content:"getElementById"
 within:300
 nocase
 content:".removeChild"
 within:50
 nocase
 content:"delete"
 within:20
 nocase
 content:".appendChild"
 distance:0
 nocase
 content:"setTimeout("
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6327
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-080
 classtype:attempted-user
 sid:32685
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"HIvIauuKF6i9p*qI1wE8J*znjk3Yl8td"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:33116
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"HIvIauuKF6i9p*qI1wE8J*znjk3Yl8td"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:33115
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document[|22|createElement|22|](\'fr\' + |22|name|22|.substr(1,3) + \'s\' + |22|e|22| + \'t\')"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33196
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document[|22|createElement|22|](\'fr\' + |22|name|22|.substr(1,3) + \'s\' + |22|e|22| + \'t\')"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33195
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_server,established
 file_data
 content:"[|22|appendChild|22|](document.createElement(|22|french|22|.substr(0,2) + \'ame\' + |22|marmaset|22|.substr(5,3)))"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33194
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_server,established
 file_data
 content:"[|22|appendChild|22|](document.createElement(\'fr\' + |22|name|22|.substr(1,3) + \'s\' + |22|e|22| + \'t\'))"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33193
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_client,established
 file_data
 content:"[|22|appendChild|22|](document.createElement(|22|french|22|.substr(0,2) + \'ame\' + |22|marmaset|22|.substr(5,3)))"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33192
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuotes use-after-free attempt"
 flow:to_client,established
 file_data
 content:"[|22|appendChild|22|](document.createElement(\'fr\' + |22|name|22|.substr(1,3) + \'s\' + |22|e|22| + \'t\'))"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6351
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-065
 classtype:attempted-user
 sid:33191
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupTransNavContext object use after free attempt"
 flow:to_server,established
 file_data
 content:"onload"
 content:".focus"
 content:"history.go(0)"
 fast_pattern:only
 content:"onbeforeeditfocus"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0031
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33428
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupTransNavContext object use after free attempt"
 flow:to_client,established
 file_data
 content:"onload"
 content:".focus"
 content:"history.go(0)"
 fast_pattern:only
 content:"onbeforeeditfocus"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0031
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33427
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:"onload"
 nocase
 content:"document.write"
 within:25
 nocase
 content:"<embed></embed>"
 within:25
 fast_pattern
 nocase
 pcre:"/onload\\s*?=[^>]*?document\\.write\\s*?\\x28\\s*?[\\x22\\x27]{2}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0018
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33426
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:"onload"
 nocase
 content:"document.write"
 within:25
 nocase
 content:"<embed></embed>"
 within:25
 fast_pattern
 nocase
 pcre:"/onload\\s*?=[^>]*?document\\.write\\s*?\\x28\\s*?[\\x22\\x27]{2}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0018
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33425
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer memory leak exploit attempt"
 flow:to_client,established
 file_data
 content:"payload += "
 content:"i<0x50000"
 content:"document.execCommand(|22|Outdent|22|"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-0037
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33422
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeDataPos use-after-free remote code execution attempt"
 flow:established,to_client
 file_data
 content:"document.createRange()"
 content:"document.createDocumentFragment()"
 within:100
 content:"appendChild("
 within:100
 content:".selectNodeContents("
 within:150
 content:".replaceNode("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-0041
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33421
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement(|22|cite|22|)"
 fast_pattern:only
 content:".applyElement"
 content:"try"
 within:200
 content:".scrollIntoView(false)"
 within:200
 content:".execCommand(|22|SelectAll|22|)"
 within:200
 content:".removeNode"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33420
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement(|22|cite|22|)"
 fast_pattern:only
 content:".applyElement"
 content:"try"
 within:200
 content:".scrollIntoView(false)"
 within:200
 content:".execCommand(|22|SelectAll|22|)"
 within:200
 content:".removeNode"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33419
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_server
 file_data
 content:"selection.createRange().scrollIntoView(true)"
 fast_pattern
 content:".createElement(|22|frameset|22|)"
 content:"CollectGarbage()"
 content:"|3C|v|3A|oval"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33418
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_client
 file_data
 content:"selection.createRange().scrollIntoView(true)"
 fast_pattern
 content:".createElement(|22|frameset|22|)"
 content:"CollectGarbage()"
 content:"|3C|v|3A|oval"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33417
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLineCore use after free attempt"
 flow:to_server,established
 file_data
 content:".runtimeStyle.position"
 nocase
 content:".parentNode"
 within:75
 nocase
 content:".parentNode.removeNode"
 within:75
 nocase
 content:".appendChild"
 within:75
 nocase
 pcre:"/(?P<ref>\\w+)\\s*?=\\s*?(?P<obj>\\w+)\\x2eparentNode.*?(?P=obj)\\x2eparentNode\\x2eremoveNode.*?(?P=obj)\\x2eappendChild\\s*?\\x28\\s*?(?P=ref)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0045
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33416
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLineCore use after free attempt"
 flow:to_client,established
 file_data
 content:".runtimeStyle.position"
 nocase
 content:".parentNode"
 within:75
 nocase
 content:".parentNode.removeNode"
 within:75
 nocase
 content:".appendChild"
 within:75
 nocase
 pcre:"/(?P<ref>\\w+)\\s*?=\\s*?(?P<obj>\\w+)\\x2eparentNode.*?(?P=obj)\\x2eparentNode\\x2eremoveNode.*?(?P=obj)\\x2eappendChild\\s*?\\x28\\s*?(?P=ref)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0045
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33415
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style type confusion remote code execution attempt"
 flow:established,to_client
 file_data
 content:"setTimeout(function()"
 content:".setAttribute(|27|class|27|"
 within:75
 content:"setTimeout("
 within:75
 content:".removeAttribute(|27|class|27|)"
 within:75
 content:"location.reload()"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-0052
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33412
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMapElement use-after-free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener|28 22|readystatechange|22|, onReadyStateChangeCallback"
 fast_pattern:only
 content:".createElement|28 22|oContainer|22 29|"
 nocase
 content:".createElement|28 22|map|22 29|"
 within:100
 nocase
 content:".createElement|28 22|applet|22 29|"
 within:100
 nocase
 content:".createElement|28 22|map|22 29|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0040
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33366
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMapElement use-after-free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener|28 22|readystatechange|22|, onReadyStateChangeCallback"
 fast_pattern:only
 content:".createElement|28 22|oContainer|22 29|"
 nocase
 content:".createElement|28 22|map|22 29|"
 within:100
 nocase
 content:".createElement|28 22|applet|22 29|"
 within:100
 nocase
 content:".createElement|28 22|map|22 29|"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0040
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33365
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CCharFormat use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.body.createTextRange("
 content:"|22|onpropertychange|22|"
 distance:0
 content:"moveToElementText"
 distance:0
 content:"execCommand("
 distance:0
 content:".select("
 distance:0
 content:".innerText"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0029
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-admin
 sid:33361
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer svg use after free attempt"
 flow:to_server,established
 file_data
 content:"altGlyph"
 content:"marker"
 within:50
 content:"switch"
 within:100
 content:"marker-start"
 within:50
 content:"marker-mid"
 within:100
 content:"InsertOrderedList"
 distance:0
 content:"getElementsByTagNameNS"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33360
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer svg use after free attempt"
 flow:to_client,established
 file_data
 content:"altGlyph"
 content:"marker"
 within:50
 content:"switch"
 within:100
 content:"marker-start"
 within:50
 content:"marker-mid"
 within:100
 content:"InsertOrderedList"
 distance:0
 content:"getElementsByTagNameNS"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0042
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33359
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SLayoutRun use-after-free attempt"
 flow:to_client,established
 file_data
 content:"setTimeout|28|"
 content:".setAttribute"
 within:200
 content:"setTimeout|28|"
 within:200
 content:"document.write"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-0050
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33358
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object used after free attempt"
 flow:to_server,established
 file_data
 content:"<ruby>"
 content:"getElementsByTagName(|22|li|22|"
 fast_pattern
 nocase
 content:"innerText"
 within:50
 content:"ruby"
 content:"removeNode"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0023
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33357
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode object used after free attempt"
 flow:to_client,established
 file_data
 content:"<ruby>"
 content:"getElementsByTagName(|22|li|22|"
 fast_pattern
 nocase
 content:"innerText"
 within:50
 content:"ruby"
 content:"removeNode"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0023
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33356
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray object used after free attempt"
 flow:to_server,established
 file_data
 content:".execCommand|28 27|Delete|27 29|"
 fast_pattern:only
 content:"document.body.createTextRange"
 content:"root.removeChild(root.firstChild)"
 pcre:"/var\\s*([\\d\\w]*)\\s*=\\s*document\\.body\\.createTextRange.*?\\1\\.execCommand\\(\\\'Delete\\\'\\)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0038
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33354
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray object used after free attempt"
 flow:to_client,established
 file_data
 content:".execCommand|28 27|Delete|27 29|"
 fast_pattern:only
 content:"document.body.createTextRange"
 content:"root.removeChild(root.firstChild)"
 pcre:"/var\\s*([\\d\\w]*)\\s*=\\s*document\\.body\\.createTextRange.*?\\1\\.execCommand\\(\\\'Delete\\\'\\)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0038
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33353
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer dximagetransform.microsoft.shadow out of bounds array access attempt"
 flow:to_server,established
 file_data
 content:"dximagetransform.microsoft.shadow"
 nocase
 content:"direction"
 distance:0
 nocase
 pcre:"/dximagetransform\\.microsoft\\.shadow\\x28[^\\x29]*?direction\\s*?=\\s*?\\d{10}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0036
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33349
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dximagetransform.microsoft.shadow out of bounds array access attempt"
 flow:to_client,established
 file_data
 content:"dximagetransform.microsoft.shadow"
 nocase
 content:"direction"
 distance:0
 nocase
 pcre:"/dximagetransform\\.microsoft\\.shadow\\x28[^\\x29]*?direction\\s*?=\\s*?\\d{10}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0036
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33348
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use-after-free attempt"
 flow:to_client,established
 file_data
 content:".style.whiteSpace"
 content:"pre"
 within:20
 content:".offsetWidth"
 within:200
 content:"document.body.createTextRange|28 29|"
 within:200
 fast_pattern
 content:"CollectGarbage|28 29|"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2015-0021
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33347
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CBatchParentUndoUnit object use after free attempt"
 flow:to_server,established
 file_data
 content:"var documentFragment = id_2000.extractContents()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0030
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33346
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CBatchParentUndoUnit object use after free attempt"
 flow:to_client,established
 file_data
 content:"var documentFragment = id_2000.extractContents()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0030
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33345
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use after free attempt"
 flow:to_server,established
 file_data
 content:".createTextRange("
 fast_pattern
 nocase
 content:".onresize"
 within:100
 nocase
 content:"function"
 within:20
 nocase
 content:".execCommand"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0019
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33341
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use after free attempt"
 flow:to_client,established
 file_data
 content:".createTextRange("
 fast_pattern
 nocase
 content:".onresize"
 within:100
 nocase
 content:"function"
 within:20
 nocase
 content:".execCommand"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0019
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33340
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ActiveX type confusion attempt"
 flow:to_server,established
 file_data
 content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"
 fast_pattern:only
 content:"document.body.swapNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0046
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33336
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ActiveX type confusion attempt"
 flow:to_client,established
 file_data
 content:"884E2049-217D-11DA-B2A4-000E7BBB2B09"
 fast_pattern:only
 content:"document.body.swapNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0046
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33335
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Hyphenator object use after free attempt"
 flow:to_server,established
 file_data
 content:".getElementsByTagName("
 nocase
 content:"html"
 within:50
 nocase
 content:"columnWidth"
 within:250
 nocase
 content:"msHyphens"
 within:250
 nocase
 content:"auto"
 within:50
 nocase
 content:"outlineStyle"
 within:250
 nocase
 content:".replaceAdjacentText("
 fast_pattern
 nocase
 content:"afterBegin"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0039
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33334
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Hyphenator object use after free attempt"
 flow:to_client,established
 file_data
 content:".getElementsByTagName("
 nocase
 content:"html"
 within:50
 nocase
 content:"columnWidth"
 within:250
 nocase
 content:"msHyphens"
 within:250
 nocase
 content:"auto"
 within:50
 nocase
 content:"outlineStyle"
 within:250
 nocase
 content:".replaceAdjacentText("
 fast_pattern
 nocase
 content:"afterBegin"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0039
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33333
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditorProxy use after free attempt"
 flow:to_server,established
 file_data
 content:"window.open("
 nocase
 content:".designMode"
 nocase
 content:"on"
 within:20
 nocase
 content:".execCommand("
 within:250
 nocase
 content:"InsertFieldset"
 within:20
 fast_pattern
 nocase
 content:".execCommand("
 within:250
 nocase
 content:"delete"
 within:20
 nocase
 content:".designMode"
 within:250
 nocase
 content:"off"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0049
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33332
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CHTMLEditorProxy use after free attempt"
 flow:to_client,established
 file_data
 content:"window.open("
 nocase
 content:".designMode"
 nocase
 content:"on"
 within:20
 nocase
 content:".execCommand("
 within:250
 nocase
 content:"InsertFieldset"
 within:20
 fast_pattern
 nocase
 content:".execCommand("
 within:250
 nocase
 content:"delete"
 within:20
 nocase
 content:".designMode"
 within:250
 nocase
 content:"off"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0049
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33331
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFormElement use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement("
 nocase
 content:"form"
 within:20
 nocase
 content:".appendChild("
 within:100
 nocase
 content:".createElement("
 within:200
 nocase
 content:".appendChild("
 within:100
 nocase
 content:"null"
 nocase
 content:".body.innerHTML"
 within:50
 nocase
 content:"CollectGarbage("
 within:50
 fast_pattern
 nocase
 content:"document.write("
 within:250
 nocase
 pcre:"/null[^\\x7d]{0,50}\\.body\\.innerHTML\\s*?\\x3d\\s*?[\\x22\\x27]{2}[^\\x7d]{0,50}CollectGarbage\\x28\\s*?\\x29[^\\x7d]{0,250}document\\.write\\x28\\s*?[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33325
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFormElement use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement("
 nocase
 content:"form"
 within:20
 nocase
 content:".appendChild("
 within:100
 nocase
 content:".createElement("
 within:200
 nocase
 content:".appendChild("
 within:100
 nocase
 content:"null"
 nocase
 content:".body.innerHTML"
 within:50
 nocase
 content:"CollectGarbage("
 within:50
 fast_pattern
 nocase
 content:"document.write("
 within:250
 nocase
 pcre:"/null[^\\x7d]{0,50}\\.body\\.innerHTML\\s*?\\x3d\\s*?[\\x22\\x27]{2}[^\\x7d]{0,50}CollectGarbage\\x28\\s*?\\x29[^\\x7d]{0,250}document\\.write\\x28\\s*?[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0026
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33324
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized pointer use exploit attempt"
 flow:to_client,established
 file_data
 content:"document.getElementById("
 content:".recordset"
 within:36
 distance:4
 content:"document.getElementById("
 distance:0
 content:".DataSource"
 distance:0
 pcre:"/(?<RS>\\w+)\\s?=\\s?document\\x2egetElementById\\x28[\\x22\\x27]\\w+[\\x22\\x27]\\x29\\x2erecordset.*(?<OBJ>\\w+)\\s?=\\s?document.getElementById\\x28[\\x22\\x27]\\w+[\\x22\\x27]\\x29.*\\k<RS>.DataSource\\s?=\\s?\\k<OBJ>/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0067
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-admin
 sid:33323
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free attempt"
 flow:to_server,established
 file_data
 content:".execCommand"
 nocase
 content:"insertOrderedList"
 within:50
 fast_pattern
 nocase
 content:".attachEvent"
 nocase
 content:"onpropertychange"
 within:50
 nocase
 content:"noframes"
 nocase
 content:"iframe"
 nocase
 pcre:"/(?P<obj>\\w+)\\s*?=\\s*?document\\.body\\.createtextrange.*?(?P=obj)\\.execCommand\\s*?\\x28\\s*?[\\x22\\x27]\\s*?insertOrderedList/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0020
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33318
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use after free attempt"
 flow:to_client,established
 file_data
 content:".execCommand"
 nocase
 content:"insertOrderedList"
 within:50
 fast_pattern
 nocase
 content:".attachEvent"
 nocase
 content:"onpropertychange"
 within:50
 nocase
 content:"noframes"
 nocase
 content:"iframe"
 nocase
 pcre:"/(?P<obj>\\w+)\\s*?=\\s*?document\\.body\\.createtextrange.*?(?P=obj)\\.execCommand\\s*?\\x28\\s*?[\\x22\\x27]\\s*?insertOrderedList/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0020
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33317
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_server,established
 file_data
 content:"ms-clearUndoStack"
 fast_pattern:only
 content:".setStartBefore"
 nocase
 content:".setEnd"
 within:200
 nocase
 content:"InsertIFrame"
 within:200
 nocase
 content:".scrollIntoView"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0035
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33316
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:"ms-clearUndoStack"
 fast_pattern:only
 content:".setStartBefore"
 nocase
 content:".setEnd"
 within:200
 nocase
 content:"InsertIFrame"
 within:200
 nocase
 content:".scrollIntoView"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0035
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-009
 classtype:attempted-user
 sid:33315
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedSvgTreeNode use-after-free attempt"
 flow:to_client,established
 file_data
 content:"<svg>"
 content:"<linearGradient"
 distance:0
 content:"|22|linearGradient|22|"
 fast_pattern
 content:".x1.baseVal"
 within:25
 distance:2
 pcre:"/<linearGradient[^>]*>\\s*<\\x2flinearGradient>/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0043
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33314
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer InsertElementInternal out of bounds indexed array remote code execution attempt"
 flow:to_server,established
 file_data
 content:".insertBefore(document.body)"
 nocase
 content:"createElement("
 within:60
 nocase
 content:"TR"
 within:5
 nocase
 content:"<body"
 distance:0
 nocase
 content:"</body>"
 within:60
 nocase
 pcre:"/insertBefore\\(document\\.body\\)([^?]+createElement\\([\\x22\\x27]TR[\\x22\\x27]\\)\\))+[^?]+<body[^?]+?<\\/body>/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0044
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33313
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer InsertElementInternal out of bounds indexed array remote code execution attempt"
 flow:to_client,established
 file_data
 content:".insertBefore(document.body)"
 content:"createElement("
 within:60
 nocase
 content:"TR"
 within:5
 nocase
 content:"<body"
 distance:0
 nocase
 content:"</body>"
 within:60
 nocase
 pcre:"/insertBefore\\(document\\.body\\)([^?]+createElement\\([\\x22\\x27]TR[\\x22\\x27]\\)\\))+[^?]+<body[^?]+?<\\/body>/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0044
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:33312
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_server,established
 file_data
 content:".runtimeStyle.posWidth"
 content:"(|7E 7E|"
 within:10
 content:".focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:33606
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_client,established
 file_data
 content:".runtimeStyle.posWidth"
 content:"(|7E 7E|"
 within:10
 content:".focus()"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3882
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-080
 classtype:attempted-user
 sid:33605
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table cell out-of-bounds access attempt"
 flow:to_server,established
 file_data
 content:"X-UA-Compatible"
 fast_pattern
 content:"IE=5"
 within:30
 content:".swapNode"
 nocase
 content:".mergeAttributes"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1625
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33744
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table cell out-of-bounds access attempt"
 flow:to_client,established
 file_data
 content:"X-UA-Compatible"
 fast_pattern
 content:"IE=5"
 within:30
 content:".swapNode"
 nocase
 content:".mergeAttributes"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1625
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33743
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"
 flow:to_server,established
 file_data
 content:".onfocusout"
 nocase
 content:".setActive"
 fast_pattern
 nocase
 content:".setActive"
 within:40
 nocase
 content:".setActive"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33742
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"
 flow:to_client,established
 file_data
 content:".onfocusout"
 nocase
 content:".setActive"
 fast_pattern
 nocase
 content:".setActive"
 within:40
 nocase
 content:".setActive"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33741
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"
 flow:to_server,established
 file_data
 content:".getElementsByTagName"
 content:".innerText"
 within:50
 content:".execCommand"
 within:100
 content:"selectAll"
 within:20
 content:".innerHTML"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1624
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33737
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"
 flow:to_client,established
 file_data
 content:".getElementsByTagName"
 content:".innerText"
 within:50
 content:".execCommand"
 within:100
 content:"selectAll"
 within:20
 content:".innerHTML"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1624
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33736
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_server,established
 file_data
 content:"key-frame"
 fast_pattern
 nocase
 content:"from"
 within:200
 nocase
 content:"cursor"
 within:200
 nocase
 content:"url()"
 within:200
 nocase
 content:"auto"
 within:50
 nocase
 content:"opacity:"
 nocase
 content:"inherit"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0099
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33731
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_client,established
 file_data
 content:"key-frame"
 fast_pattern
 nocase
 content:"from"
 within:200
 nocase
 content:"cursor"
 within:200
 nocase
 content:"url()"
 within:200
 nocase
 content:"auto"
 within:50
 nocase
 content:"opacity:"
 nocase
 content:"inherit"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0099
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33730
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:".createDocumentFragment"
 nocase
 content:".createDocumentFragment"
 within:500
 nocase
 content:".createDocumentFragment"
 within:500
 nocase
 content:"MutationObserver"
 fast_pattern:only
 content:".replaceNode"
 content:".adoptNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1623
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33727
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:".createDocumentFragment"
 nocase
 content:".createDocumentFragment"
 within:500
 nocase
 content:".createDocumentFragment"
 within:500
 nocase
 content:"MutationObserver"
 fast_pattern:only
 content:".replaceNode"
 nocase
 content:".adoptNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1623
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33726
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode interpreted as CGeneratedTreeNode remote code execution attempt"
 flow:established,to_server
 file_data
 content:"list-item"
 nocase
 content:"|3A|after"
 within:50
 nocase
 content:"content|3A|"
 within:30
 nocase
 content:".appendChild"
 within:300
 nocase
 content:".id"
 within:100
 nocase
 pcre:"/\\x2eappendChild.*?\\x2eid.{0,200}?(offset|client)(Height|Left|Parent|Top|Width).{0,200}?(offset|client)(Height|Left|Parent|Top|Width)/is"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1622
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33719
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode interpreted as CGeneratedTreeNode remote code execution attempt"
 flow:established,to_client
 file_data
 content:"list-item"
 nocase
 content:"|3A|after"
 within:50
 nocase
 content:"content|3A|"
 within:30
 nocase
 content:".appendChild"
 within:300
 nocase
 content:".id"
 within:100
 nocase
 pcre:"/\\x2eappendChild.*?\\x2eid.{0,200}?(offset|client)(Height|Left|Parent|Top|Width).{0,200}?(offset|client)(Height|Left|Parent|Top|Width)/is"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1622
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:33718
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"[\'lastChild\'][\'parentNode\'][\'firstChild\'][\'parentNode\'].cloneNode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33708
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"[\'lastChild\'][\'parentNode\'][\'firstChild\'][\'parentNode\'].cloneNode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0056
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-018
 classtype:attempted-user
 sid:33707
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_server,established
 file_data
 content:".insertAdjacentElement"
 nocase
 content:"afterbegin"
 within:25
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:".insertAdjacentElement"
 within:100
 nocase
 content:"beforebegin"
 within:25
 nocase
 content:".push("
 within:50
 nocase
 content:".push("
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-020
 classtype:attempted-user
 sid:33776
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_client,established
 file_data
 content:".insertAdjacentElement"
 nocase
 content:"afterbegin"
 within:25
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:".insertAdjacentElement"
 within:100
 nocase
 content:"beforebegin"
 within:25
 nocase
 content:".push("
 within:50
 nocase
 content:".push("
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-020
 classtype:attempted-user
 sid:33775
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_server,established
 file_data
 content:"76723"
 content:"wrhc"
 within:10
 content:"wrhc"
 within:20
 content:"yarraym"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:33980
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 11 VBScript redim preserve denial-of-service attempt"
 flow:to_client,established
 file_data
 content:"76723"
 content:"wrhc"
 within:10
 content:"wrhc"
 within:20
 content:"yarraym"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-6332
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-064
 classtype:attempted-dos
 sid:33979
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer incorrect array element read information disclosure attempt"
 flow:to_server,established
 file_data
 content:".insertBefore("
 content:".createTextNode("
 within:50
 content:".childNodes"
 within:50
 content:".normalize()"
 fast_pattern:only
 content:"document.createElement("
 content:"document.body.appendChild("
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1657
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34090
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer incorrect array element read information disclosure attempt"
 flow:to_client,established
 file_data
 content:".insertBefore("
 content:".createTextNode("
 within:50
 content:".childNodes"
 within:50
 content:".normalize()"
 fast_pattern:only
 content:"document.createElement("
 content:"document.body.appendChild("
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1657
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34089
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"
 flow:established,to_server
 file_data
 content:"window.location.href=baseURL|2B 22|?refresh="
 fast_pattern:only
 content:"createEvent"
 content:"FocusEvent"
 within:20
 content:"initEvent"
 within:50
 content:"focus"
 within:20
 content:"dispatchEvent"
 within:75
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1652
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34085
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDocument use after free attempt"
 flow:established,to_client
 file_data
 content:"window.location.href=baseURL|2B 22|?refresh="
 fast_pattern:only
 content:"createEvent"
 content:"FocusEvent"
 within:20
 content:"initEvent"
 within:50
 content:"focus"
 within:20
 content:"dispatchEvent"
 within:75
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1652
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34084
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer append and swap use after free attempt"
 flow:to_server,established
 file_data
 content:".appendChild"
 content:".appendChild"
 within:100
 content:".appendChild"
 within:100
 content:".appendChild"
 within:100
 content:".swapNode"
 distance:0
 content:".swapNode"
 within:100
 content:".swapNode"
 within:100
 content:".swapNode"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1659
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34077
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer append and swap use after free attempt"
 flow:to_client,established
 file_data
 content:".appendChild"
 content:".appendChild"
 within:100
 content:".appendChild"
 within:100
 content:".appendChild"
 within:100
 content:".swapNode"
 distance:0
 content:".swapNode"
 within:100
 content:".swapNode"
 within:100
 content:".swapNode"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1659
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34076
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextData object use after free attempt"
 flow:to_server,established
 file_data
 content:".createTextRange"
 fast_pattern:only
 content:".moveToElementText"
 nocase
 content:".moveEnd"
 within:500
 nocase
 content:".moveToElementText"
 nocase
 content:".getElementsByTagName"
 within:500
 nocase
 content:".innerHTML"
 nocase
 content:":nth-child("
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1665
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34075
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextData object use after free attempt"
 flow:to_client,established
 file_data
 content:".createTextRange"
 fast_pattern:only
 content:".moveToElementText"
 nocase
 content:".moveEnd"
 within:500
 nocase
 content:".moveToElementText"
 nocase
 content:".getElementsByTagName"
 within:500
 nocase
 content:".innerHTML"
 nocase
 content:":nth-child("
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1665
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34074
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMetaElement use after free attempt"
 flow:established,to_server
 file_data
 content:"createRange()"
 content:"MutationObserver"
 within:200
 content:".insertBefore"
 content:"mutationRecordsList"
 within:50
 content:".observe(document"
 within:200
 content:".removeChild"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1666
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34073
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMetaElement use after free attempt"
 flow:established,to_client
 file_data
 content:"createRange()"
 content:"MutationObserver"
 within:200
 content:".insertBefore"
 content:"mutationRecordsList"
 within:50
 content:".observe(document"
 within:200
 content:".removeChild"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1666
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34072
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<circle"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34071
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<circle"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34070
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMapStringToPtr use after free attempt"
 flow:to_server,established
 file_data
 content:"appendChild"
 nocase
 content:"createElement"
 within:40
 nocase
 content:"FRAMESET"
 within:30
 nocase
 content:"innerHTML"
 within:40
 nocase
 content:"<table"
 distance:0
 nocase
 content:"removeNode"
 within:170
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1667
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34065
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMapStringToPtr use after free attempt"
 flow:to_client,established
 file_data
 content:"appendChild"
 nocase
 content:"createElement"
 within:40
 nocase
 content:"FRAMESET"
 within:30
 nocase
 content:"innerHTML"
 within:40
 nocase
 content:"<table"
 distance:0
 nocase
 content:"removeNode"
 within:170
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1667
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34064
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CBodyElement use after free attempt"
 flow:to_server,established
 file_data
 content:"onpropertychange"
 nocase
 content:"defaultView.focus"
 within:40
 nocase
 content:"<strong></strong>"
 within:100
 nocase
 content:"<strong></strong>"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1660
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34060
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CBodyElement use after free attempt"
 flow:to_client,established
 file_data
 content:"onpropertychange"
 nocase
 content:"defaultView.focus"
 within:40
 nocase
 content:"<strong></strong>"
 within:100
 nocase
 content:"<strong></strong>"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1660
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-032
 classtype:attempted-user
 sid:34059
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<use"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34212
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<text"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34211
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<rect"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34210
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<polyline"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34209
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<polygon"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34208
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<path"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34207
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<line"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34206
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<image"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34205
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_server,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<ellipse"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34204
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<use"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34203
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<text"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34202
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<polyline"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34201
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<polygon"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34200
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<path"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34199
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<line"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34198
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<image"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34197
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<ellipse"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34196
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGMarkerElement use after free attempt"
 flow:to_client,established
 file_data
 content:".baseVal.convertToSpecifiedUnits"
 fast_pattern:only
 content:"<svg"
 content:"<rect"
 distance:0
 content:"<marker"
 distance:0
 content:"<marker"
 distance:0
 content:"document.createRange()"
 content:".deleteContents()"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1668
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-032
 classtype:attempted-user
 sid:34195
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"
 flow:to_client,established
 file_data
 content:"window.history.ReplaceState"
 fast_pattern:only
 content:"document|2E|createElement"
 content:"applet"
 within:6
 distance:2
 content:"appendChild|28|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2804
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:34321
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer BSTR use after free attempt"
 flow:to_client,established
 file_data
 content:"window.history.pushState"
 fast_pattern:only
 content:"document|2E|createElement"
 content:"applet"
 within:6
 distance:2
 content:"appendChild|28|"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2804
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-037
 classtype:attempted-user
 sid:34320
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onpagehide use after free attempt"
 flow:to_client,established
 file_data
 content:"contentEditable"
 nocase
 content:"true"
 within:6
 content:"onpagehide"
 fast_pattern:only
 content:".createTextRange"
 content:".execCommand"
 distance:0
 content:"InsertInputReset"
 content:"document.write"
 within:14
 distance:4
 content:"iframe"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2014-1795
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-035
 classtype:attempted-user
 sid:34299
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement use after free attempt"
 flow:to_client,established
 file_data
 content:"document.adoptNode(document.getElementsByTagName"
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.all"
 content:".swapNode(document.all"
 within:60
 content:".addEventListener"
 content:"readystatechange"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1714
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34437
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement use after free attempt"
 flow:to_server,established
 file_data
 content:"document.adoptNode(document.getElementsByTagName"
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.adoptNode(document.getElementsByTagName"
 within:150
 content:"document.all"
 content:".swapNode(document.all"
 within:60
 content:".addEventListener"
 content:"readystatechange"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1714
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34436
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBlock use after free attempt"
 flow:to_server,established
 file_data
 content:".styleSheets[0].addRule"
 fast_pattern:only
 content:!"@import"
 content:!"<link rel=|22|stylesheet"
 content:".appendChild("
 content:".appendChild("
 within:50
 content:".appendChild("
 within:50
 content:".swapNode("
 content:".scrollLeft"
 content:".createCaption("
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1658
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34433
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBlock use after free attempt"
 flow:to_client,established
 file_data
 content:".styleSheets[0].addRule"
 fast_pattern:only
 content:!"@import"
 content:!"<link rel=|22|stylesheet"
 content:".appendChild("
 content:".appendChild("
 within:50
 content:".appendChild("
 within:50
 content:".swapNode("
 content:".scrollLeft"
 content:".createCaption("
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1658
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34432
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode use after free attempt"
 flow:to_server,established
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"
 fast_pattern:only
 content:"\'InsertInputSubmit"
 content:"AbsolutePosition"
 within:50
 content:"InsertIFrame"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1710
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34425
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer compatibility mode use after free attempt"
 flow:to_client,established
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=5|22|"
 fast_pattern:only
 content:"\'InsertInputSubmit"
 content:"AbsolutePosition"
 within:50
 content:"InsertIFrame"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1710
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34424
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"createDocumentFragment("
 content:"MutationObserver"
 within:750
 content:"initEvent"
 within:400
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1717
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34423
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"createDocumentFragment("
 content:"MutationObserver"
 within:750
 content:"initEvent("
 within:400
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1717
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34422
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispScroller object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"IE=7"
 fast_pattern:only
 content:"pixelWidth"
 content:"1"
 within:50
 content:"overflowY"
 within:150
 content:"scroll"
 within:50
 content:"createTextRange()"
 content:"InsertButton"
 within:150
 content:".scrollIntoView"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1718
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34421
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispScroller object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"IE=7"
 fast_pattern:only
 content:"pixelWidth"
 content:"1"
 within:50
 content:"overflowY"
 within:150
 content:"scroll"
 within:50
 content:"createTextRange()"
 content:"InsertButton"
 within:150
 content:".scrollIntoView"
 within:150
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1718
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34420
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Element object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"IE=EmulateIE8"
 fast_pattern:only
 content:".replaceChild("
 content:"document.body.contentEditable"
 content:"true"
 within:20
 content:"document.body.append"
 within:200
 content:"document.createElement(|22|img|22|)"
 within:100
 content:"<object "
 content:"clsid:"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1705
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34419
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Element object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"IE=EmulateIE8"
 fast_pattern:only
 content:".replaceChild("
 content:"document.body.contentEditable"
 content:"true"
 within:20
 content:"document.body.append"
 within:200
 content:"document.createElement(|22|img|22|)"
 within:100
 content:"<object "
 content:"clsid:"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1705
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34418
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer dd element use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 content:"dd"
 within:20
 content:".createElement"
 content:"input"
 within:20
 content:"attachEvent"
 content:"onmove"
 within:20
 content:"listener"
 within:50
 content:"InsertSelectDropdown"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1691
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34417
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer dd element use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 content:"dd"
 within:20
 content:".createElement"
 content:"input"
 within:20
 content:"attachEvent"
 content:"onmove"
 within:20
 content:"listener"
 within:50
 content:"InsertSelectDropdown"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1691
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34415
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext type confusion use after free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand("
 content:"Undo"
 within:10
 content:".style.float"
 content:"document."
 content:"meta"
 within:30
 content:"document."
 content:"mark"
 content:"window.location.reload()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1706
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34412
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSecurityContext type confusion use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand("
 content:"Undo"
 within:10
 content:".style.float"
 content:"document."
 content:"meta"
 within:30
 content:"document."
 content:"mark"
 content:"window.location.reload()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1706
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34411
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DOMNodeInserted use-after-free attempt"
 flow:to_server,established
 file_data
 content:"outerText"
 content:"|22|0|22|"
 within:15
 content:"document.documentElement|3B|"
 content:"applyElement"
 within:150
 content:"addEventListener"
 within:150
 content:"|22|DOMNodeInserted|22|"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1689
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34410
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DOMNodeInserted use-after-free attempt"
 flow:to_client,established
 file_data
 content:"outerText"
 content:"|22|0|22|"
 within:15
 content:"document.documentElement|3B|"
 content:"applyElement"
 within:150
 content:"addEventListener"
 within:150
 content:"|22|DOMNodeInserted|22|"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1689
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-043
 classtype:attempted-admin
 sid:34409
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.all"
 content:".appendChild"
 within:100
 content:"document.all"
 distance:0
 content:".swapNode"
 within:100
 content:"document.all"
 distance:0
 content:".appendChild"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1712
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34384
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.all"
 content:".appendChild"
 within:100
 content:"document.all"
 distance:0
 content:".swapNode"
 within:100
 content:"document.all"
 distance:0
 content:".appendChild"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1712
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34383
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer range use after free attempt"
 flow:to_server,established
 file_data
 content:"<table>"
 content:"<tbody"
 within:40
 content:"<tr"
 within:50
 content:"<td"
 within:50
 content:"<q"
 within:50
 content:"<legend"
 within:50
 fast_pattern
 content:"selection.createRange"
 content:"queryCommandState"
 content:"Delete"
 within:6
 distance:2
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1708
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34382
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer range use after free attempt"
 flow:to_client,established
 file_data
 content:"<table>"
 content:"<tbody"
 within:40
 content:"<tr"
 within:50
 content:"<td"
 within:50
 content:"<q"
 within:50
 content:"<legend"
 within:50
 fast_pattern
 content:"selection.createRange"
 content:"queryCommandState"
 content:"Delete"
 within:6
 distance:2
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1708
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-043
 classtype:attempted-user
 sid:34381
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"
 flow:to_server,established
 file_data
 content:"input"
 content:"type"
 within:200
 content:"radio"
 within:200
 content:"onpropertychange"
 within:200
 pcre:"/<input\\s[^>]*?type\\s*=\\s*[\\x22\\x27]?radio[\\x22\\x27]?.*?(?P<doc>\\w+)\\.checked[^>]+(?P=doc)\\.onpropertychange[^>]+?\\.checked/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0286
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:33094
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"
 flow:to_client,established
 file_data
 content:"input"
 content:"type"
 within:200
 content:"radio"
 within:200
 content:"onpropertychange"
 within:200
 pcre:"/<input\\s[^>]*?type\\s*=\\s*[\\x22\\x27]?radio[\\x22\\x27]?.*?(?P<doc>\\w+)\\.checked[^>]+(?P=doc)\\.onpropertychange[^>]+?\\.checked/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0286
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:33093
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_server,established
 file_data
 content:"%5b%27%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%27%5d%28%27%73%63%72%69%70%74%27%29%3b"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:33086
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_client,established
 file_data
 content:"%5b%27%67%65%74%45%6c%65%6d%65%6e%74%73%42%79%54%61%67%4e%61%6d%65%27%5d%28%27%73%63%72%69%70%74%27%29%3b"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:33085
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:32
 fast_pattern
 content:".createElement|28|"
 within:150
 content:"div"
 within:10
 content:".appendChild|28|"
 within:150
 content:".selectAllChildren|28|"
 within:150
 content:".deleteFromDocument|28|"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0274
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:32364
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementByID"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementByID\\x28[\\x22\\x27](?P<obj>\\w+?)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28.*?(?P=obj)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:30506
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementByID"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/\\x3C(?P<obj>\\w+)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+)\\s*?\\x28.*?function\\s+?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementByID\\x28[\\x22\\x27](?P=obj)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:30505
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:"ElementsBytagName"
 nocase
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 content:"CollectGarbage()"
 fast_pattern:only
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7d]*?ElementsByTagName[^\\x7d]*?removeChild\\s*?\\x28.*?object\\s[^\\x3e]*?onerror\\s*?\\x3D\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:30504
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementsBytagName"
 fast_pattern:only
 content:".removeChild"
 nocase
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/\\x3C(?P<obj>\\w+)\\s[^\\x3e]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+)\\s*?\\x28.*?function\\s+?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?getElementsByTagName\\x28[\\x22\\x27](?P=obj)[\\x22\\x27]?\\s*?\\x29[^\\x7d]*?removeChild\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:30503
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_server,established
 file_data
 content:".getElementById"
 content:"<script id="
 nocase
 content:".onpropertychange"
 content:".createElement"
 within:100
 content:"body onload="
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30107
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_client,established
 file_data
 content:".getElementById"
 content:"<script id="
 nocase
 content:".onpropertychange"
 content:".createElement"
 within:100
 content:"body onload="
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:30106
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_server,established
 file_data
 content:".getElementsByTagName"
 content:"script"
 within:10
 nocase
 content:".onpropertychange"
 within:200
 content:".createElement"
 within:200
 content:"SELECT"
 within:10
 nocase
 content:"CollectGarbage()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:29820
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 use after free attempt"
 flow:to_client,established
 file_data
 content:".getElementsByTagName"
 content:"script"
 within:10
 nocase
 content:".onpropertychange"
 within:200
 content:".createElement"
 within:200
 content:"SELECT"
 within:10
 nocase
 content:"CollectGarbage()"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0322
 reference:url,technet.microsoft.com/en-us/security/advisory/2934088
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-012
 classtype:attempted-user
 sid:29819
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"
 flow:to_server,established
 file_data
 content:"input"
 content:"type"
 within:200
 content:"radio"
 within:200
 content:"onpropertychange"
 within:200
 pcre:"/<input\\s[^>]*?type\\s*=\\s*[\\x22\\x27]?radio[\\x22\\x27]?[^>]*?onpropertychange\\s*=\\s*[\\x22\\x27]?(?P<func>\\w+)\\s*\\(.*?(?P=func)\\s*\\([^{]+?\\{[^}]*?\\.(inner|outer)HTML/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0286
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29744
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CInput element user after free attempt"
 flow:to_client,established
 file_data
 content:"input"
 content:"type"
 within:200
 content:"radio"
 within:200
 content:"onpropertychange"
 within:200
 pcre:"/<input\\s[^>]*?type\\s*=\\s*[\\x22\\x27]?radio[\\x22\\x27]?[^>]*?onpropertychange\\s*=\\s*[\\x22\\x27]?(?P<func>\\w+)\\s*\\(.*?(?P=func)\\s*\\([^{]+?\\{[^}]*?\\.(inner|outer)HTML/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0286
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29743
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer selectall use after free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand("
 content:"SelectAll"
 within:20
 content:"setTimeout("
 content:"document.appendChild("
 within:50
 content:"document.body."
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0287
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29736
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer selectall use after free attempt"
 flow:to_client,established
 file_data
 content:"document.execCommand("
 content:"SelectAll"
 within:20
 content:"setTimeout("
 content:"document.appendChild("
 within:50
 content:"document.body."
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0287
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:29735
 rev:9
)\n', 'alert tcp any any -> $HOME_NET 25 (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:32
 fast_pattern
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:32
 content:"getSelection().removeAllRanges("
 within:128
 content:"getSelection().deleteFromDocument("
 distance:0
 pcre:"/\\.addEventListener\\s*\\x28\\s*[\\x22\\x27]DOMNodeRemoved[\\x22\\x27][^\\x29]*?function(?:(?!\\)\\x3b).)*?\\{[^}]*?\\.removeEventListener\\s*\\x28\\s*[\\x22\\x27]DOMNodeRemoved[\\x22\\x27][^}]*?getselection\\s*\\x28.*?\\x29\\.removeAllRanges\\s*\\x28.*?\\x29\\x3b[^}]*?\\}.*?getSelection\\s*\\x28.*?\\x29\\.deleteFromDocument/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0274
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29734
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer overlapping object boundaries memory corruption attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 content:"DOMNodeRemoved"
 within:32
 fast_pattern
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:32
 content:"getSelection().removeAllRanges("
 within:128
 content:"getSelection().deleteFromDocument("
 distance:0
 pcre:"/\\.addEventListener\\s*\\x28\\s*[\\x22\\x27]DOMNodeRemoved[\\x22\\x27][^\\x29]*?function(?:(?!\\)\\x3b).)*?\\{[^}]*?\\.removeEventListener\\s*\\x28\\s*[\\x22\\x27]DOMNodeRemoved[\\x22\\x27][^}]*?getselection\\s*\\x28.*?\\x29\\.removeAllRanges\\s*\\x28.*?\\x29\\x3b[^}]*?\\}.*?getSelection\\s*\\x28.*?\\x29\\.deleteFromDocument/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0274
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-010
 classtype:attempted-user
 sid:29733
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"
 flow:to_server,established
 file_data
 content:"body.contentEditable"
 fast_pattern:only
 content:"execCommand"
 nocase
 content:"execCommand"
 within:40
 nocase
 content:"Insert"
 within:6
 distance:2
 nocase
 content:"onload"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,61668
 reference:cve,2013-3184
 reference:url,osvdb.org/show/osvdb/96182
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:29651
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"
 flow:to_client,established
 file_data
 content:"body.contentEditable"
 fast_pattern:only
 content:"execCommand"
 nocase
 content:"execCommand"
 within:40
 nocase
 content:"Insert"
 within:6
 distance:2
 nocase
 content:"onload"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,61668
 reference:cve,2013-3184
 reference:url,osvdb.org/show/osvdb/96182
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:29650
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_server,established
 file_data
 content:"contentEditable"
 nocase
 content:"true"
 within:20
 nocase
 content:"document.execCommand"
 within:40
 nocase
 content:"InsertInput"
 within:25
 nocase
 content:".inner"
 within:45
 nocase
 content:"onbeforeeditfocus"
 within:100
 fast_pattern
 nocase
 pcre:"/function\\s+?(?P<trigger>\\w+)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]+?document\\.write.*?(window\\.onload|function|body)\\s*?\\x3d?\\s*?(?P<activate>\\w+).*?(onactivate|onbeforeeditfocus)\\s*?\\x3d\\s*?[\\x22\\x27]?\\s*?((?P=trigger)|(?P=activate))/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:29035
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_client,established
 file_data
 content:"contentEditable"
 nocase
 content:"true"
 within:20
 nocase
 content:"document.execCommand"
 within:40
 nocase
 content:"InsertInput"
 within:25
 nocase
 content:".inner"
 within:45
 nocase
 content:"onbeforeeditfocus"
 within:100
 fast_pattern
 nocase
 pcre:"/function\\s+?(?P<trigger>\\w+)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]+?document\\.write.*?(window\\.onload|function|body)\\s*?\\x3d?\\s*?(?P<activate>\\w+).*?(onactivate|onbeforeeditfocus)\\s*?\\x3d\\s*?[\\x22\\x27]?\\s*?((?P=trigger)|(?P=activate))/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:29034
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 content:".removeChild"
 distance:0
 nocase
 pcre:"/<object[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<obj>\\w+?)[\\x22\\x27]?[^>]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+?)\\s*?\\x28.*?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?\\x2eremoveChild\\s*?\\x28\\s*?[\\x22\\x27]?(?P=obj)[\\x22\\x27]?\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28878
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_server,established
 file_data
 content:".removeChild"
 nocase
 content:"<object"
 distance:0
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?\\x2eremoveChild\\s*?\\x28\\s*?[\\x22\\x27]?(?P<obj>\\w+?)[\\x22\\x27]?\\s*?\\x29.*?<object[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P=obj)[\\x22\\x27]?[^>]*?onerror\\s*?=\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28877
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:"<object"
 nocase
 content:"onerror"
 within:75
 nocase
 content:".removeChild"
 distance:0
 nocase
 pcre:"/<object[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P<obj>\\w+?)[\\x22\\x27]?[^>]*?onerror\\s*?=\\s*?[\\x22\\x27](?P<func>\\w+?)\\s*?\\x28.*?(?P=func)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?\\x2eremoveChild\\s*?\\x28\\s*?[\\x22\\x27]?(?P=obj)[\\x22\\x27]?\\s*?\\x29/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28876
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetClassObject use after free attempt"
 flow:to_client,established
 file_data
 content:".removeChild"
 nocase
 content:"<object"
 distance:0
 nocase
 content:"onerror"
 within:75
 nocase
 pcre:"/function\\s+?(?P<func>\\w+?)\\s*?\\x28[^\\x7b]+?\\x7b[^\\x7d]*?\\x2eremoveChild\\s*?\\x28\\s*?[\\x22\\x27]?(?P<obj>\\w+?)[\\x22\\x27]?\\s*?\\x29.*?<object[^>]+?id\\s*?=\\s*?[\\x22\\x27]?(?P=obj)[\\x22\\x27]?[^>]*?onerror\\s*?=\\s*?[\\x22\\x27](?P=func)\\s*?\\x28/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-5049
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-097
 classtype:attempted-user
 sid:28875
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAnchorElement use after free attempt"
 flow:to_client,established
 file_data
 content:"name"
 content:"window.navigate|28|"
 distance:0
 content:"document.open|28|"
 within:100
 pcre:"/a\\sname\\s*=\\s*(\\x22|\\x27)(?P<anchor>\\w+).*?window\\.navigate\\x28(\\x22|\\x27)\\x23(?P=anchor)(\\x22|\\x27)\\x29.*?document\\.open\\x28(\\x22|\\x27)(?!(?P=anchor))/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http
 reference:cve,2013-3871
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-088
 classtype:attempted-user
 sid:28489
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer swapNode memory corruption attempt"
 flow:to_server,established
 file_data
 content:".onpropertychange"
 nocase
 content:"execCommand"
 within:500
 nocase
 content:".onselect"
 nocase
 content:".swapNode"
 within:500
 fast_pattern
 nocase
 pcre:"/\\x2eappendChild\\s*\\x28\\s*(?P<var>\\w+)\\s*\\x29.*?(?P=var)\\x2eonselect[^\\x7d]+\\x2eswapNode.*?(?P=var)\\x2eselect/smiO"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,62811
 reference:cve,2013-3897
 reference:url,osvdb.org/show/osvdb/98207
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080
 classtype:attempted-user
 sid:28208
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer swapNode memory corruption attempt"
 flow:to_client,established
 file_data
 content:".onpropertychange"
 nocase
 content:"execCommand"
 within:500
 nocase
 content:".onselect"
 nocase
 content:".swapNode"
 within:500
 fast_pattern
 nocase
 pcre:"/\\x2eappendChild\\s*\\x28\\s*(?P<var>\\w+)\\s*\\x29.*?(?P=var)\\x2eonselect[^\\x7d]+\\x2eswapNode.*?(?P=var)\\x2eselect/smiO"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,62811
 reference:cve,2013-3897
 reference:url,osvdb.org/show/osvdb/98207
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-080
 classtype:attempted-user
 sid:28207
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer onlosecapture memory corruption attempt"
 flow:to_server,established
 file_data
 content:".applyElement"
 content:".onlosecapture"
 within:500
 fast_pattern
 content:".setCapture"
 within:500
 content:".setCapture"
 within:500
 pcre:"/\\x2eapplyElement\\s*\\x28\\s*(?P<var>\\w+)\\s*\\x29.*?(?P=var)\\x2eonlosecapture\\s*=.*?(?P=var)\\x2esetCapture\\s*\\x28.*?\\x2esetCapture\\s*\\x28/smiO"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,62453
 reference:cve,2013-3893
 reference:url,osvdb.org/show/osvdb/97380
 reference:url,technet.microsoft.com/en-us/security/advisory/2887505
 classtype:attempted-user
 sid:27944
 rev:9
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer onlosecapture memory corruption attempt"
 flow:to_client,established
 file_data
 content:".applyElement"
 content:".onlosecapture"
 within:500
 fast_pattern
 content:".setCapture"
 within:500
 content:".setCapture"
 within:500
 pcre:"/\\x2eapplyElement\\s*\\x28\\s*(?P<var>\\w+)\\s*\\x29.*?(?P=var)\\x2eonlosecapture\\s*=.*?(?P=var)\\x2esetCapture\\s*\\x28.*?\\x2esetCapture\\s*\\x28/smiO"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,62453
 reference:cve,2013-3893
 reference:url,osvdb.org/show/osvdb/97380
 reference:url,technet.microsoft.com/en-us/security/advisory/2887505
 classtype:attempted-user
 sid:27943
 rev:8
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementsByTagName"
 nocase
 content:"|28 22|textarea|22 29|"
 within:12
 nocase
 content:"innerHTML"
 within:75
 nocase
 content:"<blockcode>"
 within:25
 nocase
 content:"document.getElementsByTagName"
 within:60
 nocase
 content:"|28 22|textarea|22 29|"
 within:12
 nocase
 content:"<textarea><script>"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3845
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27844
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagName"
 nocase
 content:"|28 22|textarea|22 29|"
 within:12
 nocase
 content:"innerHTML"
 within:75
 nocase
 content:"<blockcode>"
 within:25
 nocase
 content:"document.getElementsByTagName"
 within:60
 nocase
 content:"|28 22|textarea|22 29|"
 within:12
 nocase
 content:"<textarea><script>"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3845
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-069
 classtype:attempted-user
 sid:27843
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_server,established
 file_data
 content:"document.write|28|"
 nocase
 content:"catch (err)"
 within:25
 distance:5
 nocase
 content:"document.body.contentEditable"
 within:75
 distance:20
 nocase
 content:"document.execCommand|28|"
 within:55
 distance:25
 nocase
 content:"document.body.innerHTML +="
 within:55
 distance:200
 nocase
 content:"catch |28|err|29|"
 within:25
 distance:5
 nocase
 content:"|3C|body onbeforeeditfocus=eval|28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27838
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_client,established
 file_data
 content:"document.write|28|"
 nocase
 content:"catch |28|err|29|"
 within:25
 distance:5
 nocase
 content:"document.body.contentEditable"
 within:75
 distance:20
 nocase
 content:"document.execCommand|28|"
 within:55
 distance:25
 nocase
 content:"document.body.innerHTML +="
 within:55
 distance:200
 nocase
 content:"catch |28|err|29|"
 within:25
 distance:5
 nocase
 content:"|3C|body onbeforeeditfocus=eval|28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:27837
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"
 flow:to_server,established
 file_data
 content:".innerText="
 nocase
 content:"body.contentEditable"
 fast_pattern:only
 content:"false"
 nocase
 content:"execCommand"
 within:200
 nocase
 content:"InsertImage"
 within:11
 distance:2
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3184
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27616
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MoveToMarkupPointer call with CControlTracker OnExitTree use-after-free attempt"
 flow:to_client,established
 file_data
 content:".innerText="
 nocase
 content:"body.contentEditable"
 fast_pattern:only
 content:"false"
 nocase
 content:"execCommand"
 within:200
 nocase
 content:"InsertImage"
 within:11
 distance:2
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3184
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-059
 classtype:attempted-user
 sid:27615
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement("
 nocase
 content:"document.body.appendChild("
 within:100
 nocase
 content:"applyElement("
 within:100
 fast_pattern
 nocase
 content:"innerHTML"
 within:100
 nocase
 pcre:"/var\\s*?(?P<badelement>\\w+)\\s*?=\\s*?document\\.createElement.*?document\\.body\\.appendChild[\\x28]\\s*?(?P=badelement)\\s*?[\\x29].*?applyElement[\\x28]\\s*?(?P=badelement)\\s*?[\\x29].*?innerHTML\\s*?=\\s*?[\\x22\\x27]\\s*?[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27172
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement("
 nocase
 content:"document.body.appendChild("
 within:100
 nocase
 content:"applyElement("
 within:100
 fast_pattern
 nocase
 content:"innerHTML"
 within:100
 nocase
 pcre:"/var\\s*?(?P<badelement>\\w+)\\s*?=\\s*?document\\.createElement.*?document\\.body\\.appendChild[\\x28]\\s*?(?P=badelement)\\s*?[\\x29].*?applyElement[\\x28]\\s*?(?P=badelement)\\s*?[\\x29].*?innerHTML\\s*?=\\s*?[\\x22\\x27]\\s*?[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27171
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"myObj[0].offset"
 fast_pattern:only
 content:"document.getElementsByName("
 nocase
 content:"document.execCommand(|22|Justify"
 within:200
 nocase
 content:"document.execCommand("
 within:100
 nocase
 content:"SelectAll"
 within:9
 distance:1
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27153
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"myObj[0].offset"
 fast_pattern:only
 content:"document.execCommand("
 nocase
 content:"SelectAll"
 within:9
 distance:1
 nocase
 content:"document.getElementsByName("
 within:200
 nocase
 content:"document.execCommand(|22|Justify"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27152
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"myObj[0].offset"
 fast_pattern:only
 content:"document.getElementsByName("
 nocase
 content:"document.execCommand(|22|Justify"
 within:200
 nocase
 content:"document.execCommand("
 within:100
 nocase
 content:"SelectAll"
 within:9
 distance:1
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27151
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"myObj[0].offset"
 fast_pattern:only
 content:"document.execCommand("
 nocase
 content:"SelectAll"
 within:9
 distance:1
 nocase
 content:"document.getElementsByName("
 within:200
 nocase
 content:"document.execCommand(|22|Justify"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:27150
 rev:7
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer covered object memory corruption attempt"
 flow:to_client,established
 file_data
 content:"style="
 nocase
 content:"padding-left|3A|-1000px"
 distance:0
 nocase
 content:"text-indent|3A|-1000px"
 distance:0
 nocase
 pcre:"/<[A-Z]+\\s+[^>]*?padding-left\\x3A\\x2D1000px\\x3B[^>]*text-indent\\x3A\\x2D1000px/smi"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service http
 reference:cve,2011-1256
 reference:cve,2012-1260
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms11-050
 classtype:attempted-user
 sid:19809
 rev:11
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Apple Safari-Internet Explorer SearchPath blended threat dll request"
 flow:to_server,established
 content:".dll"
 nocase
 http_uri
 content:"Safari"
 http_header
 pcre:"/^User\\x2dAgent\\x3a\\s*[^\\n]*Safari[^\\n]*\\r\\n/smi"
 flowbits:set,safari.dll
 flowbits:noalert
 metadata:policy max-detect-ips drop, service http
 reference:cve,2008-2540
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS09-015
 classtype:attempted-user
 sid:15468
 rev:14
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"<area id="
 content:"document.createElement|28|"
 nocase
 content:"AREA"
 within:15
 nocase
 content:".appendChild|28|"
 distance:0
 content:".insertAdjacentText|28|"
 distance:0
 content:"document.createElement|28|"
 distance:0
 nocase
 content:"IFRAME"
 within:15
 nocase
 content:"document.execCommand|28|"
 distance:0
 nocase
 content:"undo"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1732
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-admin
 sid:34791
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"<area id="
 content:"document.createElement|28|"
 nocase
 content:"AREA"
 within:15
 nocase
 content:".appendChild|28|"
 distance:0
 content:".insertAdjacentText|28|"
 distance:0
 content:"document.createElement|28|"
 distance:0
 nocase
 content:"IFRAME"
 within:15
 nocase
 content:"document.execCommand|28|"
 distance:0
 nocase
 content:"undo"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1732
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-admin
 sid:34790
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer LayoutLineBoxFullShort use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"optgroup"
 within:15
 nocase
 content:".createElement"
 nocase
 content:"canvas"
 within:15
 nocase
 content:".outerHTML"
 content:".outerHTML"
 within:50
 content:".execCommand"
 nocase
 content:"JustifyRight"
 within:15
 nocase
 content:".execCommand"
 nocase
 content:"BackColor"
 within:15
 nocase
 content:".execCommand"
 nocase
 content:"FontSize"
 within:15
 nocase
 content:"window.location.reload|28 29 3B|"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1731
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-user
 sid:34779
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer LayoutLineBoxFullShort use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"optgroup"
 within:15
 nocase
 content:".createElement"
 nocase
 content:"canvas"
 within:15
 nocase
 content:".outerHTML"
 content:".outerHTML"
 within:50
 content:".execCommand"
 nocase
 content:"JustifyRight"
 within:15
 nocase
 content:".execCommand"
 nocase
 content:"BackColor"
 within:15
 nocase
 content:".execCommand"
 nocase
 content:"FontSize"
 within:15
 nocase
 content:"window.location.reload|28 29 3B|"
 distance:0
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1731
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-user
 sid:34778
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer textarea parent use-after-free attempt"
 flow:to_server,established
 file_data
 content:"IE=8"
 nocase
 content:"body onpropertychange"
 nocase
 content:"document.body.applyElement"
 within:30
 nocase
 content:"textarea"
 within:100
 nocase
 content:"body style"
 within:100
 nocase
 content:"border-image-slice"
 within:30
 nocase
 content:"<q></q>"
 within:50
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1750
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34768
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer textarea parent use-after-free attempt"
 flow:to_client,established
 file_data
 content:"IE=8"
 nocase
 content:"body onpropertychange"
 nocase
 content:"document.body.applyElement"
 within:30
 nocase
 content:"textarea"
 within:100
 nocase
 content:"body style"
 within:100
 nocase
 content:"border-image-slice"
 within:30
 nocase
 content:"<q></q>"
 within:50
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1750
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34767
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CStyleAttrArray use after free attempt"
 flow:established,to_server
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=EmulateIE7|22|"
 fast_pattern:only
 content:".getAttributeNode("
 content:"spellcheck"
 within:30
 content:"-ms-block-progression:lr"
 content:"CollectGarbage()"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1736
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:policy-violation
 sid:34766
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CStyleAttrArray use after free attempt"
 flow:established,to_client
 file_data
 content:"meta http-equiv=|22|X-UA-Compatible|22| content=|22|IE=EmulateIE7|22|"
 fast_pattern:only
 content:".getAttributeNode("
 content:"spellcheck"
 within:30
 content:"-ms-block-progression:lr"
 content:"CollectGarbage()"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1736
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:policy-violation
 sid:34765
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 8 mode menu tag out-of-bounds access attempt"
 flow:to_server,established
 file_data
 content:"http://http://<>http://http://<>"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1752
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34764
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 8 mode menu tag out-of-bounds access attempt"
 flow:to_client,established
 file_data
 content:"http://http://<>http://http://<>"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1752
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34763
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTableSection object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"childNodes[0]"
 nocase
 content:"height"
 within:20
 nocase
 content:"listStyleImage"
 within:35
 nocase
 content:"none"
 within:10
 nocase
 content:"posHeight"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service smtp
 reference:cve,2015-1687
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34760
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 CTableSection object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"childNodes[0]"
 nocase
 content:"height"
 within:20
 nocase
 content:"listStyleImage"
 within:35
 nocase
 content:"none"
 within:10
 nocase
 content:"posHeight"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1687
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34759
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLegendElement object use after free attempt"
 flow:to_server,established
 file_data
 content:".createTextRange"
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"insertMarquee"
 within:25
 fast_pattern
 nocase
 content:".scrollIntoView"
 within:100
 nocase
 content:".execCommand"
 nocase
 content:"Undo"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1753
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34754
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLegendElement object use after free attempt"
 flow:to_client,established
 file_data
 content:".createTextRange"
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"insertMarquee"
 within:25
 fast_pattern
 nocase
 content:".scrollIntoView"
 within:100
 nocase
 content:".execCommand"
 nocase
 content:"Undo"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1753
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34753
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBlock object use after free attempt"
 flow:to_client,established
 file_data
 content:".replaceChild"
 fast_pattern
 nocase
 content:".hidden"
 within:75
 nocase
 content:"true"
 within:25
 nocase
 content:".createElementNS"
 nocase
 content:"xhtml"
 within:50
 nocase
 content:"tfoot"
 within:25
 nocase
 content:".innerText"
 nocase
 content:".innerText"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1751
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34750
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBlock object use after free attempt"
 flow:to_server,established
 file_data
 content:".replaceChild"
 fast_pattern
 nocase
 content:".hidden"
 within:75
 nocase
 content:"true"
 within:25
 nocase
 content:".createElementNS"
 nocase
 content:"xhtml"
 within:50
 nocase
 content:"tfoot"
 within:25
 nocase
 content:".innerText"
 nocase
 content:".innerText"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1751
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34749
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CoInternetParseUrl use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.body.setCapture"
 nocase
 content:"document.body.onlostpointercapture"
 within:60
 nocase
 content:"document.open"
 within:50
 nocase
 content:".getElementbyId"
 within:50
 nocase
 content:".contentWindow.showModelessDialog"
 within:60
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1740
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34748
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CoInternetParseUrl use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.body.setCapture"
 nocase
 content:"document.body.onlostpointercapture"
 within:60
 nocase
 content:"document.open"
 within:50
 nocase
 content:".getElementbyId"
 within:50
 nocase
 content:".contentWindow.showModelessDialog"
 within:60
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1740
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34747
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextNode object use after free attempt"
 flow:to_server,established
 file_data
 content:".execCommand"
 nocase
 content:"BlockDirLTR"
 within:25
 fast_pattern
 nocase
 content:".body.contentEditable"
 nocase
 content:"true"
 within:15
 nocase
 content:".msElementsFromRect"
 nocase
 content:".reload"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1737
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-user
 sid:34746
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextNode object use after free attempt"
 flow:to_client,established
 file_data
 content:".execCommand"
 nocase
 content:"BlockDirLTR"
 within:25
 fast_pattern
 nocase
 content:".body.contentEditable"
 nocase
 content:"true"
 within:15
 nocase
 content:".msElementsFromRect"
 nocase
 content:".reload"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1737
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-056
 classtype:attempted-user
 sid:34745
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer COptionElement object use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"datalist"
 within:25
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".removeNode"
 within:100
 nocase
 content:".options.item"
 within:100
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1755
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34736
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer COptionElement object use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"datalist"
 within:25
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".removeNode"
 within:100
 nocase
 content:".options.item"
 within:100
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1755
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34735
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DataView use-after-free attempt"
 flow:to_server,established
 file_data
 content:"getInt32"
 fast_pattern:only
 content:"ArrayBuffer"
 nocase
 content:"DataView"
 nocase
 content:"valueOf"
 nocase
 content:"postMessage"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1747
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34728
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DataView use-after-free attempt"
 flow:to_client,established
 file_data
 content:"getInt32"
 fast_pattern:only
 content:"ArrayBuffer"
 nocase
 content:"DataView"
 nocase
 content:"valueOf"
 nocase
 content:"postMessage"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1747
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34727
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode undefined beforeElement use-after-free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 nocase
 content:"load"
 within:10
 content:".document.designMode"
 within:50
 nocase
 content:"on"
 within:20
 nocase
 content:".document.write"
 within:50
 nocase
 content:"<pre>"
 within:50
 nocase
 content:".document.insertBefore"
 within:100
 nocase
 pcre:"/\\x2Edocument\\x2EinsertBefore\\s*\\x28[^\\x2C]+\\x29/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1766
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34726
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode undefined beforeElement use-after-free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 nocase
 content:"load"
 within:10
 content:".document.designMode"
 within:50
 nocase
 content:"on"
 within:20
 nocase
 content:".document.write"
 within:50
 nocase
 content:"<pre>"
 within:50
 nocase
 content:".document.insertBefore"
 within:100
 nocase
 pcre:"/\\x2Edocument\\x2EinsertBefore\\s*\\x28[^\\x2C]+\\x29/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1766
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34725
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"rtc"
 within:15
 nocase
 content:".innerText"
 within:500
 nocase
 content:"table-footer-group"
 within:50
 nocase
 content:".scrollTop"
 within:100
 nocase
 content:".background"
 within:100
 nocase
 pcre:"/\\.background\\s*=\\s*[\\x22\\x27]{2}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1742
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34724
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array access attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"rtc"
 within:15
 nocase
 content:".innerText"
 within:500
 nocase
 content:"table-footer-group"
 within:50
 nocase
 content:".scrollTop"
 within:100
 nocase
 content:".background"
 within:100
 nocase
 pcre:"/\\.background\\s*=\\s*[\\x22\\x27]{2}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1742
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34723
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer callback function use-after-free attempt"
 flow:to_server,established
 file_data
 content:"function()"
 nocase
 content:"cloneContents()"
 within:100
 nocase
 content:"toString"
 within:75
 nocase
 content:"document.write"
 within:50
 nocase
 content:"window"
 within:100
 nocase
 content:"styleMedia"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1741
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34722
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer callback function use-after-free attempt"
 flow:to_client,established
 file_data
 content:"function()"
 nocase
 content:"cloneContents()"
 within:100
 nocase
 content:"toString"
 within:75
 nocase
 content:"document.write"
 within:50
 nocase
 content:"window"
 within:100
 nocase
 content:"styleMedia"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1741
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:34721
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer moveEnd information disclosure attempt"
 flow:to_server,established
 file_data
 content:"document.createElementNS("
 fast_pattern
 content:"http://www.w3.org/2000/svg"
 within:50
 content:"svg"
 within:30
 content:":nth-"
 content:".createTextRange("
 content:".moveEnd"
 content:"-"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:url,garage4hackers.com/showthread.php?t=6246
 classtype:attempted-recon
 sid:34825
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer moveEnd information disclosure attempt"
 flow:to_client,established
 file_data
 content:"document.createElementNS("
 fast_pattern
 content:"http://www.w3.org/2000/svg"
 within:50
 content:"svg"
 within:30
 content:":nth-"
 content:".createTextRange("
 content:".moveEnd"
 content:"-"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:url,garage4hackers.com/showthread.php?t=6246
 classtype:attempted-recon
 sid:34824
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTextElement use after free attempt"
 flow:to_server,established
 file_data
 content:"<form"
 content:"<textarea"
 distance:0
 content:"onpropertychange="
 distance:0
 content:"document.getElementById"
 within:200
 nocase
 content:".reset()|3B|"
 within:200
 content:".innerHTML = |22 22 3B|"
 within:200
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2782
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:34874
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTextElement use after free attempt"
 flow:to_client,established
 file_data
 content:"<form"
 content:"<textarea"
 distance:0
 content:"onpropertychange="
 distance:0
 content:"document.getElementById"
 within:200
 nocase
 content:".reset()|3B|"
 within:200
 content:".innerHTML = |22 22 3B|"
 within:200
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2782
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:34873
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"
 flow:to_server,established
 file_data
 content:".contentEditable"
 nocase
 content:"true"
 within:20
 content:".onfocusout"
 nocase
 content:".focus"
 fast_pattern
 nocase
 content:".focus"
 within:40
 nocase
 content:".focus"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:35013
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode use-after-free attempt"
 flow:to_client,established
 file_data
 content:".contentEditable"
 nocase
 content:"true"
 within:20
 content:".onfocusout"
 nocase
 content:".focus"
 fast_pattern
 nocase
 content:".focus"
 within:40
 nocase
 content:".focus"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-018
 classtype:attempted-user
 sid:35012
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 10 VBScript array element use after free attempt"
 flow:to_server,established
 file_data
 content:"ReDim"
 nocase
 content:"Property Get"
 nocase
 content:"Erase"
 within:50
 nocase
 content:"End Property"
 within:50
 nocase
 content:"Set"
 distance:0
 nocase
 content:"Join"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2372
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35214
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 10 VBScript array element use after free attempt"
 flow:to_client,established
 file_data
 content:"ReDim"
 nocase
 content:"Property Get"
 nocase
 content:"Erase"
 within:50
 nocase
 content:"End Property"
 within:50
 nocase
 content:"Set"
 distance:0
 nocase
 content:"Join"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2372
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35213
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:"<applet"
 fast_pattern
 nocase
 content:"codebase"
 within:100
 nocase
 content:"|27 27|"
 within:5
 content:"onerror"
 within:150
 distance:-50
 nocase
 content:".styleSheets"
 nocase
 content:".cssText"
 within:100
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2404
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35212
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_server,established
 file_data
 content:"<applet"
 fast_pattern
 nocase
 content:"codebase"
 within:100
 nocase
 content:"|22 22|"
 within:5
 content:"onerror"
 within:150
 distance:-50
 nocase
 content:".styleSheets"
 nocase
 content:".cssText"
 within:100
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2404
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35211
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:"<applet"
 fast_pattern
 nocase
 content:"codebase"
 within:100
 nocase
 content:"|27 27|"
 within:5
 content:"onerror"
 within:150
 distance:-50
 nocase
 content:".styleSheets"
 nocase
 content:".cssText"
 within:100
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2404
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35210
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup object use after free attempt"
 flow:to_client,established
 file_data
 content:"<applet"
 fast_pattern
 nocase
 content:"codebase"
 within:100
 nocase
 content:"|22 22|"
 within:5
 content:"onerror"
 within:150
 distance:-50
 nocase
 content:".styleSheets"
 nocase
 content:".cssText"
 within:100
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2404
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35209
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object use after free attempt"
 flow:to_server,established
 file_data
 content:".appendChild"
 nocase
 content:".replaceNode"
 within:125
 fast_pattern
 nocase
 content:".location.reload"
 within:125
 nocase
 content:".addEventListener"
 nocase
 content:"DOMAttrModified"
 within:30
 nocase
 content:"<base"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2383
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35206
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object use after free attempt"
 flow:to_client,established
 file_data
 content:".appendChild"
 nocase
 content:".replaceNode"
 within:125
 fast_pattern
 nocase
 content:".location.reload"
 within:125
 nocase
 content:".addEventListener"
 nocase
 content:"DOMAttrModified"
 within:30
 nocase
 content:"<base"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2383
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35205
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"base"
 within:25
 nocase
 content:".applyElement"
 within:100
 nocase
 content:"inside"
 within:50
 nocase
 content:".createRange"
 fast_pattern
 nocase
 content:".selectNode"
 within:75
 nocase
 content:".insertNode"
 within:75
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2383
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35204
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"base"
 within:25
 nocase
 content:".applyElement"
 within:100
 nocase
 content:"inside"
 within:50
 nocase
 content:".createRange"
 fast_pattern
 nocase
 content:".selectNode"
 within:75
 nocase
 content:".insertNode"
 within:75
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2383
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35203
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TreeComputedContent object use after free attempt"
 flow:to_server,established
 file_data
 content:"addEventListener"
 content:"DOMNodeRemoved"
 within:30
 content:"swapNode"
 distance:0
 fast_pattern
 content:"insertAdjacentHTML"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2411
 reference:cve,2015-6073
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:35200
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TreeComputedContent object use after free attempt"
 flow:to_client,established
 file_data
 content:"addEventListener"
 content:"DOMNodeRemoved"
 within:30
 content:"swapNode"
 distance:0
 fast_pattern
 content:"insertAdjacentHTML"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2411
 reference:cve,2015-6073
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:35199
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFieldSetElement object use after free attempt"
 flow:to_server,established
 file_data
 content:"document.charset"
 nocase
 content:"gb2312"
 within:25
 fast_pattern
 nocase
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 content:"insertFieldset"
 nocase
 content:".execCommand"
 nocase
 content:"delete"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1738
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35197
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFieldSetElement object use after free attempt"
 flow:to_client,established
 file_data
 content:"document.charset"
 nocase
 content:"gb2312"
 within:25
 fast_pattern
 nocase
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 nocase
 content:"insertFieldset"
 nocase
 content:".execCommand"
 nocase
 content:"delete"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1738
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35196
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer meta tag double free attempt"
 flow:to_server,established
 file_data
 content:"msapplication-task"
 content:"content"
 within:50
 content:"name"
 within:25
 content:"msapplication-task"
 distance:0
 content:"content"
 within:20
 isdataat:15,relative
 content:!"name"
 within:20
 pcre:"/<meta.*?name\\s*=\\s*[\\x22\\x27]msapplication-task[\\x22\\x27].*?content\\s*=\\s*[\\x22\\x27].*?name\\s*=\\s*.*?>.*?<meta.*?name\\s*=\\s*[\\x22\\x27]msapplication-task[\\x22\\x27].*?content\\s*=\\s*[\\x22\\x27](?!name)[\\x22\\x27].*?>/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2391
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35185
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer meta tag double free attempt"
 flow:to_client,established
 file_data
 content:"msapplication-task"
 content:"content"
 within:50
 content:"name"
 within:25
 content:"msapplication-task"
 distance:0
 content:"content"
 within:20
 isdataat:15,relative
 content:!"name"
 within:20
 pcre:"/<meta.*?name\\s*=\\s*[\\x22\\x27]msapplication-task[\\x22\\x27].*?content\\s*=\\s*[\\x22\\x27].*?name\\s*=\\s*.*?>.*?<meta.*?name\\s*=\\s*[\\x22\\x27]msapplication-task[\\x22\\x27].*?content\\s*=\\s*[\\x22\\x27](?!name)[\\x22\\x27].*?>/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2391
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35184
 rev:6
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table column resize use-after-free attempt"
 flow:to_server,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=8"
 within:25
 nocase
 content:".createElement|28|"
 content:"frameset"
 within:20
 fast_pattern
 nocase
 content:".colSpan"
 nocase
 content:".cells"
 within:60
 nocase
 content:".colSpan"
 within:25
 nocase
 content:".cells"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2388
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35183
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table column resize use-after-free attempt"
 flow:to_client,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=8"
 within:25
 nocase
 content:".createElement|28|"
 content:"frameset"
 within:20
 fast_pattern
 nocase
 content:".colSpan"
 nocase
 content:".cells"
 within:50
 nocase
 content:".colSpan"
 within:25
 nocase
 content:".cells"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2388
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35182
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement object use after free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 nocase
 content:"createTreeWalker"
 fast_pattern
 nocase
 content:"execCommand"
 nocase
 content:"formatblock"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2408
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35173
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTitleElement object use after free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 nocase
 content:"createTreeWalker"
 fast_pattern
 nocase
 content:"execCommand"
 nocase
 content:"formatblock"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2408
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35172
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MutationObserver use after free attempt"
 flow:to_server,established
 file_data
 content:"MutationObserver"
 fast_pattern:only
 content:"createElement"
 nocase
 content:"script"
 within:15
 nocase
 content:"document.write"
 within:100
 nocase
 content:"createElement"
 distance:0
 nocase
 content:"script"
 within:15
 nocase
 content:"insertBefore"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2425
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35171
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MutationObserver use after free attempt"
 flow:to_client,established
 file_data
 content:"MutationObserver"
 fast_pattern:only
 content:"createElement"
 nocase
 content:"script"
 within:15
 nocase
 content:"document.write"
 within:100
 nocase
 content:"createElement"
 distance:0
 nocase
 content:"script"
 within:15
 nocase
 content:"insertBefore"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2425
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35170
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFancyFormat object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"IE=EmulateIE7"
 nocase
 content:".body.contentEditable"
 nocase
 content:"true"
 within:20
 content:"window.navigate"
 nocase
 content:"onactivate"
 fast_pattern
 nocase
 content:".applyElement"
 within:25
 nocase
 content:".createElement"
 within:25
 nocase
 content:"strong"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2422
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35159
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFancyFormat object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"IE=EmulateIE7"
 nocase
 content:".body.contentEditable"
 nocase
 content:"true"
 within:20
 content:"window.navigate"
 nocase
 content:"onactivate"
 fast_pattern
 nocase
 content:".applyElement"
 within:25
 nocase
 content:".createElement"
 within:25
 nocase
 content:"strong"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2422
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35158
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableSection object out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"<meta http-equiv="
 content:"x-ua-compatible"
 within:20
 content:"IE=8"
 within:20
 content:"frameset"
 fast_pattern:only
 content:".createElement"
 content:".appendChild"
 within:100
 content:".createElement"
 content:"style"
 within:20
 nocase
 content:".replaceNode("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2403
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35157
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableSection object out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"<meta http-equiv="
 content:"x-ua-compatible"
 within:20
 content:"IE=8"
 within:20
 content:"frameset"
 fast_pattern:only
 content:".createElement"
 content:".appendChild"
 within:100
 content:".createElement"
 content:"style"
 within:20
 nocase
 content:".replaceNode("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2403
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35156
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"
 flow:to_server,established
 file_data
 content:".createTreeWalker"
 fast_pattern:only
 content:".createElement("
 nocase
 content:"noscript"
 within:20
 nocase
 content:".addEventListener"
 nocase
 content:"DOMNodeInserted"
 within:50
 nocase
 content:"swapNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1767
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35155
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use after free attempt"
 flow:to_client,established
 file_data
 content:".createTreeWalker"
 fast_pattern:only
 content:".createElement("
 nocase
 content:"noscript"
 within:20
 nocase
 content:".addEventListener"
 nocase
 content:"DOMNodeInserted"
 within:50
 nocase
 content:"swapNode"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1767
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35154
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableSection use after free attempt"
 flow:to_server,established
 file_data
 content:"http-equiv="
 nocase
 content:"X-UA-Compatible"
 within:50
 nocase
 content:"content="
 within:50
 nocase
 content:"IE=6"
 within:50
 nocase
 content:"onmouseover"
 content:".createTHead()"
 fast_pattern:only
 content:"window.setTimeout("
 content:"window.setTimeout("
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1733
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35146
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableSection use after free attempt"
 flow:to_client,established
 file_data
 content:"http-equiv="
 nocase
 content:"X-UA-Compatible"
 within:50
 nocase
 content:"content="
 within:50
 nocase
 content:"IE=6"
 within:50
 nocase
 content:"onmouseover"
 content:".createTHead()"
 fast_pattern:only
 content:"window.setTimeout("
 content:"window.setTimeout("
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1733
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35145
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CInput use after free attempt"
 flow:to_server,established
 file_data
 content:"<meter"
 nocase
 content:"<output"
 nocase
 content:"<button"
 nocase
 content:"<form"
 nocase
 content:!"</form"
 nocase
 content:".getElementsByTagName"
 nocase
 content:"meter"
 within:20
 nocase
 content:".getElementsByTagName"
 nocase
 content:"button"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2401
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35126
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CInput use after free attempt"
 flow:to_client,established
 file_data
 content:"<meter"
 nocase
 content:"<output"
 nocase
 content:"<button"
 nocase
 content:"<form"
 nocase
 content:!"</form"
 nocase
 content:".getElementsByTagName"
 nocase
 content:"meter"
 within:20
 nocase
 content:".getElementsByTagName"
 nocase
 content:"button"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2401
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35125
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableRow use after free attempt"
 flow:to_server,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=5"
 within:25
 nocase
 content:"insertRow()"
 nocase
 content:"deleteRow(0)"
 within:50
 fast_pattern
 nocase
 content:"<body"
 nocase
 content:"</body"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2406
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35124
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableRow use after free attempt"
 flow:to_client,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=5"
 within:25
 nocase
 content:"insertRow()"
 nocase
 content:"deleteRow(0)"
 within:50
 fast_pattern
 nocase
 content:"<body"
 nocase
 content:"</body"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2406
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35123
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTextArea use after free attempt"
 flow:to_server,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=5"
 within:50
 nocase
 content:"createElement"
 nocase
 content:"applyElement"
 within:50
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 content:"parentNode.removechild"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2397
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35122
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTextArea use after free attempt"
 flow:to_client,established
 file_data
 content:"x-ua-compatible"
 nocase
 content:"IE=5"
 within:50
 nocase
 content:"createElement"
 nocase
 content:"applyElement"
 within:50
 nocase
 content:"CollectGarbage"
 within:100
 nocase
 content:"parentNode.removechild"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2397
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:35121
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode type confusion attempt"
 flow:to_server,established
 file_data
 content:"createElementNS"
 nocase
 content:"svg"
 within:25
 nocase
 content:"createTextNode"
 within:300
 nocase
 content:"xlink:href"
 within:200
 nocase
 content:"MutationObserver"
 within:150
 nocase
 content:"childList"
 within:75
 nocase
 content:"extractContents"
 within:300
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2384
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35120
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode type confusion attempt"
 flow:to_client,established
 file_data
 content:"createElementNS"
 nocase
 content:"svg"
 within:25
 nocase
 content:"createTextNode"
 within:300
 nocase
 content:"xlink:href"
 within:200
 nocase
 content:"MutationObserver"
 within:150
 nocase
 content:"childList"
 within:75
 nocase
 content:"extractContents"
 within:300
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2384
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-065
 classtype:attempted-user
 sid:35119
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer replaceChild function memory corruption attempt"
 flow:to_server,established
 file_data
 content:".getElement"
 nocase
 content:".replaceChild"
 within:100
 nocase
 content:"<object"
 nocase
 content:"<param"
 within:100
 nocase
 pcre:"/\\.replaceChild\\x28\\s*(?P<param>\\w+)\\s*,\\s*(?P=param)\\s*\\x29/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0280
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:35115
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer replaceChild function memory corruption attempt"
 flow:to_client,established
 file_data
 content:".getElement"
 nocase
 content:".replaceChild"
 within:100
 nocase
 content:"<object"
 nocase
 content:"<param"
 within:100
 nocase
 pcre:"/\\.replaceChild\\x28\\s*(?P<param>\\w+)\\s*,\\s*(?P=param)\\s*\\x29/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0280
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-010
 classtype:attempted-user
 sid:35114
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer array prototype type confusion memory corruption attempt"
 flow:to_server,established
 file_data
 content:"Number.prototype.length"
 content:".join"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2448
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35508
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer array prototype type confusion memory corruption attempt"
 flow:to_client,established
 file_data
 content:"Number.prototype.length"
 nocase
 content:".join"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2448
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35507
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer window scroll integer overflow attempt"
 flow:to_server,established
 file_data
 content:"window.scrollBy"
 fast_pattern:only
 content:"onload"
 content:"onresize"
 within:200
 content:"<input "
 content:"type"
 within:50
 content:"range"
 within:15
 content:"document.body"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,76193
 reference:cve,2015-2446
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-091
 classtype:attempted-user
 sid:35500
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer window scroll integer overflow attempt"
 flow:to_client,established
 file_data
 content:"window.scrollBy"
 fast_pattern:only
 content:"onload"
 content:"onresize"
 within:200
 content:"<input "
 content:"type"
 within:50
 content:"range"
 within:15
 content:"document.body"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,76193
 reference:cve,2015-2446
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-091
 classtype:attempted-user
 sid:35499
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementsByTagName"
 nocase
 content:"p"
 within:5
 nocase
 content:"id"
 within:10
 content:".execCommand"
 within:300
 nocase
 content:"undo"
 within:30
 nocase
 content:"CollectGarbage"
 distance:0
 fast_pattern
 nocase
 content:"document.getElementById"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2442
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35482
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CParaElement use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementsByTagName"
 nocase
 content:"p"
 within:5
 nocase
 content:"id"
 within:10
 content:".execCommand"
 within:300
 nocase
 content:"undo"
 within:30
 nocase
 content:"CollectGarbage"
 distance:0
 fast_pattern
 nocase
 content:"document.getElementById"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2442
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35481
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer RecyclableObject type-confusion remote code execution attempt"
 flow:to_server,established
 file_data
 content:"getOwnPropertyDescriptor"
 nocase
 content:"stack"
 within:15
 nocase
 content:"get.call(0)"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2443
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35480
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer RecyclableObject type-confusion remote code execution attempt"
 flow:to_client,established
 file_data
 content:"getOwnPropertyDescriptor"
 nocase
 content:"stack"
 within:15
 nocase
 content:"get.call(0)"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2443
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35479
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLabelElement object use after free attempt"
 flow:to_server,established
 file_data
 content:"-ms-behavior"
 fast_pattern:only
 content:"X-UA-Compatible"
 nocase
 content:"IE=10"
 within:50
 nocase
 content:"getElementsByTagName"
 nocase
 content:"meter"
 within:15
 nocase
 content:"location.reload"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,69325
 reference:cve,2015-2444
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35478
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLabelElement object use after free attempt"
 flow:to_client,established
 file_data
 content:"-ms-behavior"
 fast_pattern:only
 content:"X-UA-Compatible"
 nocase
 content:"IE=10"
 within:50
 nocase
 content:"getElementsByTagName"
 nocase
 content:"meter"
 within:15
 nocase
 content:"location.reload"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,69325
 reference:cve,2015-2444
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35477
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer COrphanedStylesheetArray use after free attempt"
 flow:to_server,established
 file_data
 content:"Math/MathML"
 nocase
 content:"owningElement"
 nocase
 content:".removeNode"
 within:50
 nocase
 content:"owningElement"
 within:100
 nocase
 content:".getAdjacentText"
 within:50
 nocase
 content:".addImport"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2451
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35476
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer COrphanedStylesheetArray use after free attempt"
 flow:to_client,established
 file_data
 content:"Math/MathML"
 nocase
 content:"owningElement"
 nocase
 content:".removeNode"
 within:50
 nocase
 content:"owningElement"
 within:100
 nocase
 content:".getAdjacentText"
 within:50
 nocase
 content:".addImport"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2451
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35475
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer COrphanedStylesheetArray use-after-free attempt"
 flow:to_server,established
 file_data
 content:".addImport"
 nocase
 content:"CollectGarbage"
 within:200
 nocase
 content:".styleSheet.addRule"
 within:300
 nocase
 content:".styleSheet.deleteRule"
 within:100
 nocase
 content:".reload"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2450
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35474
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer COrphanedStylesheetArray use-after-free attempt"
 flow:to_client,established
 file_data
 content:".addImport"
 nocase
 content:"CollectGarbage"
 within:200
 nocase
 content:".styleSheet.addRule"
 within:300
 nocase
 content:".styleSheet.deleteRule"
 within:100
 nocase
 content:".reload"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2450
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-079
 classtype:attempted-user
 sid:35473
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table layout cache arbitrary code execution attempt"
 flow:to_server,established
 file_data
 content:".insertRow"
 nocase
 content:".applyElement"
 within:100
 nocase
 content:"outside"
 within:20
 nocase
 content:"document.body.contentEditable"
 nocase
 content:"false"
 within:20
 nocase
 content:"document.body.contentEditable"
 nocase
 content:"true"
 within:20
 nocase
 content:"body"
 nocase
 content:"onpropertychange"
 within:100
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2502
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-093
 classtype:attempted-user
 sid:35537
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table layout cache arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:".insertRow"
 nocase
 content:".applyElement"
 within:100
 nocase
 content:"outside"
 within:20
 nocase
 content:"document.body.contentEditable"
 nocase
 content:"false"
 within:20
 nocase
 content:"document.body.contentEditable"
 nocase
 content:"true"
 within:20
 nocase
 content:"body"
 nocase
 content:"onpropertychange"
 within:100
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2502
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-093
 classtype:attempted-user
 sid:35536
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge history.state use after free attempt"
 flow:to_server,established
 file_data
 content:".location.href"
 nocase
 content:"#"
 within:35
 content:".parentNode.removeChild"
 within:250
 nocase
 content:"history.state"
 within:250
 fast_pattern
 nocase
 content:"iframe"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 classtype:attempted-user
 sid:35706
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge history.state use after free attempt"
 flow:to_client,established
 file_data
 content:".location.href"
 nocase
 content:"#"
 within:35
 content:".parentNode.removeChild"
 within:250
 nocase
 content:"history.state"
 within:250
 fast_pattern
 nocase
 content:"iframe"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 classtype:attempted-user
 sid:35705
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CLabelElement object use after free attempt"
 flow:to_server,established
 file_data
 content:"window.location.href"
 fast_pattern:only
 content:"X-UA-Compatible"
 nocase
 content:"IE=10"
 within:50
 nocase
 content:"meter."
 nocase
 content:"textContent"
 within:15
 nocase
 content:"window.location.href"
 nocase
 content:"window.location.href"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,69325
 reference:cve,2015-2444
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35837
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CLabelElement object use after free attempt"
 flow:to_client,established
 file_data
 content:"window.location.href"
 fast_pattern:only
 content:"X-UA-Compatible"
 nocase
 content:"IE=10"
 within:50
 nocase
 content:"meter."
 nocase
 content:"textContent"
 within:15
 nocase
 content:"window.location.href"
 nocase
 content:"window.location.href"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,69325
 reference:cve,2015-2444
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 classtype:attempted-user
 sid:35836
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer invalid memory access attempt"
 flow:to_server,established
 file_data
 content:"<th"
 content:"onload"
 content:".insertBefore"
 content:".colSpan"
 within:50
 content:".insertRow"
 within:50
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2492
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36019
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid memory access attempt"
 flow:to_client,established
 file_data
 content:"<th"
 content:"onload"
 content:".insertBefore"
 content:".colSpan"
 within:50
 content:".insertRow"
 within:50
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2492
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36018
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array memory access attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"body"
 within:25
 nocase
 content:".createElement"
 within:250
 nocase
 content:"area"
 within:25
 nocase
 content:".createTextRange"
 within:500
 nocase
 content:".pasteHTML"
 within:50
 nocase
 content:"<form>"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2498
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36009
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bounds array memory access attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"body"
 within:25
 nocase
 content:".createElement"
 within:250
 nocase
 content:"area"
 within:25
 nocase
 content:".createTextRange"
 within:500
 nocase
 content:".pasteHTML"
 within:50
 nocase
 content:"<form>"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2498
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36008
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableColCalc out of bounds memory write attempt"
 flow:to_server,established
 file_data
 content:"table-layout"
 content:"fixed"
 within:20
 content:"colSpan"
 content:"|22|"
 within:10
 byte_extract:10,0,colspan,relative,string
 content:"<col "
 content:"span"
 within:40
 pcre:"/<\\s*col[^>]*span\\s*=\\s*[\\x22\\x27]/i"
 byte_test:10,>,colspan,0,relative,string
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2499
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 classtype:attempted-user
 sid:36007
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableColCalc out of bounds memory write attempt"
 flow:to_client,established
 file_data
 content:"table-layout"
 content:"fixed"
 within:20
 content:"colSpan"
 content:"|22|"
 within:10
 byte_extract:10,0,colspan,relative,string
 content:"<col "
 content:"span"
 within:40
 pcre:"/<\\s*col[^>]*span\\s*=\\s*[\\x22\\x27]/i"
 byte_test:10,>,colspan,0,relative,string
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2499
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 classtype:attempted-user
 sid:36006
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object double free attempt"
 flow:to_server,established
 file_data
 content:"for("
 content:"null"
 within:50
 content:"for("
 within:50
 content:".createElement("
 within:100
 content:".shape"
 within:100
 content:"document.images.length"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2500
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36005
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CImgElement object double free attempt"
 flow:to_client,established
 file_data
 content:"for("
 content:"null"
 within:50
 content:"for("
 within:50
 content:".createElement("
 within:100
 content:".shape"
 within:100
 content:"document.images.length"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2500
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:36004
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CImgTaskSvgDoc object double free attempt"
 flow:to_server,established
 file_data
 content:"svg"
 content:"window.setTimeout("
 within:100
 content:"window.location.reload()"
 within:50
 content:"onload="
 within:500
 content:"<img"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2501
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35993
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CImgTaskSvgDoc object double free attempt"
 flow:to_client,established
 file_data
 content:"svg"
 content:"window.setTimeout("
 within:100
 content:"window.location.reload()"
 within:50
 content:"onload="
 within:500
 content:"<img"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2501
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35992
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer JScript.Compact insertBefore memory corruption attempt"
 flow:to_server,established
 file_data
 content:"JScript.Compact"
 fast_pattern:only
 content:"IE=edge"
 nocase
 content:".getElementsByTagName"
 nocase
 content:"script"
 within:25
 nocase
 content:".createElement"
 within:75
 nocase
 content:"script"
 within:25
 nocase
 content:".parentNode.insertBefore"
 within:75
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2493
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35991
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer JScript.Compact insertBefore memory corruption attempt"
 flow:to_client,established
 file_data
 content:"JScript.Compact"
 fast_pattern:only
 content:"IE=edge"
 nocase
 content:".getElementsByTagName"
 nocase
 content:"script"
 within:25
 nocase
 content:".createElement"
 within:75
 nocase
 content:"script"
 within:25
 nocase
 content:".parentNode.insertBefore"
 within:75
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2493
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35990
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"createTextRange"
 content:".execCommand"
 within:20
 content:"InsertIFrame"
 within:20
 fast_pattern
 nocase
 content:"innerHTML"
 within:500
 content:"onpropertychange"
 within:50
 nocase
 content:"removeAttribute"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2491
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35976
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement object use-after-free attempt"
 flow:to_client,established
 file_data
 file_data
 content:"createTextRange"
 content:".execCommand"
 within:20
 content:"InsertIFrame"
 within:20
 fast_pattern
 nocase
 content:"innerHTML"
 within:500
 content:"onpropertychange"
 within:50
 nocase
 content:"removeAttribute"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2491
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35975
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement input type memory corruption attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 nocase
 content:"input"
 within:25
 nocase
 content:".setAttributeNS"
 within:75
 fast_pattern
 nocase
 content:"value"
 within:25
 nocase
 content:".attributes.value"
 within:75
 nocase
 content:".mergeAttributes"
 within:75
 nocase
 content:".mergeAttributes"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2486
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-095
 classtype:attempted-user
 sid:35966
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement input type memory corruption attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 nocase
 content:"input"
 within:25
 nocase
 content:".setAttributeNS"
 within:75
 fast_pattern
 nocase
 content:"value"
 within:25
 nocase
 content:".attributes.value"
 within:75
 nocase
 content:".mergeAttributes"
 within:75
 nocase
 content:".mergeAttributes"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2486
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-095
 classtype:attempted-user
 sid:35965
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"
 flow:to_server,established
 file_data
 content:"document.createElement"
 content:".attributes|3B|"
 within:100
 content:".runtimeStyle|3B|"
 within:200
 distance:-100
 content:".classList|3B|"
 within:200
 distance:-100
 content:".style|3B|"
 within:200
 distance:-100
 content:".uniqueNumber|3B|"
 within:200
 distance:-100
 content:".createAttributeNS"
 content:"style"
 within:100
 content:".setAttributeNode"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2485
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-095
 classtype:attempted-user
 sid:35964
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer element attribute use after free attempt"
 flow:to_client,established
 file_data
 content:"document.createElement"
 content:".attributes|3B|"
 within:100
 content:".runtimeStyle|3B|"
 within:200
 distance:-100
 content:".classList|3B|"
 within:200
 distance:-100
 content:".style|3B|"
 within:200
 distance:-100
 content:".uniqueNumber|3B|"
 within:200
 distance:-100
 content:".createAttributeNS"
 content:"style"
 within:100
 content:".setAttributeNode"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2485
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-095
 classtype:attempted-user
 sid:35963
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge DOMNode manipulation use after free attempt"
 flow:to_server,established
 file_data
 content:"<textarea"
 nocase
 content:"addEventListener|28|"
 nocase
 content:"DOMNodeRemoved"
 within:20
 fast_pattern
 nocase
 content:"addEventListener|28|"
 nocase
 content:"DOMNodeInserted"
 within:21
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2488
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 classtype:attempted-user
 sid:35960
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge DOMNode manipulation use after free attempt"
 flow:to_client,established
 file_data
 content:"<textarea"
 nocase
 content:"addEventListener|28|"
 nocase
 content:"DOMNodeRemoved"
 within:20
 fast_pattern
 nocase
 content:"addEventListener|28|"
 nocase
 content:"DOMNodeInserted"
 within:21
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2488
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-094
 classtype:attempted-user
 sid:35959
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CStr object use after free attempt"
 flow:to_server,established
 file_data
 content:"document.write"
 nocase
 content:"<body"
 distance:0
 nocase
 content:"onbeforeunload"
 within:75
 fast_pattern
 nocase
 pcre:"/function\\s+(?P<del_func>\\w+)\\s*\\x28[^\\x7b]*?\\x7b[^\\x7d]*?document\\.write.*?onbeforeunload\\s*=\\s*[\\x22\\x27]?(?P=del_func)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2490
 reference:cve,2015-6087
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:35958
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CStr object use after free attempt"
 flow:to_server,established
 file_data
 content:"<body"
 nocase
 content:"onbeforeunload"
 within:75
 fast_pattern
 nocase
 content:"document.write"
 distance:0
 nocase
 pcre:"/onbeforeunload\\s*=\\s*[\\x22\\x27]?(?P<del_func>\\w+)\\s*\\x28.*?(?P=del_func)\\s*\\x28[^\\x7b]*?\\x7b[^\\x7d]*?document\\.write/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2490
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35957
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CStr object use after free attempt"
 flow:to_client,established
 file_data
 content:"document.write"
 nocase
 content:"<body"
 distance:0
 nocase
 content:"onbeforeunload"
 within:75
 fast_pattern
 nocase
 pcre:"/function\\s+(?P<del_func>\\w+)\\s*\\x28[^\\x7b]*?\\x7b[^\\x7d]*?document\\.write.*?onbeforeunload\\s*=\\s*[\\x22\\x27]?(?P=del_func)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2490
 reference:cve,2015-6087
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:35956
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CStr object use after free attempt"
 flow:to_client,established
 file_data
 content:"<body"
 nocase
 content:"onbeforeunload"
 within:75
 fast_pattern
 nocase
 content:"document.write"
 distance:0
 nocase
 pcre:"/onbeforeunload\\s*=\\s*[\\x22\\x27]?(?P<del_func>\\w+)\\s*\\x28.*?(?P=del_func)\\s*\\x28[^\\x7b]*?\\x7b[^\\x7d]*?document\\.write/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2490
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-094
 classtype:attempted-user
 sid:35955
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer window scroll integer overflow attempt"
 flow:to_client,established
 file_data
 content:"window.resizeTo"
 fast_pattern:only
 content:"onload"
 content:"onresize"
 within:200
 content:"<input "
 content:"type"
 within:50
 content:"range"
 within:15
 content:"document.body"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,76193
 reference:cve,2015-2446
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-091
 classtype:attempted-user
 sid:36069
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer window scroll integer overflow attempt"
 flow:to_server,established
 file_data
 content:"window.resizeTo"
 fast_pattern:only
 content:"onload"
 content:"onresize"
 within:200
 content:"<input "
 content:"type"
 within:50
 content:"range"
 within:15
 content:"document.body"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,76193
 reference:cve,2015-2446
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-091
 classtype:attempted-user
 sid:36068
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSelectElement SetCurSel remote code execution attempt"
 flow:to_server,established
 file_data
 content:"<select"
 nocase
 content:"attachEvent("
 nocase
 content:"onpropertychange"
 within:50
 nocase
 content:"selected"
 nocase
 content:"true"
 within:15
 nocase
 content:"setTimeout"
 nocase
 content:"CollectGarbage"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0312
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-012
 classtype:attempted-user
 sid:36249
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_server
 file_data
 content:"scrollIntoView("
 fast_pattern:only
 content:"createElement"
 nocase
 content:"frameset"
 within:20
 nocase
 content:".selection.createRange"
 within:75
 nocase
 content:"onload"
 nocase
 content:"onresize"
 nocase
 content:"CollectGarbage()"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:36238
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_client
 file_data
 content:"scrollIntoView("
 fast_pattern:only
 content:"createElement"
 nocase
 content:"frameset"
 within:20
 nocase
 content:".selection.createRange"
 within:75
 nocase
 content:"onload"
 nocase
 content:"onresize"
 nocase
 content:"CollectGarbage()"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:36237
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_server
 file_data
 content:"[|22|applyElement|22|]( document[|22|create|22| + |27|Element|27|]"
 fast_pattern:only
 content:"document[|22|select|22|+|27|ion|27|][|27|create|27|+|27|Range|27|]()|3B|"
 nocase
 content:"[|22|move|22| + |27|ToEle|27| + |22|ment|22| + |27|Text|27|]"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:36236
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGenericElement use after free attempt"
 flow:established,to_client
 file_data
 content:"[|22|applyElement|22|]( document[|22|create|22| + |27|Element|27|]"
 fast_pattern:only
 content:"document[|22|select|22|+|27|ion|27|][|27|create|27|+|27|Range|27|]()|3B|"
 nocase
 content:"[|22|move|22| + |27|ToEle|27| + |22|ment|22| + |27|Text|27|]"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0017
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-009
 classtype:attempted-user
 sid:36235
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer superscript use after free attempt"
 flow:to_server,established
 file_data
 content:"document.execCommand"
 nocase
 content:"selectall"
 within:20
 nocase
 content:"setTimeout"
 nocase
 content:"Node("
 within:170
 nocase
 content:"document."
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3111
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-047
 classtype:attempted-user
 sid:36224
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer RegExp object use after free attempt"
 flow:to_server,established
 file_data
 content:"RegExp("
 content:".replace("
 distance:0
 content:"function"
 within:50
 content:"for"
 within:50
 content:".compile()"
 within:500
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2482
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36451
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer RegExp object use after free attempt"
 flow:to_client,established
 file_data
 content:"RegExp("
 content:".replace("
 distance:0
 content:"function"
 within:50
 content:"for"
 within:50
 content:".compile()"
 within:500
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2482
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36450
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer EventListener use after free attempt"
 flow:to_server,established
 file_data
 content:".removeEventListener"
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6045
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-106
 classtype:attempted-user
 sid:36444
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EventListener use after free attempt"
 flow:to_client,established
 file_data
 content:".removeEventListener"
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:".removeEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 content:"addEventListener"
 distance:0
 content:"DOMNodeRemoved"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6045
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-106
 classtype:attempted-user
 sid:36443
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableSelection use-after-free attempt"
 flow:to_server,established
 file_data
 content:".removeNode"
 nocase
 content:".execCommand"
 within:150
 nocase
 content:"InsertFieldset"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6048
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36440
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableSelection use-after-free attempt"
 flow:to_client,established
 file_data
 content:".removeNode"
 nocase
 content:".execCommand"
 within:150
 nocase
 content:"InsertFieldset"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6048
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36439
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ieframe.dll ActiveX clsid access"
 flow:to_server,established
 file_data
 content:"6CF48EF8-44CD-45d2-8832-A16EA016311B"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6049
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36438
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ieframe.dll ActiveX clsid access"
 flow:to_client,established
 file_data
 content:"6CF48EF8-44CD-45d2-8832-A16EA016311B"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6049
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36437
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer pre-line use after free attempt"
 flow:to_server,established
 file_data
 content:".style.whiteSpace = |22|pre-line|22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0025
 reference:cve,2013-1288
 reference:cve,2015-6050
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-009
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-021
 classtype:attempted-user
 sid:36436
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDeskBand use-after-free attempt"
 flow:to_server,established
 file_data
 content:"<b></b>"
 content:"15D633E2-AD00-465b-9EC7-F56B7CDF8E27"
 within:200
 nocase
 content:"location.href"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2548
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-109
 classtype:attempted-user
 sid:36424
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDeskBand use-after-free attempt"
 flow:to_client,established
 file_data
 content:"<b></b>"
 content:"15D633E2-AD00-465b-9EC7-F56B7CDF8E27"
 within:200
 nocase
 content:"location.href"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2548
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-109
 classtype:attempted-user
 sid:36423
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CWindow object use after free attempt"
 flow:to_server,established
 file_data
 content:"MutationObserver"
 nocase
 content:"childList"
 within:150
 nocase
 content:"addEventListener"
 within:150
 nocase
 content:"DOMSubtreeModified"
 within:50
 nocase
 content:"setInterval"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36418
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CWindow object use after free attempt"
 flow:to_client,established
 file_data
 content:"MutationObserver"
 nocase
 content:"childList"
 within:150
 nocase
 content:"addEventListener"
 within:150
 nocase
 content:"DOMSubtreeModified"
 within:50
 nocase
 content:"setInterval"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6042
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36417
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CQuickLinks object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"0E5CBF21-D15F-11D0-8301-00AA005B4383"
 content:"</object>"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2515
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-109
 classtype:attempted-user
 sid:36402
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CQuickLinks object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"0E5CBF21-D15F-11D0-8301-00AA005B4383"
 content:"</object>"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2515
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-109
 classtype:attempted-user
 sid:36401
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer meta tag double free attempt"
 flow:to_client,established
 file_data
 content:"|27|msapplication-task|27|"
 content:"content"
 within:50
 content:"name"
 within:25
 content:"|27|msapplication-task|27|"
 distance:0
 content:"content"
 within:20
 isdataat:15,relative
 content:!"name"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2391
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:36605
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer meta tag double free attempt"
 flow:to_server,established
 file_data
 content:"|27|msapplication-task|27|"
 content:"content"
 within:50
 content:"name"
 within:25
 content:"|27|msapplication-task|27|"
 distance:0
 content:"content"
 within:20
 isdataat:15,relative
 content:!"name"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2391
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-065
 classtype:attempted-user
 sid:36604
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_server,established
 file_data
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"setAttribute"
 nocase
 content:"spellcheck"
 within:25
 nocase
 content:"removeAttribute"
 distance:0
 nocase
 content:"spellcheck"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6075
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36743
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"setAttribute"
 nocase
 content:"spellcheck"
 within:25
 nocase
 content:"removeAttribute"
 distance:0
 nocase
 content:"spellcheck"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6075
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36742
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTsfTextStore use-after-free attempt"
 flow:to_server,established
 file_data
 content:".replaceNode("
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"input"
 within:7
 nocase
 content:".createTextRange()|3B|"
 nocase
 content:".select()|3B|"
 within:110
 content:".reload()|3B|"
 within:55
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6077
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36739
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTsfTextStore use-after-free attempt"
 flow:to_client,established
 file_data
 content:".replaceNode("
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"input"
 within:7
 nocase
 content:".createTextRange()|3B|"
 nocase
 content:".select()|3B|"
 within:110
 content:".reload()|3B|"
 within:55
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6077
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36738
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CEditEventSink navigate use after free attempt"
 flow:to_server,established
 file_data
 content:"onresize"
 nocase
 content:"navigate"
 within:50
 fast_pattern
 nocase
 content:"#"
 within:25
 content:"contenteditable"
 nocase
 content:"false"
 within:25
 nocase
 content:".value"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,77445
 reference:cve,2015-6071
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36702
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CEditEventSink navigate use after free attempt"
 flow:to_client,established
 file_data
 content:"onresize"
 nocase
 content:"navigate"
 within:50
 fast_pattern
 nocase
 content:"#"
 within:25
 content:"contenteditable"
 nocase
 content:"false"
 within:25
 nocase
 content:".value"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,77445
 reference:cve,2015-6071
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36701
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode row element removal remote code execution attempt"
 flow:to_server,established
 file_data
 content:".moveToElementText"
 content:".execCommand"
 within:250
 content:".moveToElementText"
 within:250
 content:".pasteHTML"
 within:250
 content:".swapNode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6072
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36700
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreeNode row element removal remote code execution attempt"
 flow:to_client,established
 file_data
 content:".moveToElementText"
 content:".execCommand"
 within:250
 content:".moveToElementText"
 within:250
 content:".pasteHTML"
 within:250
 content:".swapNode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6072
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36699
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer table element modification use after free attempt"
 flow:to_server,established
 file_data
 content:".createElement("
 nocase
 content:".applyElement("
 within:80
 nocase
 content:".innerHTML"
 within:80
 nocase
 content:".navigate("
 within:80
 nocase
 content:".runtimeStyle.cssText"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6066
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36696
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer table element modification use after free attempt"
 flow:to_client,established
 file_data
 content:".createElement("
 nocase
 content:".applyElement("
 within:80
 nocase
 content:".innerHTML"
 within:80
 nocase
 content:".navigate("
 within:80
 nocase
 content:".runtimeStyle.cssText"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6066
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36695
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer style object stylesheet use after free attempt"
 flow:to_server,established
 file_data
 content:".styleSheet"
 content:".addRule("
 within:100
 content:".deleteRule("
 within:400
 content:".removeRule("
 within:100
 fast_pattern
 content:"load"
 within:400
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6065
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36694
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer style object stylesheet use after free attempt"
 flow:to_client,established
 file_data
 content:".styleSheet"
 content:".addRule("
 within:100
 content:".deleteRule("
 within:400
 content:".removeRule("
 within:100
 fast_pattern
 content:"load"
 within:400
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6065
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36693
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CUListElement use-after-free attempt"
 flow:to_server,established
 file_data
 content:".execCommand"
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"moveToElementText"
 content:".execCommand"
 content:"createElement"
 content:"HGROUP"
 within:20
 nocase
 content:".appendChild"
 content:"addEventListener"
 content:"DOMNodeRemoved"
 within:20
 content:".appendChild"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6080
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36692
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CUListElement use-after-free attempt"
 flow:to_client,established
 file_data
 content:".execCommand"
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"moveToElementText"
 content:".execCommand"
 content:"createElement"
 content:"HGROUP"
 within:20
 nocase
 content:".appendChild"
 content:"addEventListener"
 content:"DOMNodeRemoved"
 within:20
 content:".appendChild"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6080
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36691
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_server,established
 file_data
 content:".htmlFor"
 fast_pattern:only
 nocase
 content:"|20|for="
 nocase
 content:"|20|event="
 within:200
 nocase
 content:"|20|for="
 distance:0
 nocase
 content:"|20|event="
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6076
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112 
 classtype:attempted-user
 sid:36688
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement use after free attempt"
 flow:to_client,established
 file_data
 content:".htmlFor"
 fast_pattern:only
 nocase
 content:"|20|for="
 nocase
 content:"|20|event="
 within:200
 nocase
 content:"|20|for="
 distance:0
 nocase
 content:"|20|event="
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6076
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36687
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer col onpropertychange memory corruption attempt"
 flow:to_server,established
 file_data
 content:".background"
 nocase
 content:"Node.insert"
 within:200
 nocase
 content:".createCaption"
 within:50
 fast_pattern
 nocase
 content:"<col"
 within:200
 nocase
 content:"<th"
 within:100
 nocase
 content:"onpropertychange"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6070
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36686
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer col onpropertychange memory corruption attempt"
 flow:to_client,established
 file_data
 content:".background"
 nocase
 content:"Node.insert"
 within:200
 nocase
 content:".createCaption"
 within:50
 fast_pattern
 nocase
 content:"<col"
 within:200
 nocase
 content:"<th"
 within:100
 nocase
 content:"onpropertychange"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6070
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36685
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell object use after free attempt"
 flow:to_server,established
 file_data
 content:"getElementsByTagName("
 content:".createTextRange("
 within:100
 content:".moveToElementText"
 within:100
 content:"CollectGarbage"
 within:300
 fast_pattern
 content:".cloneNode"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36684
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell object use after free attempt"
 flow:to_client,established
 file_data
 content:"getElementsByTagName("
 content:".createTextRange("
 within:100
 content:".moveToElementText"
 within:100
 content:"CollectGarbage"
 within:300
 fast_pattern
 content:".cloneNode"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6079
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36683
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"
 flow:to_server,established
 file_data
 content:".createElement"
 content:"TABLE"
 within:20
 nocase
 content:".appendChild"
 content:".createElement"
 within:25
 content:"FRAMESET"
 within:20
 nocase
 content:".createTFoot"
 fast_pattern:only
 content:"getElement"
 content:"TBODY"
 within:20
 nocase
 content:"insertRow"
 content:"removeNode"
 content:".createElement"
 content:"TR"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36682
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer access violation attempt"
 flow:to_client,established
 file_data
 content:".createElement"
 content:"TABLE"
 within:20
 nocase
 content:".appendChild"
 content:".createElement"
 within:25
 content:"FRAMESET"
 within:20
 nocase
 content:".createTFoot"
 fast_pattern:only
 content:"getElement"
 content:"TBODY"
 within:20
 nocase
 content:"insertRow"
 content:"removeNode"
 content:".createElement"
 content:"TR"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6081
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36681
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer cache management code overflow attempt"
 flow:to_server,established
 content:".appendChild("
 content:".createElement("
 within:50
 content:"window.setTimeout("
 within:200
 fast_pattern
 content:"CollectGarbage()"
 within:50
 content:".options.item("
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6064
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36680
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cache management code overflow attempt"
 flow:to_client,established
 content:".appendChild("
 content:".createElement("
 within:50
 content:"window.setTimeout("
 within:200
 fast_pattern
 content:"CollectGarbage()"
 within:50
 content:".options.item("
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6064
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:36679
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup use-after-free attempt"
 flow:to_server,established
 file_data
 content:"getElement"
 content:"click()"
 within:50
 content:"onload"
 within:100
 content:"onbeforeunload"
 within:50
 content:"designMode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6078
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36676
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkup use-after-free attempt"
 flow:to_client,established
 file_data
 content:"getElement"
 content:"click()"
 within:50
 content:"onload"
 within:100
 content:"onbeforeunload"
 within:50
 content:"designMode"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6078
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36675
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GetPlainText negative start index out of bounds write attempt"
 flow:to_server,established
 file_data
 content:"document.body.cloneNode"
 nocase
 content:"appendChild"
 within:300
 nocase
 content:"replaceChild"
 within:400
 nocase
 content:".children"
 within:50
 nocase
 pcre:"/\\.replaceChild\\s*\\x28\\s*(?P<ele>\\w+)\\s*,\\s*[^\\x29,]*?\\.children.*?(?P=ele)\\.(inner|outer)(HTML|Text)\\s*=\\s*[\\x22\\x27]?-/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6084
 reference:cve,2015-6158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36674
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GetPlainText negative start index out of bounds write attempt"
 flow:to_client,established
 file_data
 content:"document.body.cloneNode"
 nocase
 content:"appendChild"
 within:300
 nocase
 content:"replaceChild"
 within:400
 nocase
 content:".children"
 within:50
 nocase
 pcre:"/\\.replaceChild\\s*\\x28\\s*(?P<ele>\\w+)\\s*,\\s*[^\\x29,]*?\\.children.*?(?P=ele)\\.(inner|outer)(HTML|Text)\\s*=\\s*[\\x22\\x27]?-/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6084
 reference:cve,2015-6158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36673
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer fragmented CtxtBlk heap overflow attempt"
 flow:to_server,established
 file_data
 content:".body.CreateText"
 nocase
 content:".execCommand"
 within:300
 nocase
 content:"JustifyFull"
 within:20
 fast_pattern
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"RemoveFormat"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36672
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer fragmented CtxtBlk heap overflow attempt"
 flow:to_client,established
 file_data
 content:".body.CreateText"
 nocase
 content:".execCommand"
 within:300
 nocase
 content:"JustifyFull"
 within:20
 fast_pattern
 nocase
 content:".execCommand"
 within:100
 nocase
 content:"RemoveFormat"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-112
 classtype:attempted-user
 sid:36671
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nonexistent attribute removal memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|72 61 73 68 27 29 2E 72 65 6D 6F 76 65 41 74 74 72 69 62 75 74 65 28 27 3A 6F 6E 63 68 61 6E 67|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-1524
 reference:url,osvdb.org/show/osvdb/83652
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-044
 classtype:attempted-dos
 sid:36813
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nonexistent attribute removal memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|71 22 29 29 29 5B 30 5D 2E 72 65 6D 6F 76 65 41 74 74 72 69 62 75 74 65 4E 53 28 22 22 2C 53 74 72 69|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-1524
 reference:url,osvdb.org/show/osvdb/83652
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-044
 classtype:attempted-dos
 sid:36812
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer nonexistent attribute removal memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|22 74 22 29 29 29 5B 28 2D 7E 2D 30 2D 31 29 5D 2E 72 65 6D 6F 76 65 41 74 74 72 69 62 75 74 65|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2012-1524
 reference:url,osvdb.org/show/osvdb/83652
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms12-044
 classtype:attempted-dos
 sid:36811
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextBlock object use after free attempt"
 flow:to_server,established
 file_data
 content:".createTextRange"
 nocase
 content:".moveToElementText"
 within:100
 nocase
 content:".moveEnd"
 within:100
 nocase
 content:".execCommand"
 within:200
 nocase
 content:"delete"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:37010
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextBlock object use after free attempt"
 flow:to_client,established
 file_data
 content:".createTextRange"
 nocase
 content:".moveToElementText"
 within:100
 nocase
 content:".moveEnd"
 within:100
 nocase
 content:".execCommand"
 within:200
 nocase
 content:"delete"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:37009
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupPointer UnEmbed out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"createTextRange"
 nocase
 content:"text"
 within:40
 nocase
 content:"|5C|u"
 within:40
 content:"CollectGarbage"
 distance:0
 nocase
 content:"findText"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6154
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:37004
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CMarkupPointer UnEmbed out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"createTextRange"
 nocase
 content:"text"
 within:40
 nocase
 content:"|5C|u"
 within:40
 content:"CollectGarbage"
 distance:0
 nocase
 content:"findText"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6154
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:37003
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDispContainer out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:25
 nocase
 content:"-ms-block-progression"
 fast_pattern:only
 content:".execCommand"
 nocase
 content:"Justify"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6152
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36992
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDispContainer out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:25
 nocase
 content:"-ms-block-progression"
 fast_pattern:only
 content:".execCommand"
 nocase
 content:"Justify"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6152
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36991
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer cross origin policy bypass via redirect attempt"
 flow:to_client,established
 content:"|0D 0A|Location|3A|"
 http_header
 content:"returnValue"
 distance:0
 fast_pattern
 nocase
 http_header
 content:"//|0D 0A|"
 distance:0
 http_header
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6164
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36988
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray use after free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMAttrModified"
 within:25
 nocase
 content:".execCommand"
 nocase
 content:"ms-beginUndoUnit"
 within:25
 fast_pattern
 nocase
 content:".execCommand"
 nocase
 content:"undo"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6143
 reference:cve,2016-0082
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36987
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAttrArray use after free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMAttrModified"
 within:25
 nocase
 content:".execCommand"
 nocase
 content:"ms-beginUndoUnit"
 within:25
 fast_pattern
 nocase
 content:".execCommand"
 nocase
 content:"undo"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6143
 reference:cve,2016-0082
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36986
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CAttrArray out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"/<style>{{}}:"
 depth:13
 nocase
 content:!"<!DOCTYPE"
 nocase
 content:!"<html"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6168
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-125
 classtype:attempted-user
 sid:36985
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CAttrArray out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"/<style>{{}}:"
 depth:13
 nocase
 content:!"<!DOCTYPE"
 nocase
 content:!"<html"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6168
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-125
 classtype:attempted-user
 sid:36984
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer select use after free attempt"
 flow:to_server,established
 file_data
 content:".applyElement"
 fast_pattern:only
 content:".removeNode"
 nocase
 content:"<SELECT"
 nocase
 content:"<OPT"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6145
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36983
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer select use after free attempt"
 flow:to_client,established
 file_data
 content:".applyElement"
 fast_pattern:only
 content:".removeNode"
 nocase
 content:"<SELECT"
 nocase
 content:"<OPT"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6145
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36982
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer javascript argument type confusion attempt"
 flow:to_server,established
 file_data
 content:"<svg"
 nocase
 content:"<script"
 distance:0
 nocase
 content:".call.call"
 distance:0
 nocase
 pcre:"/\\x2Ecall\\x2Ecall\\s*\\x28[^\\x29\\x2C]*?\\x2C\\s*\\x28?(0x|\\d)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6134
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36981
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer javascript argument type confusion attempt"
 flow:to_client,established
 file_data
 content:"<svg"
 nocase
 content:"<script"
 distance:0
 nocase
 content:".call.call"
 distance:0
 nocase
 pcre:"/\\x2Ecall\\x2Ecall\\s*\\x28[^\\x29\\x2C]*?\\x2C\\s*\\x28?(0x|\\d)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6134
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36980
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableRow memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<script"
 nocase
 content:"defer"
 within:25
 nocase
 content:".parentNode.swapNode"
 within:100
 nocase
 content:".insertRow"
 within:100
 nocase
 content:"<table"
 within:250
 nocase
 pcre:"/\\.parentNode\\.swapNode\\s*\\x28(?P<obj>\\w+)\\x29.*?<table[^>]*?id\\s*=\\s*(?P=obj)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6083
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36969
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableRow memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<script"
 nocase
 content:"defer"
 within:25
 nocase
 content:".parentNode.swapNode"
 within:100
 nocase
 content:".insertRow"
 within:100
 nocase
 content:"<table"
 within:250
 nocase
 pcre:"/\\.parentNode\\.swapNode\\s*\\x28(?P<obj>\\w+)\\x29.*?<table[^>]*?id\\s*=\\s*(?P=obj)/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6083
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36968
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CAttribute to CStyleAttrArray type confusion attempt"
 flow:to_server,established
 file_data
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"execCommand"
 nocase
 content:"undo"
 within:10
 nocase
 content:"addEventListener"
 within:40
 nocase
 content:"DOMAttrModified"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36963
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CAttribute to CStyleAttrArray type confusion attempt"
 flow:to_client,established
 file_data
 content:"ms-beginUndoUnit"
 fast_pattern:only
 content:"execCommand"
 nocase
 content:"undo"
 within:10
 nocase
 content:"addEventListener"
 within:40
 nocase
 content:"DOMAttrModified"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6142
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36962
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBoxBuilder UpdateColumnSize out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"document.body.cloneNode"
 nocase
 content:"true"
 within:15
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".replaceChild"
 within:250
 nocase
 content:".children"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6157
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36957
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TableGridBoxBuilder UpdateColumnSize out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"document.body.cloneNode"
 nocase
 content:"true"
 within:15
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".replaceChild"
 within:250
 nocase
 content:".children"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6157
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36956
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SComputedStyle destructor out of bounds read attempt"
 flow:to_server,established
 file_data
 content:".runtimeStyle"
 nocase
 content:"-ms-wrap-flow"
 within:25
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:"document"
 within:15
 nocase
 content:".runtimeStyle"
 within:100
 nocase
 content:"-ms-wrap-flow"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6140
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36951
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SComputedStyle destructor out of bounds read attempt"
 flow:to_client,established
 file_data
 content:".runtimeStyle"
 nocase
 content:"-ms-wrap-flow"
 within:25
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:"document"
 within:15
 nocase
 content:".runtimeStyle"
 within:100
 nocase
 content:"-ms-wrap-flow"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6140
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36950
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell invalid index memory corruption attempt"
 flow:to_server,established
 file_data
 content:".appendChild"
 nocase
 content:".cloneNode"
 within:50
 nocase
 content:"document.all"
 within:250
 nocase
 content:".removeNode"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6149
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36949
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableCell invalid index memory corruption attempt"
 flow:to_client,established
 file_data
 content:".appendChild"
 nocase
 content:".cloneNode"
 within:50
 nocase
 content:"document.all"
 within:250
 nocase
 content:".removeNode"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6149
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36948
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSharedStyleSheet RemoveRule out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"@media"
 nocase
 content:"document.getElementById"
 nocase
 content:".sheet.addRule"
 within:30
 nocase
 content:"document.getElementById"
 within:250
 nocase
 content:".sheet.deleteRule"
 within:30
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6141
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36947
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSharedStyleSheet RemoveRule out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"@media"
 nocase
 content:"document.getElementById"
 nocase
 content:".sheet.addRule"
 within:30
 nocase
 content:"document.getElementById"
 within:250
 nocase
 content:".sheet.deleteRule"
 within:30
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6141
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36946
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_server,established
 file_data
 content:"body.createTextRange"
 nocase
 content:"MutationObserver"
 within:200
 nocase
 content:".observe"
 within:200
 nocase
 content:"document"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6160
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36945
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos use after free attempt"
 flow:to_client,established
 file_data
 content:"body.createTextRange"
 nocase
 content:"MutationObserver"
 within:200
 nocase
 content:".observe"
 within:200
 nocase
 content:"document"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6160
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36944
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer flexbox use after free attempt"
 flow:to_server,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 fast_pattern
 nocase
 content:".execCommand"
 within:250
 nocase
 content:"InsertImage"
 within:25
 nocase
 content:".replaceChild"
 within:250
 nocase
 content:".children"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6155
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-125
 classtype:attempted-user
 sid:36943
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer flexbox use after free attempt"
 flow:to_client,established
 file_data
 content:".addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:25
 fast_pattern
 nocase
 content:".execCommand"
 within:250
 nocase
 content:"InsertImage"
 within:25
 nocase
 content:".replaceChild"
 within:250
 nocase
 content:".children"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6155
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-125
 classtype:attempted-user
 sid:36942
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSpliceTreeEngine RemoveSplice null pointer dereference attempt"
 flow:to_server,established
 file_data
 content:".expand"
 nocase
 content:".select"
 within:50
 nocase
 content:".getSelection"
 within:100
 nocase
 content:".deleteFromDocument"
 within:25
 nocase
 content:"setTimeout"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6148
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36941
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSpliceTreeEngine RemoveSplice null pointer dereference attempt"
 flow:to_client,established
 file_data
 content:".expand"
 nocase
 content:".select"
 within:50
 nocase
 content:".getSelection"
 within:100
 nocase
 content:".deleteFromDocument"
 within:25
 nocase
 content:"setTimeout"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6148
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36940
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer invalid table grid memory corruption attempt"
 flow:to_server,established
 file_data
 content:"msGetUntransformedBounds"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"table"
 within:7
 nocase
 content:".createTFoot"
 nocase
 content:"table-header-group"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6153
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36939
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid table grid memory corruption attempt"
 flow:to_client,established
 file_data
 content:"msGetUntransformedBounds"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"table"
 within:7
 nocase
 content:".createTFoot"
 nocase
 content:"table-header-group"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6153
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36938
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TextBlock out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"HGROUP:first-line"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"HGROUP"
 within:10
 nocase
 content:".setAttribute"
 distance:0
 nocase
 content:"class"
 within:10
 nocase
 content:".setAttribute"
 distance:0
 nocase
 content:"class"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6159
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36937
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TextBlock out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"HGROUP:first-line"
 fast_pattern:only
 content:"document.createElement"
 nocase
 content:"HGROUP"
 within:10
 nocase
 content:".setAttribute"
 distance:0
 nocase
 content:"class"
 within:10
 nocase
 content:".setAttribute"
 distance:0
 nocase
 content:"class"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6159
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36936
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge iframe climbing cross site scripting attempt"
 flow:to_server,established
 file_data
 content:"<iframe"
 nocase
 content:"data:"
 within:50
 nocase
 content:"<script"
 within:50
 nocase
 content:"parent.location.replace"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6170
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36933
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge iframe climbing cross site scripting attempt"
 flow:to_client,established
 file_data
 content:"<iframe"
 nocase
 content:"data:"
 within:50
 nocase
 content:"<script"
 within:50
 nocase
 content:"parent.location.replace"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6170
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36932
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.replaceNode"
 nocase
 content:"document.body"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6150
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36929
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTableLayout use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.replaceNode"
 nocase
 content:"document.body"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6150
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36928
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CObjectElement type confusion attempt"
 flow:to_server,established
 file_data
 content:".fireEvent"
 fast_pattern
 nocase
 content:"onclick"
 within:25
 nocase
 content:"X-UA-Compatible"
 nocase
 content:"IE=9"
 within:50
 nocase
 content:"document.getElement"
 nocase
 content:".getAttribute"
 within:100
 nocase
 content:"srcElement"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6156
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36927
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CObjectElement type confusion attempt"
 flow:to_client,established
 file_data
 content:".fireEvent"
 fast_pattern
 nocase
 content:"onclick"
 within:25
 nocase
 content:"X-UA-Compatible"
 nocase
 content:"IE=9"
 within:50
 nocase
 content:"document.getElement"
 nocase
 content:".getAttribute"
 within:100
 nocase
 content:"srcElement"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6156
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36926
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_server,established
 file_data
 content:"<script"
 nocase
 content:"VBScript"
 within:50
 nocase
 content:"Public "
 nocase
 content:"Default "
 within:15
 nocase
 content:"Property "
 within:15
 nocase
 content:"Set "
 nocase
 content:"Nothing"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6135
 reference:cve,2015-6136
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-126
 classtype:attempted-user
 sid:36923
 rev:6
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_client,established
 file_data
 content:"<script"
 nocase
 content:"VBScript"
 within:50
 nocase
 content:"Public "
 nocase
 content:"Default "
 within:15
 nocase
 content:"Property "
 within:15
 nocase
 content:"Set "
 nocase
 content:"Nothing"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6135
 reference:cve,2015-6136
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-126
 classtype:attempted-user
 sid:36922
 rev:7
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer invalid TableRow use after free attempt"
 flow:to_server,established
 file_data
 content:"document.body.appendChild(document)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36921
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer invalid TableRow use after free attempt"
 flow:to_client,established
 file_data
 content:"document.body.appendChild(document)"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6147
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 classtype:attempted-user
 sid:36920
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CElement object use after free attempt"
 flow:to_server,established
 file_data
 content:"document.getSelection"
 nocase
 content:".collapseToEnd"
 within:100
 fast_pattern
 nocase
 content:".parentNode.removeChild"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6151
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36919
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CElement object use after free attempt"
 flow:to_client,established
 file_data
 content:"document.getSelection"
 nocase
 content:".collapseToEnd"
 within:100
 fast_pattern
 nocase
 content:".parentNode.removeChild"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6151
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-124
 classtype:attempted-user
 sid:36918
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iCalendar cross site scripting attempt"
 flow:to_client,established
 file_data
 content:"BEGIN:VCALENDAR"
 depth:15
 content:"DESCRIPTION:"
 distance:0
 nocase
 content:"<script"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6139
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-124
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-125
 classtype:attempted-user
 sid:36917
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_server,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"<script"
 nocase
 content:"VBScript"
 within:50
 nocase
 content:"redim"
 nocase
 content:"preserve"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0002
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-001
 classtype:attempted-user
 sid:37284
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_client,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"<script"
 nocase
 content:"VBScript"
 within:50
 nocase
 content:"redim"
 nocase
 content:"preserve"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0002
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-001
 classtype:attempted-user
 sid:37283
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"BROWSER-IE Microsoft Internet Explorer mapi32x.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"m|00|a|00|p|00|i|00|3|00|2|00|x|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 pcre:"/(\\x19\\x00|\\x00\\x5C)\\x00m\\x00a\\x00p\\x00i\\x003\\x002\\x00x\\x00\\.\\x00d\\x00l\\x00l\\x00\\x00\\x00/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-0020
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37258
 rev:1
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"BROWSER-IE Microsoft Internet Explorer mapi32x.dll dll-load exploit attempt"
 flow:to_server,established
 content:"/mapi32x.dll"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0020
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-007
 classtype:attempted-user
 sid:37257
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CFGBitmap heap code execution attempt"
 flow:to_server,established
 file_data
 content:"CollectGarbage"
 fast_pattern:only
 content:".onload"
 nocase
 content:"for"
 content:"0x1000"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0080
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-011
 classtype:attempted-user
 sid:37615
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CFGBitmap heap code execution attempt"
 flow:to_client,established
 file_data
 content:"CollectGarbage"
 fast_pattern:only
 content:".onload"
 nocase
 content:"for"
 content:"0x1000"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0080
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-011
 classtype:attempted-user
 sid:37614
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CACPWrap object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"onpropertychange"
 content:"createTextRange"
 within:140
 content:".execCommand"
 within:60
 content:"ms-beginUndoUnit"
 within:20
 content:"DefaultParagraphSeparator"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0062
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37613
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CACPWrap object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"onpropertychange"
 content:"createTextRange"
 within:140
 content:".execCommand"
 within:60
 content:"ms-beginUndoUnit"
 within:20
 content:"DefaultParagraphSeparator"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0062
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37612
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CallInvoke type confusion attempt"
 flow:to_server,established
 file_data
 content:"opener[|27 5C|u"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0061
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37611
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CallInvoke type confusion attempt"
 flow:to_client,established
 file_data
 content:"opener[|27 5C|u"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0061
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37610
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CallInvoke type confusion attempt"
 flow:to_server,established
 file_data
 content:"opener[|22 5C|u"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0061
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37609
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CallInvoke type confusion attempt"
 flow:to_client,established
 file_data
 content:"opener[|22 5C|u"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0061
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37608
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer StrCmpNICW string object use after free attempt"
 flow:to_server,established
 file_data
 content:"valueOf"
 nocase
 content:"location"
 within:20
 nocase
 content:"toString"
 within:20
 fast_pattern
 nocase
 content:"location.href=|22 22|"
 distance:0
 nocase
 content:"document.open("
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0067
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37605
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer StrCmpNICW string object use after free attempt"
 flow:to_client,established
 file_data
 content:"valueOf"
 nocase
 content:"location"
 within:20
 nocase
 content:"toString"
 within:20
 fast_pattern
 nocase
 content:"location.href=|22 22|"
 distance:0
 nocase
 content:"document.open("
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0067
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37604
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer IFRAME object constructor cross site scripting attempt"
 flow:to_server,established
 file_data
 content:"returnValue"
 nocase
 content:".constructor.constructor"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:web-application-attack
 sid:37603
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer IFRAME object constructor cross site scripting attempt"
 flow:to_client,established
 file_data
 content:"returnValue"
 nocase
 content:".constructor.constructor"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0068
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:web-application-attack
 sid:37602
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTextBlock use-after-free attempt"
 flow:to_server,established
 file_data
 content:".createRange"
 nocase
 content:".execCommand"
 within:80
 nocase
 content:"InsertOrderedList"
 within:25
 fast_pattern
 nocase
 content:".removeAllRanges"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0071
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37597
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTextBlock use-after-free attempt"
 flow:to_client,established
 file_data
 content:".createRange"
 nocase
 content:".execCommand"
 within:80
 nocase
 content:"InsertOrderedList"
 within:25
 fast_pattern
 nocase
 content:".removeAllRanges"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0071
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37596
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge SysFreeString double free attempt"
 flow:to_server,established
 file_data
 content:".setAttribute"
 nocase
 content:"nodeValue"
 within:15
 nocase
 content:"this.toString"
 nocase
 content:"this.valueOf"
 within:75
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0060
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-009
 classtype:attempted-user
 sid:37582
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge SysFreeString double free attempt"
 flow:to_client,established
 file_data
 content:".setAttribute"
 nocase
 content:"nodeValue"
 within:15
 nocase
 content:"this.toString"
 nocase
 content:"this.valueOf"
 within:75
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0060
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-009
 classtype:attempted-user
 sid:37581
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CTextBlock out of bounds read attempt"
 flow:to_server,established
 file_data
 content:".createTextRange"
 nocase
 content:".select"
 within:100
 nocase
 content:"getSelection"
 within:200
 nocase
 content:".removeAllRanges"
 within:25
 nocase
 content:".moveStart"
 within:100
 nocase
 content:".execCommand"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0083
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37576
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CTextBlock out of bounds read attempt"
 flow:to_client,established
 file_data
 content:".createTextRange"
 nocase
 content:".select"
 within:100
 nocase
 content:"getSelection"
 within:200
 nocase
 content:".removeAllRanges"
 within:25
 nocase
 content:".moveStart"
 within:100
 nocase
 content:".execCommand"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0083
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-011
 classtype:attempted-user
 sid:37575
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDomPrototype type confusion attempt"
 flow:to_server,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"document.implementation"
 nocase
 content:".prototype"
 within:50
 nocase
 pcre:"/\\.prototype\\.(hasFeature|isPrototypeOf)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0063
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37574
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDomPrototype type confusion attempt"
 flow:to_server,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"DOMImplementation"
 nocase
 content:".prototype"
 within:50
 nocase
 pcre:"/\\.prototype\\.(hasFeature|isPrototypeOf)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0063
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37573
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDomPrototype type confusion attempt"
 flow:to_client,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"document.implementation"
 nocase
 content:".prototype"
 within:50
 nocase
 pcre:"/\\.prototype\\.(hasFeature|isPrototypeOf)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0063
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37572
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDomPrototype type confusion attempt"
 flow:to_client,established
 file_data
 content:"X-UA-Compatible"
 nocase
 content:"IE=8"
 within:50
 nocase
 content:"DOMImplementation"
 nocase
 content:".prototype"
 within:50
 nocase
 pcre:"/\\.prototype\\.(hasFeature|isPrototypeOf)/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0063
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37571
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDATA use-after-free attempt"
 flow:to_server,established
 file_data
 content:"<![CDATA["
 fast_pattern
 content:"createElementNS"
 distance:0
 nocase
 content:"svg"
 within:50
 nocase
 content:"CollectGarbage"
 distance:0
 nocase
 content:"]]>"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0072
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37554
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDATA use-after-free attempt"
 flow:to_client,established
 file_data
 content:"<![CDATA["
 fast_pattern
 content:"createElementNS"
 distance:0
 nocase
 content:"svg"
 within:50
 nocase
 content:"CollectGarbage"
 distance:0
 nocase
 content:"]]>"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0072
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-009
 classtype:attempted-user
 sid:37553
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTextElement use after free attempt"
 flow:to_server,established
 file_data
 content:"document.getElementById"
 nocase
 content:"loaded"
 within:200
 nocase
 content:"click()"
 within:200
 nocase
 content:"<form"
 nocase
 content:"text"
 within:200
 nocase
 content:".innerHTML ="
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-2782
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:37634
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTextElement use after free attempt"
 flow:to_client,established
 file_data
 content:"document.getElementById"
 nocase
 content:"loaded"
 within:200
 nocase
 content:"click()"
 within:200
 nocase
 content:"<form"
 nocase
 content:"text"
 within:200
 nocase
 content:".innerHTML ="
 fast_pattern
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-2782
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-035
 classtype:attempted-user
 sid:37633
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_server,established
 file_data
 content:"onbeforeeditfocus"
 fast_pattern:only
 content:".createElement"
 nocase
 content:"div"
 within:10
 nocase
 content:"className"
 within:50
 content:"appendChild"
 within:50
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:37811
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CDisplayPointer use after free attempt"
 flow:to_client,established
 file_data
 content:"onbeforeeditfocus"
 fast_pattern:only
 content:".createElement"
 nocase
 content:"div"
 within:10
 nocase
 content:"className"
 within:50
 content:"appendChild"
 within:50
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3205
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-069
 classtype:attempted-user
 sid:37810
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer DataView use-after-free attempt"
 flow:to_server,established
 file_data
 content:"setInt32"
 fast_pattern:only
 content:"ArrayBuffer"
 nocase
 content:"DataView"
 nocase
 content:"valueOf"
 nocase
 content:"postMessage"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1747
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:37970
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer DataView use-after-free attempt"
 flow:to_client,established
 file_data
 content:"setInt32"
 fast_pattern:only
 content:"ArrayBuffer"
 nocase
 content:"DataView"
 nocase
 content:"valueOf"
 nocase
 content:"postMessage"
 within:150
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1747
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-056
 classtype:attempted-user
 sid:37969
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer mshtml InsertRange out of bounds write access"
 flow:to_server,established
 file_data
 content:"createTextRange"
 nocase
 content:"insertAdjacentHTML"
 nocase
 content:"appendChild"
 within:100
 nocase
 content:"createElement"
 within:50
 nocase
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:50
 fast_pattern
 nocase
 content:"execCommand"
 within:200
 nocase
 content:"execCommand"
 within:150
 nocase
 content:"Delete"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0103
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38118
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mshtml InsertRange out of bounds write access"
 flow:to_client,established
 file_data
 content:"createTextRange"
 nocase
 content:"insertAdjacentHTML"
 nocase
 content:"appendChild"
 within:100
 nocase
 content:"createElement"
 within:50
 nocase
 content:"addEventListener"
 nocase
 content:"DOMNodeRemoved"
 within:50
 fast_pattern
 nocase
 content:"execCommand"
 within:200
 nocase
 content:"execCommand"
 within:150
 nocase
 content:"Delete"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0103
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38117
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer addRow out-of-bounds read attempt"
 flow:to_server,established
 file_data
 content:"<body"
 nocase
 content:"onload"
 within:40
 nocase
 content:".removeNode"
 nocase
 content:".insertRow"
 within:35
 fast_pattern
 nocase
 content:"<table"
 nocase
 content:"<tr"
 distance:0
 nocase
 content:"rowSpan"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0107
 reference:cve,2016-3242
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:38113
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer addRow out-of-bounds read attempt"
 flow:to_client,established
 file_data
 content:"<body"
 nocase
 content:"onload"
 within:40
 nocase
 content:".removeNode"
 nocase
 content:".insertRow"
 within:35
 fast_pattern
 nocase
 content:"<table"
 nocase
 content:"<tr"
 distance:0
 nocase
 content:"rowSpan"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0107
 reference:cve,2016-3242
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:38112
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free"
 flow:to_server,established
 file_data
 content:"erHTML"
 nocase
 content:"erText"
 within:200
 nocase
 content:"createTextRange"
 within:100
 nocase
 content:"execCommand"
 nocase
 content:"insertInputRadio"
 within:50
 nocase
 content:"text"
 within:100
 nocase
 content:"select"
 within:50
 nocase
 content:"CollectGarbage"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0104
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38109
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CGeneratedTreeNode use-after-free"
 flow:to_client,established
 file_data
 content:"erHTML"
 nocase
 content:"erText"
 within:200
 nocase
 content:"createTextRange"
 within:100
 nocase
 content:"execCommand"
 nocase
 content:"insertInputRadio"
 within:50
 nocase
 content:"text"
 within:100
 nocase
 content:"select"
 within:50
 nocase
 content:"CollectGarbage"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0104
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38108
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CEditEventSink navigate use after free attempt"
 flow:to_server,established
 file_data
 content:"onresize"
 fast_pattern
 nocase
 content:"location.href"
 within:50
 nocase
 content:"#"
 within:25
 content:"contenteditable"
 nocase
 content:"false"
 within:25
 nocase
 content:".value"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,77445
 reference:cve,2015-6071
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:38103
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CEditEventSink navigate use after free attempt"
 flow:to_client,established
 file_data
 content:"onresize"
 fast_pattern
 nocase
 content:"location.href"
 within:50
 nocase
 content:"#"
 within:25
 content:"contenteditable"
 nocase
 content:"false"
 within:25
 nocase
 content:".value"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,77445
 reference:cve,2015-6071
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-112
 classtype:attempted-user
 sid:38102
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer TableCellLayoutArray use-after-free attempt"
 flow:to_server,established
 file_data
 content:"meta"
 content:"Expires"
 within:50
 nocase
 content:"break-before: column"
 within:250
 fast_pattern
 content:"column-count"
 within:250
 nocase
 content:"table"
 within:50
 nocase
 content:"border-right: solid"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0109
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38099
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer TableCellLayoutArray use-after-free attempt"
 flow:to_client,established
 file_data
 content:"meta"
 content:"Expires"
 within:50
 nocase
 content:"break-before: column"
 within:250
 fast_pattern
 content:"column-count"
 within:250
 nocase
 content:"table"
 within:50
 nocase
 content:"border-right: solid"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0109
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38098
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer out of bound write access attempt"
 flow:to_server,established
 file_data
 content:"column-count"
 fast_pattern:only
 content:"not(TH)"
 nocase
 content:"-ms-wrap-flow"
 nocase
 content:"-ms-inline-grid"
 nocase
 content:"createElement"
 nocase
 content:"title"
 within:50
 nocase
 content:"createElement"
 nocase
 content:"FORM"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0230
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-admin
 sid:38097
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer out of bound write access attempt"
 flow:to_client,established
 file_data
 content:"column-count"
 fast_pattern:only
 content:"not(TH)"
 nocase
 content:"-ms-wrap-flow"
 nocase
 content:"-ms-inline-grid"
 nocase
 content:"createElement"
 nocase
 content:"title"
 within:50
 nocase
 content:"createElement"
 nocase
 content:"FORM"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0230
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-admin
 sid:38096
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos remote code execution attempt"
 flow:to_server,established
 file_data
 content:"MutationObserver"
 fast_pattern
 nocase
 content:"target.parentNode"
 within:1500
 nocase
 content:"replaceChild"
 within:50
 nocase
 content:"records.map"
 within:500
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0102
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38095
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos remote code execution attempt"
 flow:to_client,established
 file_data
 content:"MutationObserver"
 fast_pattern
 nocase
 content:"target.parentNode"
 within:1500
 nocase
 content:"replaceChild"
 within:50
 nocase
 content:"records.map"
 within:500
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0102
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38094
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSVGHelpers use-after-free attempt"
 flow:to_server,established
 file_data
 content:"<pattern"
 nocase
 content:"<pattern"
 within:50
 nocase
 content:"viewBox"
 content:"DOMAttrModified"
 nocase
 content:"createDocument"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0111
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38091
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSVGHelpers use-after-free attempt"
 flow:to_client,established
 file_data
 content:"<pattern"
 nocase
 content:"<pattern"
 within:50
 nocase
 content:"viewBox"
 content:"DOMAttrModified"
 nocase
 content:"createDocument"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0111
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38090
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer string type confusion remote code execution attempt"
 flow:to_server,established
 file_data
 content:"884e2049-217d-11da-b2a4-000e7bbb2b09"
 fast_pattern:only
 content:"-ms-writing-mode:"
 nocase
 content:"tb-lr"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0105
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38089
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer string type confusion remote code execution attempt"
 flow:to_client,established
 file_data
 content:"884e2049-217d-11da-b2a4-000e7bbb2b09"
 fast_pattern:only
 content:"-ms-writing-mode:"
 nocase
 content:"tb-lr"
 within:10
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0105
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38088
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTravelEntry use after free attempt"
 flow:to_server,established
 file_data
 content:"8856F961-340A-11D0-A96B-00C04FD705A2"
 fast_pattern:only
 content:".removeNode"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38086
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTravelEntry use after free attempt"
 flow:to_client,established
 file_data
 content:"8856F961-340A-11D0-A96B-00C04FD705A2"
 fast_pattern:only
 content:".removeNode"
 nocase
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0113
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38085
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer SetItem use after free attempt"
 flow:to_server,established
 file_data
 content:"addEventListener"
 nocase
 content:"DOMAttrModified"
 within:25
 fast_pattern
 nocase
 content:"dataset"
 within:250
 nocase
 content:"prevValue"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0106
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38082
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer SetItem use after free attempt"
 flow:to_client,established
 file_data
 content:"addEventListener"
 nocase
 content:"DOMAttrModified"
 within:25
 fast_pattern
 nocase
 content:"dataset"
 within:250
 nocase
 content:"prevValue"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0106
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38081
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer embedded media player use after free attempt"
 flow:to_server,established
 file_data
 content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"
 fast_pattern:only
 content:"StatusChange"
 nocase
 content:"SelectAll"
 nocase
 content:"Delete"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0098
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-027
 classtype:attempted-user
 sid:38080
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer embedded media player use after free attempt"
 flow:to_client,established
 file_data
 content:"6BF52A52-394A-11d3-B153-00C04F79FAA6"
 fast_pattern:only
 content:"StatusChange"
 nocase
 content:"SelectAll"
 nocase
 content:"Delete"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0098
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-027
 classtype:attempted-user
 sid:38079
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CAsyncTpWorker Windows.Data.Pdf.dll object use after free attempt"
 flow:to_server,established
 file_data
 content:"|27 4E 3F 65 D0 75 8C 06 FA 6F A0 FF 06 FA 6F A0 FF 06 FA 6F A0 FF AE 9F 6F D3 CA 8B 31 14 18 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0118
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-028
 classtype:attempted-user
 sid:38076
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CAsyncTpWorker Windows.Data.Pdf.dll object use after free attempt"
 flow:to_server,established
 file_data
 content:"|04 50 EE 22 C9 3B A0 15 3D 70 18 59 A4 05 00 E3 04 C6 25 30 A0 5B 04 2C C5 46 CD 03 11 04 33 E9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0118
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-028
 classtype:attempted-user
 sid:38075
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CAsyncTpWorker Windows.Data.Pdf.dll object use after free attempt"
 flow:to_client,established
 file_data
 content:"|27 4E 3F 65 D0 75 8C 06 FA 6F A0 FF 06 FA 6F A0 FF 06 FA 6F A0 FF AE 9F 6F D3 CA 8B 31 14 18 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0118
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-028
 classtype:attempted-user
 sid:38074
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CAsyncTpWorker Windows.Data.Pdf.dll object use after free attempt"
 flow:to_client,established
 file_data
 content:"|04 50 EE 22 C9 3B A0 15 3D 70 18 59 A4 05 00 E3 04 C6 25 30 A0 5B 04 2C C5 46 CD 03 11 04 33 E9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0118
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-028
 classtype:attempted-user
 sid:38073
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos type confusion attempt"
 flow:to_server,established
 file_data
 content:"*|3A 3A|before"
 fast_pattern:only
 content:"close-quote"
 content:"url"
 within:10
 content:"?"
 within:5
 content:"position|3A|fixed|3B|"
 distance:0
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0108
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38070
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos type confusion attempt"
 flow:to_client,established
 file_data
 content:"*|3A 3A|before"
 fast_pattern:only
 content:"close-quote"
 content:"url"
 within:10
 content:"?"
 within:5
 content:"position|3A|fixed|3B|"
 distance:0
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0108
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38069
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos type confusion attempt"
 flow:to_server,established
 file_data
 content:"*|3A|before"
 fast_pattern:only
 content:"close-quote"
 content:"url"
 within:10
 content:"?"
 within:5
 content:"position|3A|fixed|3B|"
 distance:0
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0108
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38068
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CTreePos type confusion attempt"
 flow:to_client,established
 file_data
 content:"*|3A|before"
 fast_pattern:only
 content:"close-quote"
 content:"url"
 within:10
 content:"?"
 within:5
 content:"position|3A|fixed|3B|"
 distance:0
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0108
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:38067
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer GETDISPID invalid pointer access attempt"
 flow:to_server,established
 file_data
 content:"DOMAttrModified"
 nocase
 content:"touchAction"
 within:150
 nocase
 content:"textDecorationUnderline"
 within:150
 nocase
 content:"toString"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0112
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38066
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer GETDISPID invalid pointer access attempt"
 flow:to_client,established
 file_data
 content:"DOMAttrModified"
 nocase
 content:"touchAction"
 within:150
 nocase
 content:"textDecorationUnderline"
 within:150
 nocase
 content:"toString"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0112
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-023
 classtype:attempted-user
 sid:38065
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_server,established
 file_data
 content:"<script"
 nocase
 content:"VBScript"
 within:30
 nocase
 content:"redim"
 within:50
 nocase
 content:"=new Array("
 within:300
 content:"toString"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0002
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-001
 classtype:attempted-user
 sid:38309
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript engine use after free attempt"
 flow:to_client,established
 file_data
 content:"<script"
 nocase
 content:"VBScript"
 within:30
 nocase
 content:"redim"
 within:50
 nocase
 content:"=new Array("
 within:300
 content:"toString"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0002
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-001
 classtype:attempted-user
 sid:38308
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ConvertStringFromUnicodeEx out of bounds write attempt"
 flow:to_server,established
 file_data
 content:"eval"
 nocase
 content:"document.charset"
 within:25
 nocase
 content:"UTF-7"
 within:15
 fast_pattern
 nocase
 content:"document.createElement"
 nocase
 content:".value"
 nocase
 content:".click"
 nocase
 pcre:"/(?P<btn>\\w+)\\s*=\\s*document\\.createElement\\x28\\s*[\\x22\\x27]?button.*?(?P=btn)\\.value\\s*=\\s*[\\x22\\x27]{2}/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-1054
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38508
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ConvertStringFromUnicodeEx out of bounds write attempt"
 flow:to_client,established
 file_data
 content:"eval"
 nocase
 content:"document.charset"
 within:25
 nocase
 content:"UTF-7"
 within:15
 fast_pattern
 nocase
 content:"document.createElement"
 nocase
 content:".value"
 nocase
 content:".click"
 nocase
 pcre:"/(?P<btn>\\w+)\\s*=\\s*document\\.createElement\\x28\\s*[\\x22\\x27]?button.*?(?P=btn)\\.value\\s*=\\s*[\\x22\\x27]{2}/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-1054
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38507
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CChildIterator media object use-after-free attempt"
 flow:to_server,established
 file_data
 content:".insertAdjacentElement"
 fast_pattern
 content:"afterbegin"
 within:30
 nocase
 content:".createAttribute"
 within:150
 nocase
 content:".setAttributeNode"
 distance:0
 nocase
 content:"attributes"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0166
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38506
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CChildIterator media object use-after-free attempt"
 flow:to_client,established
 file_data
 content:".insertAdjacentElement"
 fast_pattern
 content:"afterbegin"
 within:30
 nocase
 content:".createAttribute"
 within:150
 nocase
 content:".setAttributeNode"
 distance:0
 nocase
 content:"attributes"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0166
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38505
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CChildIterator media object use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.designMode"
 fast_pattern
 nocase
 content:"on"
 within:10
 nocase
 content:"document.body.onload"
 nocase
 content:!"=="
 within:15
 content:"null"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0166
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38504
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CChildIterator media object use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.designMode"
 fast_pattern
 nocase
 content:"on"
 within:10
 nocase
 content:"document.body.onload"
 nocase
 content:!"=="
 within:15
 content:"null"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0166
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-user
 sid:38503
 rev:1
)\n', 'alert tcp $HOME_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge TextDataSlice type confusion attempt"
 flow:to_server,established
 file_data
 content:"insertAdjacentText"
 fast_pattern:only
 content:".styleSheets"
 nocase
 content:"bt-rl"
 nocase
 content:"-ms-text-combine-horizontal"
 within:120
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0155
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-038
 classtype:attempted-user
 sid:38486
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge TextDataSlice type confusion attempt"
 flow:to_client,established
 file_data
 content:"insertAdjacentText"
 fast_pattern:only
 content:".styleSheets"
 nocase
 content:"bt-rl"
 nocase
 content:"-ms-text-combine-horizontal"
 within:120
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0155
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-038
 classtype:attempted-user
 sid:38485
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge CStyleSheet keyframes out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"@keyframes"
 fast_pattern:only
 content:".cssRules["
 nocase
 content:".cssText"
 within:200
 nocase
 content:".deleteRule"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0157
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-038
 classtype:attempted-user
 sid:38484
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge CStyleSheet keyframes out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"@keyframes"
 fast_pattern:only
 content:".cssRules["
 nocase
 content:".cssText"
 within:200
 nocase
 content:".deleteRule"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0157
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-038
 classtype:attempted-user
 sid:38483
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge remove range out of bounds read attempt"
 flow:to_server,established
 file_data
 content:".push"
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".push"
 within:100
 nocase
 content:".useMap"
 nocase
 content:"document.createRange"
 nocase
 content:"window.getSelection"
 within:50
 nocase
 content:".removeAllRanges"
 within:100
 fast_pattern
 nocase
 content:".addRange"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0156
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-038
 classtype:attempted-user
 sid:38480
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge remove range out of bounds read attempt"
 flow:to_client,established
 file_data
 content:".push"
 nocase
 content:".appendChild"
 within:100
 nocase
 content:".push"
 within:100
 nocase
 content:".useMap"
 nocase
 content:"document.createRange"
 nocase
 content:"window.getSelection"
 within:50
 nocase
 content:".removeAllRanges"
 within:100
 fast_pattern
 nocase
 content:".addRange"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0156
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-038
 classtype:attempted-user
 sid:38479
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge webnote exit event css arbitrary file read attempt"
 flow:to_server,established
 file_data
 content:"window.open("
 fast_pattern
 content:"javascript:"
 within:20
 content:"location.protocol"
 within:500
 content:"file:"
 within:20
 content:"<iframe"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0161
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-XXX
 classtype:attempted-user
 sid:38478
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge webnote exit event css arbitrary file read attempt"
 flow:to_client,established
 file_data
 content:"window.open("
 fast_pattern
 content:"javascript:"
 within:20
 content:"location.protocol"
 within:500
 content:"file:"
 within:20
 content:"<iframe"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0161
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-XXX
 classtype:attempted-user
 sid:38477
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge iframe cross-site scripting attempt"
 flow:to_server,established
 file_data
 content:"iframe"
 content:"Proxy("
 within:500
 content:".contentWindow"
 within:50
 content:".getPrototypeOf("
 within:100
 content:".constructor.constructor("
 within:100
 content:"setImmediate("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-038
 classtype:attempted-user
 sid:38474
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge iframe cross-site scripting attempt"
 flow:to_client,established
 file_data
 content:"iframe"
 content:"Proxy("
 within:500
 content:".contentWindow"
 within:50
 content:".getPrototypeOf("
 within:100
 content:".constructor.constructor("
 within:100
 content:"setImmediate("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0158
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-038
 classtype:attempted-user
 sid:38473
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer 9 frameset use after free attempt"
 flow:to_server,established
 file_data
 content:"frameset"
 fast_pattern
 nocase
 content:".removeNode"
 within:200
 nocase
 content:".insertRow"
 within:200
 content:".removeChild"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0159
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-037
 classtype:attempted-user
 sid:38468
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer 9 frameset use after free attempt"
 flow:to_client,established
 file_data
 content:"frameset"
 fast_pattern
 nocase
 content:".removeNode"
 within:200
 nocase
 content:".insertRow"
 within:200
 nocase
 content:".removeChild"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0159
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-037
 classtype:attempted-user
 sid:38467
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer InsertSanitizedTextEx use after free attempt"
 flow:to_server,established
 file_data
 content:"createElement"
 nocase
 content:"addEventListener"
 within:100
 nocase
 content:"resize"
 within:250
 nocase
 content:"scroll"
 within:100
 nocase
 content:"CollectGarbage"
 within:150
 nocase
 content:"setTimeout"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0164
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-admin
 sid:38466
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer InsertSanitizedTextEx use after free attempt"
 flow:to_client,established
 file_data
 content:"createElement"
 nocase
 content:"addEventListener"
 within:100
 nocase
 content:"resize"
 within:250
 nocase
 content:"scroll"
 within:100
 nocase
 content:"CollectGarbage"
 within:150
 nocase
 content:"setTimeout"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0164
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-037
 classtype:attempted-admin
 sid:38465
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript toString redim array use after free attempt"
 flow:to_server, established
 file_data
 content:".toString"
 nocase
 content:"function"
 within:20
 nocase
 content:"<script"
 nocase
 content:"vbscript"
 within:60
 fast_pattern
 nocase
 content:"redim"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0189
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-051
 classtype:attempted-user
 sid:38842
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript toString redim array use after free attempt"
 flow:to_client, established
 file_data
 content:".toString"
 nocase
 content:"function"
 within:20
 nocase
 content:"<script"
 nocase
 content:"vbscript"
 within:60
 fast_pattern
 nocase
 content:"redim"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0189
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-051
 classtype:attempted-user
 sid:38841
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer BooleanProtoObj objects JSONStringifyArray use-after-free attempt"
 flow:to_server,established
 file_data
 content:"function"
 nocase
 content:"delete"
 within:100
 nocase
 content:"JSON.stringify"
 distance:0
 nocase
 pcre:"/var\\s+(?P<json_var>\\w+)\\s?=\\s?[^>]*var\\s+(?P<replace>\\w+)\\s?=\\s?function[^>]*delete\\s+(?P=json_var)[^>]*JSON\\.stringify\\((?P=json_var),\\s?(?P=replace)\\)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0187
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-051
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-053
 classtype:attempted-user
 sid:38829
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer BooleanProtoObj objects JSONStringifyArray use-after-free attempt"
 flow:to_client,established
 file_data
 content:"function"
 nocase
 content:"delete"
 within:100
 nocase
 content:"JSON.stringify"
 distance:0
 nocase
 pcre:"/var\\s+(?P<json_var>\\w+)\\s?=\\s?[^>]*var\\s+(?P<replace>\\w+)\\s?=\\s?function[^>]*delete\\s+(?P=json_var)[^>]*JSON\\.stringify\\((?P=json_var),\\s?(?P=replace)\\)/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0187
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-051
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-053
 classtype:attempted-user
 sid:38828
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge Array.prototype.fill out of bounds write attempt"
 flow:to_server,established
 file_data
 content:"Uint32Array"
 nocase
 content:"__proto__"
 within:100
 fast_pattern
 nocase
 content:"Array"
 within:100
 nocase
 content:".fill"
 within:100
 nocase
 pcre:"/var\\s+(?P<array>\\w+)\\s*=\\s*new\\s+Uint32Array.*?(?P=array)\\s*\\.\\s*__proto__\\s*=\\s*new\\s+Array.*?(?P=array)\\s*\\.\\s*fill/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-052
 classtype:attempted-user
 sid:38806
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge Array.prototype.fill out of bounds write attempt"
 flow:to_client,established
 file_data
 content:"Uint32Array"
 nocase
 content:"__proto__"
 within:100
 fast_pattern
 nocase
 content:"Array"
 within:100
 nocase
 content:".fill"
 within:100
 nocase
 pcre:"/var\\s+(?P<array>\\w+)\\s*=\\s*new\\s+Uint32Array.*?(?P=array)\\s*\\.\\s*__proto__\\s*=\\s*new\\s+Array.*?(?P=array)\\s*\\.\\s*fill/si"
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0193
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-052
 classtype:attempted-user
 sid:38805
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge graphics subcomponent use after free attempt"
 flow:to_server,established
 file_data
 content:".getContext"
 nocase
 content:"2d"
 within:25
 nocase
 content:".createImageData"
 fast_pattern
 nocase
 content:".getImageData"
 within:200
 nocase
 content:".putImageData"
 within:200
 nocase
 pcre:"/\\.putImageData\\s*\\x28\\s*[^,]+,\\s*[\\d\\x2e]{15}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0184
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-055
 classtype:attempted-user
 sid:38798
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge graphics subcomponent use after free attempt"
 flow:to_client,established
 file_data
 content:".getContext"
 nocase
 content:"2d"
 within:25
 nocase
 content:".createImageData"
 fast_pattern
 nocase
 content:".getImageData"
 within:200
 nocase
 content:".putImageData"
 within:200
 nocase
 pcre:"/\\.putImageData\\s*\\x28\\s*[^,]+,\\s*[\\d\\x2e]{15}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0184
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-055
 classtype:attempted-user
 sid:38797
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized pointer attempt"
 flow:to_server,established
 file_data
 content:"Proxy"
 nocase
 content:"Array"
 within:50
 nocase
 content:"has"
 within:50
 nocase
 content:"concat"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0186
 reference:cve,2016-0191
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-052
 classtype:attempted-user
 sid:38777
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer uninitialized pointer attempt"
 flow:to_client,established
 file_data
 content:"Proxy"
 nocase
 content:"Array"
 within:50
 nocase
 content:"has"
 within:50
 nocase
 content:"concat"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0186
 reference:cve,2016-0191
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-052
 classtype:attempted-user
 sid:38776
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer EMF file integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.emf
 file_data
 content:"|46 00 00 00|"
 offset:84
 content:"|04 00 00 40|"
 within:4
 distance:12
 byte_test:4,>=,268435454,16,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0169
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-055
 classtype:attempted-user
 sid:38773
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer EMF file integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.emf
 file_data
 content:"|46 00 00 00|"
 offset:84
 content:"|04 00 00 40|"
 within:4
 distance:12
 byte_test:4,>=,268435454,16,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0169
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-055
 classtype:attempted-user
 sid:38772
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll null pointer dereference attempt"
 flow:to_server,established
 file_data
 content:".insertAdjacentText"
 fast_pattern:only
 content:".styleSheets"
 nocase
 content:".insertRule"
 within:25
 nocase
 content:"font-size"
 within:50
 nocase
 pcre:"/font-size\\s*:\\s*\\d{5}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0192
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-051
 classtype:attempted-user
 sid:38764
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll null pointer dereference attempt"
 flow:to_client,established
 file_data
 content:".insertAdjacentText"
 fast_pattern:only
 content:".styleSheets"
 nocase
 content:".insertRule"
 within:25
 nocase
 content:"font-size"
 within:50
 nocase
 pcre:"/font-size\\s*:\\s*\\d{5}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0192
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-051
 classtype:attempted-user
 sid:38763
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge malformed PDF JPEG2000 object out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"|49 43 B6 EE 4D 55 0A 05 D7 D1 52 08 99 36 FF AC 1A 75 8F BA 92 4A BA 32 E2 4A 4D 72 56 6D 79 DB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3215
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39239
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge malformed PDF JPEG2000 object out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"|49 43 B6 EE 4D 55 0A 05 D7 D1 52 08 99 36 FF AC 1A 75 8F BA 92 4A BA 32 E2 4A 4D 72 56 6D 79 DB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3215
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39238
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer scripting engine buffer overflow attempt"
 flow:to_server,established
 file_data
 content:"<script"
 content:"vbscript"
 within:200
 nocase
 content:"class "
 within:500
 nocase
 content:"Private"
 within:200
 nocase
 content:"sub"
 within:15
 nocase
 content:"Class_Terminate"
 within:30
 content:"new"
 within:100
 nocase
 content:"end sub"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3207
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-069
 classtype:attempted-user
 sid:39237
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer scripting engine buffer overflow attempt"
 flow:to_client,established
 content:"<script"
 content:"vbscript"
 within:200
 nocase
 content:"class "
 within:500
 nocase
 content:"Private"
 within:200
 nocase
 content:"sub"
 within:15
 nocase
 content:"Class_Terminate"
 within:30
 content:"new"
 within:100
 nocase
 content:"end sub"
 within:100
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-3207
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-069
 classtype:attempted-user
 sid:39236
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer tagged integer type confusion attempt"
 flow:to_server,established
 file_data
 content:".createAttribute"
 nocase
 content:"loop"
 within:25
 nocase
 content:".nodeValue"
 nocase
 content:".setAttributeNode"
 nocase
 content:".removeAttributeNode"
 fast_pattern:only
 pcre:"/var\\s+(?P<attr>\\w+)\\s*=\\s*document\\.createAttribute\\s*\\x28\\s*[\\x22\\x27]loop[\\x22\\x27].*?(?P=attr)\\.nodeValue/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0199
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39235
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer tagged integer type confusion attempt"
 flow:to_client,established
 file_data
 content:".createAttribute"
 nocase
 content:"loop"
 within:25
 nocase
 content:".nodeValue"
 nocase
 content:".setAttributeNode"
 nocase
 content:".removeAttributeNode"
 fast_pattern:only
 pcre:"/var\\s+(?P<attr>\\w+)\\s*=\\s*document\\.createAttribute\\s*\\x28\\s*[\\x22\\x27]loop[\\x22\\x27].*?(?P=attr)\\.nodeValue/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0199
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39234
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge Content Security Policy bypass attempt"
 flow:to_client,established
 content:"function|2A 28 29 7B 7D|"
 content:".constructor"
 within:30
 content:"().next()"
 within:30
 metadata:policy balanced-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3198
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-068
 classtype:attempted-user
 sid:39233
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge Content Security Policy bypass attempt"
 flow:to_server,established
 file_data
 content:"function|2A 28 29 7B 7D|"
 content:".constructor"
 within:30
 content:"().next()"
 within:30
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3198
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-068
 classtype:attempted-user
 sid:39232
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CSS link element use-after-free attempt"
 flow:to_server,established
 file_data
 content:"document.styleSheets"
 nocase
 content:".cssText"
 within:30
 nocase
 content:"@import url(#)"
 within:50
 fast_pattern
 nocase
 content:"document.createElement"
 nocase
 content:".href"
 within:100
 nocase
 content:"#"
 within:20
 content:"document.body.appendChild"
 nocase
 content:"window.location.reload"
 nocase
 content:"document.styleSheets"
 nocase
 content:".cssText"
 within:20
 nocase
 pcre:"/\\x2EcssText\\s*=\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0200
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39231
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CSS link element use-after-free attempt"
 flow:to_client,established
 file_data
 content:"document.styleSheets"
 nocase
 content:".cssText"
 within:30
 nocase
 content:"@import url(#)"
 within:50
 fast_pattern
 nocase
 content:"document.createElement"
 nocase
 content:".href"
 within:100
 nocase
 content:"#"
 within:20
 content:"document.body.appendChild"
 nocase
 content:"window.location.reload"
 nocase
 content:"document.styleSheets"
 nocase
 content:".cssText"
 within:20
 nocase
 pcre:"/\\x2EcssText\\s*=\\s*[\\x22\\x27]{2}/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-0200
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39230
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge edgehtml.dll uninitialized pointer vulnerability attempt"
 flow:to_client,established
 file_data
 content:"document.body.isEqualNode"
 fast_pattern:only
 content:"video"
 nocase
 content:"videoTracks"
 within:40
 nocase
 content:"apply"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-3222
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-068
 classtype:attempted-user
 sid:39220
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge edgehtml.dll uninitialized pointer vulnerability attempt"
 flow:to_client,established
 file_data
 content:"document.body.isEqualNode"
 fast_pattern:only
 content:"audio"
 nocase
 content:"audioTracks"
 within:40
 nocase
 content:"apply"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-3222
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-068
 classtype:attempted-user
 sid:39219
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript out of bounds memory access remote code execution attempt"
 flow:to_server,established
 file_data
 content:"vbscript"
 nocase
 content:"class"
 distance:0
 nocase
 content:"redim"
 distance:0
 nocase
 content:"Private Sub Class_Initialize"
 nocase
 content:"Private Sub Class_Terminate"
 fast_pattern
 nocase
 content:"Join"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3206
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-069
 classtype:attempted-user
 sid:39212
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript out of bounds memory access remote code execution attempt"
 flow:to_client,established
 file_data
 content:"vbscript"
 nocase
 content:"class"
 distance:0
 nocase
 content:"redim"
 distance:0
 nocase
 content:"Private Sub Class_Initialize"
 nocase
 content:"Private Sub Class_Terminate"
 fast_pattern
 nocase
 content:"Join"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3206
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-069
 classtype:attempted-user
 sid:39211
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer drag and drop API remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.exe
 file_data
 content:"|FF 15 B8 31 01 10 85 C0 78 47 8B 4D F8 85 C9 74 6C 8D 55 F4 C7 45 F4 00 00 00 00 8B 01 52 68 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3211
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39208
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer drag and drop API remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.exe
 file_data
 content:"|FF 15 B8 31 01 10 85 C0 78 47 8B 4D F8 85 C9 74 6C 8D 55 F4 C7 45 F4 00 00 00 00 8B 01 52 68 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3211
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-063
 classtype:attempted-user
 sid:39207
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge PDF reader out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"/AuthEvent/DocOpen/CFM/AES"
 content:"/Length "
 within:10
 pcre:"/\\/AuthEvent\\/DocOpen\\/CFM\\/AES\\w+\\/Length\\s\\d{5,}[>]{4}(\\/\\w+){2}\\/Length\\s\\d{3}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39206
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge PDF reader out of bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.pdf
 file_data
 content:"/AuthEvent/DocOpen/CFM/AES"
 content:"/Length "
 within:10
 pcre:"/\\/AuthEvent\\/DocOpen\\/CFM\\/AES\\w+\\/Length\\s\\d{5,}[>]{4}(\\/\\w+){2}\\/Length\\s\\d{3}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3203
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39205
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer vbscript csession close use after free attempt"
 flow:to_server,established
 file_data
 content:"<script"
 content:"vbscript"
 within:200
 nocase
 content:"class "
 within:500
 nocase
 content:"private sub class_terminate"
 within:200
 nocase
 content:"execute"
 within:500
 nocase
 content:"redim"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3205
 classtype:attempted-user
 sid:39202
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer vbscript csession close use after free attempt"
 flow:to_client,established
 file_data
 content:"<script"
 content:"vbscript"
 within:200
 nocase
 content:"class "
 within:500
 nocase
 content:"private sub class_terminate"
 within:200
 nocase
 content:"execute"
 within:500
 nocase
 content:"redim"
 within:20
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3205
 classtype:attempted-user
 sid:39201
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge class object confusion attempt"
 flow:to_server,established
 file_data
 content:"Symbol.species"
 fast_pattern:only
 content:"extends Uint32Array"
 nocase
 content:".map"
 nocase
 content:"function"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3199
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39200
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge class object confusion attempt"
 flow:to_client,established
 file_data
 content:"Symbol.species"
 fast_pattern:only
 content:"extends Uint32Array"
 nocase
 content:".map"
 nocase
 content:"function"
 within:30
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3199
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-068
 classtype:attempted-user
 sid:39199
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer textTransform out-of-bounds memory access attempt"
 flow:to_server,established
 file_data
 content:".style"
 content:"textTransform"
 within:20
 fast_pattern
 content:"cloneNode"
 within:100
 content:"appendChild"
 within:75
 content:"document.all"
 within:300
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3261
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:39515
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer textTransform out-of-bounds memory access attempt"
 flow:to_client,established
 file_data
 content:".style"
 content:"textTransform"
 within:20
 fast_pattern
 content:"cloneNode"
 within:100
 content:"appendChild"
 within:75
 content:"document.all"
 within:300
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3261
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:39514
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge ArrayBuffer.transfer information disclosure attempt"
 flow:to_server,established
 file_data
 content:"ArrayBuffer"
 nocase
 content:"ArrayBuffer.transfer"
 within:250
 nocase
 content:".toString"
 within:250
 nocase
 pcre:"/(?P<var>\\w+)\\s*=\\s*new\\s*(U?Int|Float)(8|16|32)Array\\s*\\x28.*?(?P=var)\\x5b\\w+\\x5d\\.toString/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3271
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-085
 classtype:attempted-recon
 sid:39507
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge ArrayBuffer.transfer information disclosure attempt"
 flow:to_client,established
 file_data
 content:"ArrayBuffer"
 nocase
 content:"ArrayBuffer.transfer"
 within:250
 nocase
 content:".toString"
 within:250
 nocase
 pcre:"/(?P<var>\\w+)\\s*=\\s*new\\s*(U?Int|Float)(8|16|32)Array\\s*\\x28.*?(?P=var)\\x5b\\w+\\x5d\\.toString/si"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3271
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-085
 classtype:attempted-recon
 sid:39506
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Edge text node table-cell use after free attempt"
 flow:to_client,established
 content:"charset=UTF-16"
 fast_pattern:only
 http_header
 file_data
 content:".createTextNode("
 content:".splitText("
 within:100
 content:".style.display"
 within:100
 content:"table-cell"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3244
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-085
 classtype:attempted-user
 sid:39505
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll invalid resize use after free attempt"
 flow:to_server,established
 file_data
 content:".onpropertychange"
 nocase
 content:".onresize"
 within:300
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:".selectionStart"
 within:300
 nocase
 content:".size"
 within:300
 nocase
 content:".value"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3243
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39500
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll invalid resize use after free attempt"
 flow:to_client,established
 file_data
 content:".onpropertychange"
 nocase
 content:".onresize"
 within:300
 nocase
 content:".selectAllChildren"
 within:100
 nocase
 content:".selectionStart"
 within:300
 nocase
 content:".size"
 within:300
 nocase
 content:".value"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3243
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39499
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer header tag HTML injection remote code execution attempt"
 flow:to_server,established
 file_data
 content:"<h1>"
 nocase
 isdataat:100,relative
 content:!"h1"
 within:100
 nocase
 content:"&lt"
 within:50
 nocase
 content:"&gt"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service smtp
 reference:cve,2016-3276
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:39498
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer header tag HTML injection remote code execution attempt"
 flow:to_client,established
 file_data
 content:"<h1>"
 nocase
 isdataat:100,relative
 content:!"h1"
 within:100
 nocase
 content:"&lt"
 within:50
 nocase
 content:"&gt"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3276
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-084
 classtype:attempted-user
 sid:39497
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge edgehtml negative length out of bound memory copy attempt"
 flow:to_server,established
 file_data
 content:"revealTrans("
 fast_pattern:only
 content:"innerText"
 nocase
 content:"setAttributeNode("
 nocase
 content:"setAttribute("
 nocase
 content:"dataset["
 nocase
 content:"columnCount"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service smtp
 reference:cve,2016-3246
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-085
 classtype:attempted-user
 sid:39494
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge edgehtml negative length out of bound memory copy attempt"
 flow:to_client,established
 file_data
 content:"revealTrans("
 fast_pattern:only
 content:"innerText"
 nocase
 content:"setAttributeNode("
 nocase
 content:"setAttribute("
 nocase
 content:"dataset["
 nocase
 content:"columnCount"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3246
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-085
 classtype:attempted-user
 sid:39493
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer Dxtrans table element use after free attempt"
 flow:to_server,established
 file_data
 content:"DXImageTransform.Microsoft.Blur"
 nocase
 content:".removeNode"
 nocase
 content:"DXImageTransform.Microsoft.RevealTrans"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3240
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39492
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer Dxtrans table element use after free attempt"
 flow:to_client,established
 file_data
 content:"DXImageTransform.Microsoft.Blur"
 nocase
 content:".removeNode"
 nocase
 content:"DXImageTransform.Microsoft.RevealTrans"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3240
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39491
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge chakra.dll invalid pointer access attempt"
 flow:to_server,established
 file_data
 content:"new RegExp()"
 content:"new Array("
 within:40
 content:".unshift("
 within:40
 content:"__defineGetter__("
 within:40
 content:".unshift("
 within:40
 content:".sort()"
 within:40
 content:".indexOf()"
 within:40
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3259
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39487
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge chakra.dll invalid pointer access attempt"
 flow:to_client,established
 file_data
 content:"new RegExp()"
 content:"new Array("
 within:40
 content:".unshift("
 within:40
 content:"__defineGetter__("
 within:40
 content:".unshift("
 within:40
 content:".sort()"
 within:40
 content:".indexOf()"
 within:40
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2016-3259
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39486
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge clientInformation.geolocation.getCurrentPosition use-after-free attempt"
 flow:to_server,established
 file_data
 content:"function"
 nocase
 content:"geolocation.getCurrentPosition("
 distance:0
 nocase
 content:"function"
 within:30
 nocase
 content:"location.replace"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3264
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39531
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge clientInformation.geolocation.getCurrentPosition use-after-free attempt"
 flow:to_client,established
 file_data
 content:"function"
 nocase
 content:"geolocation.getCurrentPosition("
 distance:0
 nocase
 content:"function"
 within:30
 nocase
 content:"location.replace"
 within:200
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3264
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-084
 classtype:attempted-user
 sid:39530
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer VBScript toString redim array use after free attempt"
 flow:to_server, established
 file_data
 content:"valueOf"
 nocase
 content:"function"
 within:20
 nocase
 content:"<script"
 nocase
 content:"vbscript"
 within:60
 fast_pattern
 nocase
 content:"redim"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0189
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-051
 classtype:attempted-user
 sid:39681
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer VBScript toString redim array use after free attempt"
 flow:to_client, established
 file_data
 content:"valueOf"
 nocase
 content:"function"
 within:20
 nocase
 content:"<script"
 nocase
 content:"vbscript"
 within:60
 fast_pattern
 nocase
 content:"redim"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0189
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-051
 classtype:attempted-user
 sid:39680
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_server,established
 file_data
 content:"<t:ANIMATECOLOR"
 fast_pattern:only
 content:"document.getElement"
 nocase
 content:".outerText"
 within:50
 nocase
 content:"document.getElement"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:39764
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer use after free attempt"
 flow:to_client,established
 file_data
 content:"<t:ANIMATECOLOR"
 fast_pattern:only
 content:"document.getElement"
 nocase
 content:".outerText"
 within:50
 nocase
 content:"document.getElement"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3163
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-055
 classtype:attempted-user
 sid:39763
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows Internet Explorer MSHTML.dll type confusion attempt"
 flow:to_server,established
 file_data
 content:"styleSheets["
 content:"ms-text-combine-horizontal"
 within:150
 content:"digits"
 within:15
 content:"ms-block-progression"
 within:150
 content:"insertAdjacentText"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3290
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 classtype:attempted-user
 sid:39840
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Internet Explorer MSHTML.dll type confusion attempt"
 flow:to_client,established
 file_data
 content:"styleSheets["
 content:"ms-text-combine-horizontal"
 within:150
 content:"digits"
 within:15
 content:"ms-block-progression"
 within:150
 content:"insertAdjacentText"
 within:100
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3290
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 classtype:attempted-user
 sid:39839
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer InsertSelectDropdown use after free attempt"
 flow:to_server,established
 file_data
 content:".insertAdjacentElement"
 nocase
 content:".onactivate"
 nocase
 content:".onresize"
 nocase
 content:".selectAllChildren"
 nocase
 content:"execCommand"
 nocase
 content:"InsertSelectDropdown"
 within:50
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3289
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-096
 classtype:attempted-user
 sid:39834
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer InsertSelectDropdown use after free attempt"
 flow:to_client,established
 file_data
 content:".insertAdjacentElement"
 nocase
 content:".onactivate"
 nocase
 content:".onresize"
 nocase
 content:".selectAllChildren"
 nocase
 content:"execCommand"
 nocase
 content:"InsertSelectDropdown"
 within:50
 fast_pattern
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3289
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-096
 classtype:attempted-user
 sid:39833
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll cached object use after free attempt"
 flow:to_server,established
 file_data
 content:"addEventListener("
 content:"DOMCharacterDataModified"
 within:50
 fast_pattern
 content:"createElement("
 within:200
 content:"figure"
 within:10
 content:"createElement("
 within:200
 content:"INPUT"
 within:10
 content:".insertAdjacentElement("
 within:200
 content:"afterBegin"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3322
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 classtype:attempted-user
 sid:39829
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer mshtml.dll cached object use after free attempt"
 flow:to_client,established
 file_data
 content:"addEventListener("
 content:"DOMCharacterDataModified"
 within:50
 fast_pattern
 content:"createElement("
 within:200
 content:"figure"
 within:10
 content:"createElement("
 within:200
 content:"INPUT"
 within:10
 content:".insertAdjacentElement("
 within:200
 content:"afterBegin"
 within:20
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3322
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 classtype:attempted-user
 sid:39828
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer CStr internal string use-after-free attempt"
 flow:to_server,established
 file_data
 content:"window.location.href"
 nocase
 content:"="
 within:10
 content:"window.location.href"
 within:40
 nocase
 content:"<script"
 distance:0
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3326
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 classtype:attempted-user
 sid:39827
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer CStr internal string use-after-free attempt"
 flow:to_client,established
 file_data
 content:"window.location.href"
 nocase
 content:"="
 within:10
 content:"window.location.href"
 within:40
 nocase
 content:"<script"
 distance:0
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 content:"<script"
 within:100
 nocase
 content:"src"
 within:40
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3326
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-095
 classtype:attempted-user
 sid:39826
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge edgehtml.dll invalid history state use after free attempt"
 flow:to_server,established
 file_data
 content:".onbeforeunload"
 nocase
 content:".pushState"
 within:300
 fast_pattern
 nocase
 content:".location"
 within:300
 nocase
 content:"href"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3293
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-096
 classtype:attempted-user
 sid:39823
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge edgehtml.dll invalid history state use after free attempt"
 flow:to_client,established
 file_data
 content:".onbeforeunload"
 nocase
 content:".pushState"
 within:300
 fast_pattern
 nocase
 content:".location"
 within:300
 nocase
 content:"href"
 within:15
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3293
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-096
 classtype:attempted-user
 sid:39822
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer page layout use after free attempt"
 flow:to_server,established
 file_data
 content:"FileReader"
 nocase
 content:"Blob"
 within:100
 nocase
 content:"readAsDataURL"
 fast_pattern:only
 content:"CollectGarbage"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3288
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 classtype:attempted-user
 sid:39813
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer page layout use after free attempt"
 flow:to_client,established
 file_data
 content:"FileReader"
 nocase
 content:"Blob"
 within:100
 nocase
 content:"readAsDataURL"
 fast_pattern:only
 content:"CollectGarbage"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3288
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 classtype:attempted-user
 sid:39812
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iertutil.dll long UNC redirect out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|5D 09 5D 0A D2 4A 0A 01 2C 17 4F 09 02 47 00 00 02 03 02 0A 0C 93 01 D0 30 57 2A D5 30 65 01 20|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3327
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-096
 classtype:attempted-user
 sid:39811
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iertutil.dll long UNC redirect out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|5D 09 5D 0A D2 4A 0A 01 2C 17 4F 09 02 47 00 00 02 03 02 0A 0C 93 01 D0 30 57 2A D5 30 65 01 20|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3327
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-095
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-096
 classtype:attempted-user
 sid:39810
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer MSXML IDispatch use after free attempt"
 flow:to_server,established
 file_data
 content:"Msxml2.XSLTemplate"
 fast_pattern:only
 content:"Msxml2.FreeThreadedDOMDocument"
 nocase
 content:"vbscript"
 nocase
 content:".stylesheet"
 nocase
 content:".createProcessor"
 nocase
 content:".addParameter"
 nocase
 content:"Nothing"
 nocase
 pcre:"/String[\\x28\\s]+(\\x26[oh])?[a-f0-9]{5}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 classtype:attempted-user
 sid:40150
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer MSXML IDispatch use after free attempt"
 flow:to_client,established
 file_data
 content:"Msxml2.XSLTemplate"
 fast_pattern:only
 content:"Msxml2.FreeThreadedDOMDocument"
 nocase
 content:"vbscript"
 nocase
 content:".stylesheet"
 nocase
 content:".createProcessor"
 nocase
 content:".addParameter"
 nocase
 content:"Nothing"
 nocase
 pcre:"/String[\\x28\\s]+(\\x26[oh])?[a-f0-9]{5}/i"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 classtype:attempted-user
 sid:40149
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.createElement"
 nocase
 content:"caption"
 within:15
 content:".outerHTML"
 within:50
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40141
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_server,established
 file_data
 content:"document.createElement"
 nocase
 content:"caption"
 within:15
 content:".innerHTML"
 within:50
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40140
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<caption"
 fast_pattern:only
 content:".outerHTML"
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40139
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_server,established
 file_data
 content:"<caption"
 fast_pattern:only
 content:".innerHTML"
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40138
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.createElement"
 nocase
 content:"caption"
 within:15
 content:".outerHTML"
 within:50
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-user
 sid:40137
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_client,established
 file_data
 content:"document.createElement"
 nocase
 content:"caption"
 within:15
 content:".innerHTML"
 within:50
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-user
 sid:40136
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<caption"
 fast_pattern:only
 content:".outerHTML"
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-user
 sid:40135
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE  Microsoft Edge HTML normalize caption memory corruption attempt"
 flow:to_client,established
 file_data
 content:"<caption"
 fast_pattern:only
 content:".innerHTML"
 nocase
 content:"<!DOCTYPE>"
 within:20
 nocase
 content:".normalize()"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3295
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-user
 sid:40134
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE VBScript ADODB.Connection object use after free attempt"
 flow:to_server,established
 file_data
 content:"ADODB.Connection"
 fast_pattern:only
 content:"vbscript"
 nocase
 content:".Open"
 distance:0
 nocase
 content:"Property Get"
 content:"Set"
 within:50
 content:"="
 within:10
 content:"Nothing"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3375
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104
 classtype:attempted-user
 sid:40133
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE VBScript ADODB.Connection object use after free attempt"
 flow:to_client,established
 file_data
 content:"ADODB.Connection"
 fast_pattern:only
 content:"vbscript"
 nocase
 content:".Open"
 distance:0
 nocase
 content:"Property Get"
 content:"Set"
 within:50
 content:"="
 within:10
 content:"Nothing"
 within:10
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3375
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104
 classtype:attempted-user
 sid:40132
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge edgehtml.dll normalize missing div child use after free attempt"
 flow:to_server,established
 file_data
 content:".removeChild"
 nocase
 content:".setActive"
 within:100
 nocase
 content:".normalize"
 within:200
 nocase
 content:"<div"
 nocase
 content:"contentEditable"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3294
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40124
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge edgehtml.dll normalize missing div child use after free attempt"
 flow:to_client,established
 file_data
 content:".removeChild"
 nocase
 content:".setActive"
 within:100
 nocase
 content:".normalize"
 within:200
 nocase
 content:"<div"
 nocase
 content:"contentEditable"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3294
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40123
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer font element out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"<FONT"
 fast_pattern:only
 content:".setAttributeNode"
 nocase
 content:".createAttribute"
 nocase
 content:"lang"
 within:25
 nocase
 content:".setAttribute"
 nocase
 content:"lang"
 within:25
 nocase
 content:".nodeValue"
 nocase
 content:"null"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3297
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-recon
 sid:40109
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer font element out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"<FONT"
 fast_pattern:only
 content:".setAttributeNode"
 nocase
 content:".createAttribute"
 nocase
 content:"lang"
 within:25
 nocase
 content:".setAttribute"
 nocase
 content:"lang"
 within:25
 nocase
 content:".nodeValue"
 nocase
 content:"null"
 within:25
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3297
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-104
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-105
 classtype:attempted-recon
 sid:40108
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge proxy object type confusion attempt"
 flow:to_server,established
 file_data
 content:"Symbol.species"
 fast_pattern:only
 content:"new Proxy("
 content:"Array.prototype.map.apply("
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3377
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40099
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge proxy object type confusion attempt"
 flow:to_client,established
 file_data
 content:"Symbol.species"
 fast_pattern:only
 content:"new Proxy("
 content:"Array.prototype.map.apply("
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3377
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-105
 classtype:attempted-user
 sid:40098
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer CTreePos type confusion attempt"
 flow:to_client,established
 file_data
 content:"%2A%3A%3Abefore"
 fast_pattern
 content:"position%3A|20|fixed"
 within:50
 content:"counter%28"
 within:50
 content:"url%28"
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0108
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-023
 classtype:attempted-user
 sid:40312
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows Edge function.apply use afterfree attempt"
 flow:to_server,established
 file_data
 content:"defineProperty"
 nocase
 content:"get|3A|"
 within:30
 nocase
 content:"function"
 within:20
 nocase
 content:"fill.call"
 within:75
 fast_pattern
 nocase
 content:"__proto__"
 nocase
 content:"apply"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-7194
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40424
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Edge function.apply use afterfree attempt"
 flow:to_client,established
 file_data
 content:"defineProperty"
 nocase
 content:"get|3A|"
 within:30
 nocase
 content:"function"
 within:20
 nocase
 content:"fill.call"
 within:75
 fast_pattern
 nocase
 content:"__proto__"
 nocase
 content:"apply"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-7194
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40423
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer readyState property information disclosure attempt"
 flow:to_server,established
 file_data
 content:"onreadystatechange"
 nocase
 content:"readyState"
 nocase
 content:"res://c:|5C|"
 fast_pattern:only
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3267
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40421
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer readyState property information disclosure attempt"
 flow:to_client,established
 file_data
 content:"onreadystatechange"
 nocase
 content:"readyState"
 nocase
 content:"res://c:|5C|"
 fast_pattern:only
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3267
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40420
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer vbscript variable type confusion attempt"
 flow:to_server,established
 file_data
 content:"<script"
 content:"javascript"
 within:100
 content:"<script"
 content:"vbscript"
 within:100
 fast_pattern
 content:"document.write"
 within:500
 content:"Join("
 within:20
 content:"&h"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3385
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-118
 classtype:attempted-user
 sid:40386
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer vbscript variable type confusion attempt"
 flow:to_client,established
 file_data
 content:"<script"
 content:"javascript"
 within:100
 content:"<script"
 content:"vbscript"
 within:100
 fast_pattern
 content:"document.write"
 within:500
 content:"Join("
 within:20
 content:"&h"
 within:500
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3385
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-118
 classtype:attempted-user
 sid:40385
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge array.join information disclosure attempt"
 flow:to_server,established
 file_data
 content:"Array("
 nocase
 content:!")"
 within:1
 content:"__proto__"
 within:250
 nocase
 content:"join"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-7189
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40384
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge array.join information disclosure attempt"
 flow:to_client,established
 file_data
 content:"Array("
 nocase
 content:!")"
 within:1
 content:"__proto__"
 within:250
 nocase
 content:"join"
 within:50
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-7189
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40383
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer iframe type confusion attempt"
 flow:to_server,established
 file_data
 content:"setTimeout"
 content:"<iframe"
 content:".removeNode()"
 content:".insertAdjacentText("
 within:100
 fast_pattern
 content:".insertAdjacentElement("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3383
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-118
 classtype:attempted-user
 sid:40379
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer iframe type confusion attempt"
 flow:to_client,established
 file_data
 content:"setTimeout"
 content:"<iframe"
 content:".removeNode()"
 content:".insertAdjacentText("
 within:100
 fast_pattern
 content:".insertAdjacentElement("
 within:100
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3383
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-118
 classtype:attempted-user
 sid:40378
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Windows Edge emodel use after free attempt"
 flow:to_server,established
 file_data
 content:"createElement"
 nocase
 content:"div"
 within:15
 nocase
 content:"CollectGarbage"
 within:50
 fast_pattern
 nocase
 content:"addEventListener"
 nocase
 content:"event.target"
 within:400
 nocase
 content:"document.all"
 within:30
 nocase
 content:"setActive"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3331
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-118
 classtype:attempted-user
 sid:40373
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Windows Edge emodel use after free attempt"
 flow:to_client,established
 file_data
 content:"createElement"
 nocase
 content:"div"
 within:15
 nocase
 content:"CollectGarbage"
 within:50
 fast_pattern
 nocase
 content:"addEventListener"
 nocase
 content:"event.target"
 within:400
 nocase
 content:"document.all"
 within:30
 nocase
 content:"setActive"
 distance:0
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3331
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-118
 classtype:attempted-user
 sid:40372
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Edge spread operator memory corruption attempt"
 flow:to_server,established
 file_data
 content:"defineProperty"
 nocase
 content:"Array.prototype"
 within:40
 nocase
 content:"get:"
 within:30
 nocase
 content:"function"
 within:20
 nocase
 content:"length"
 within:50
 nocase
 content:"..."
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3386
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40371
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Edge spread operator memory corruption attempt"
 flow:to_client,established
 file_data
 content:"defineProperty"
 nocase
 content:"Array.prototype"
 within:40
 nocase
 content:"get:"
 within:30
 nocase
 content:"function"
 within:20
 nocase
 content:"length"
 within:50
 nocase
 content:"..."
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3386
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40370
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"BROWSER-IE Microsoft Internet Explorer ArraySpeciesCreate type confusion attempt"
 flow:to_server,established
 file_data
 content:"Array"
 nocase
 content:"Symbol.species"
 within:250
 nocase
 content:"Proxy"
 within:250
 nocase
 content:"map.call"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-7190
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40367
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"BROWSER-IE Microsoft Internet Explorer ArraySpeciesCreate type confusion attempt"
 flow:to_client,established
 file_data
 content:"Array"
 nocase
 content:"Symbol.species"
 within:250
 nocase
 content:"Proxy"
 within:250
 nocase
 content:"map.call"
 within:250
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-7190
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-119
 classtype:attempted-user
 sid:40366
 rev:1
)\n']
