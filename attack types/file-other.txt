['alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ESTsoft ALZip MIM file buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.mime
 file_data
 content:"Content-Type"
 fast_pattern:only
 content:"name"
 nocase
 content:"="
 within:5
 isdataat:300,relative
 content:!"|3B|"
 within:300
 content:!"|0A|"
 within:302
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2011-1336
 reference:url,osvdb.org/show/osvdb/73684
 classtype:attempted-user
 sid:24083
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER MSXML dynamic pointer casting arbitrary code execution attempt"
 flow:to_client,established
 file_data
 content:"//doesnotexist[position|28 29| != 3]"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0007
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002
 classtype:attempted-user
 sid:25275
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER overly large XML file MSXML heap overflow attempt"
 flow:to_client,established
 content:"Content-Length: 900000000"
 fast_pattern:only
 content:"<?xml version=|22|1.0|22|?>|0A|<catalog>"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0006
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002
 classtype:attempted-user
 sid:25270
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Known malicious jar archive download attempt"
 flow:to_client,established
 flowbits:isset,file.jar
 file_data
 content:"ImAlpha$MyColorSpace.classPK"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http
 reference:bugtraq,58238
 reference:cve,2013-1493
 classtype:attempted-admin
 sid:26030
 rev:3
)\n', 'alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"FILE-OTHER Watering Hole Campaign applet download"
 flow:established,to_server
 content:"/AppletHigh.jar"
 fast_pattern:only
 http_uri
 metadata:policy balanced-ips drop, policy connectivity-ips drop, policy max-detect-ips drop, policy security-ips drop, service http
 reference:cve,2013-0422
 classtype:trojan-activity
 sid:26294
 rev:5
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|F7 1B DF 30 61 61 0D 8B 86 8A 85 8B 85 08 F7 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3128
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082
 classtype:denial-of-service
 sid:28203
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|F7 1B DF 30 61 61 0D 8B 86 8A 85 8B 85 08 F7 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3128
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082
 classtype:denial-of-service
 sid:28202
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER overly large XML file MSXML heap overflow attempt"
 flow:to_client,established
 content:"var doc = new ActiveXObject(\'Msxml2.DOMDocument\')|3B|"
 fast_pattern:only
 content:"while (longstr.length < 0x40000000) {"
 metadata:policy balanced-ips drop, policy security-ips drop, service http
 reference:cve,2013-0006
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-002
 classtype:attempted-user
 sid:28286
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_server,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"
 within:rowLength
 byte_test:2,>,32,0,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:28503
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_client,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"
 within:rowLength
 byte_test:2,>,32,0,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:28502
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_server,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"
 within:rowLength
 byte_test:2,>,32,2,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1325
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:28499
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_client,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 88 00 00 00 00 00 00 00 00 03 00 00 88|"
 within:rowLength
 byte_test:2,>,32,2,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1325
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:28498
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat Reader FDF submitForm cross-site scripting attempt"
 flow:to_server,established
 flowbits:isset,file.fdf
 file_data
 content:"/JavaScript"
 nocase
 content:"submitForm"
 distance:0
 fast_pattern
 nocase
 content:"|3A|//"
 within:15
 content:"|23|FDF"
 within:100
 nocase
 pcre:"/\\x2fF(?i)\\s*?\\(\\s*?http\\x3a\\x2f\\x2f(?P<domain>[^\\x2f]+)\\x2f[^\\x29]*?\\x2epdf[^>]*?submitForm\\s*?\\(\\s*?[\\x22\\x27]?\\s*?http\\x3a\\x2f\\x2f(?!(?P=domain))[^\\x29]*?\\x2efdf\\x23FDF/"
 metadata:policy balanced-ips alert, policy security-ips alert, service smtp
 reference:bugtraq,62888
 reference:cve,2013-5325
 reference:url,osvdb.org/show/osvdb/98225
 reference:url,www.adobe.com/support/security/bulletins/apsb13-25.html
 classtype:misc-attack
 sid:28576
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat Reader FDF submitForm cross-site scripting attempt"
 flow:to_client,established
 flowbits:isset,file.fdf
 file_data
 content:"/JavaScript"
 nocase
 content:"submitForm"
 distance:0
 fast_pattern
 nocase
 content:"|3A|//"
 within:15
 content:"|23|FDF"
 within:100
 nocase
 pcre:"/\\x2fF(?i)\\s*?\\(\\s*?http\\x3a\\x2f\\x2f(?P<domain>[^\\x2f]+)\\x2f[^\\x29]*?\\x2epdf[^>]*?submitForm\\s*?\\(\\s*?[\\x22\\x27]?\\s*?http\\x3a\\x2f\\x2f(?!(?P=domain))[^\\x29]*?\\x2efdf\\x23FDF/"
 metadata:policy balanced-ips alert, policy security-ips alert, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,62888
 reference:cve,2013-5325
 reference:url,osvdb.org/show/osvdb/98225
 reference:url,www.adobe.com/support/security/bulletins/apsb13-25.html
 classtype:misc-attack
 sid:28575
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.rmp
 file_data
 content:"version="
 isdataat:1024,relative
 pcre:"/version\\x3D[\\x22\\x27][^\\x22\\x27]{1024}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29185
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.rmp
 file_data
 content:"encoding="
 isdataat:1024,relative
 pcre:"/encoding\\x3D[\\x22\\x27][^\\x22\\x27]{1024}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29184
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rmp
 file_data
 content:"version="
 isdataat:1024,relative
 pcre:"/version\\x3D[\\x22\\x27][^\\x22\\x27]{1024}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29183
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP stack buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rmp
 file_data
 content:"encoding="
 isdataat:1024,relative
 pcre:"/encoding\\x3D[\\x22\\x27][^\\x22\\x27]{1024}/"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29182
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_server, established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 content:"|25|fid"
 distance:0
 content:"|3C 2F|LOCATION|3E|"
 distance:0
 content:"|3C|TRACKID|3E|"
 isdataat:255,relative
 content:!"|3C 2F|TRACKID|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29212
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_server, established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 content:"|25|f"
 distance:0
 content:!"id"
 within:2
 content:"|3C 2F|LOCATION|3E|"
 distance:0
 content:"|3C|FILENAME|3E|"
 isdataat:255,relative
 content:!"|3C 2F|FILENAME|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29211
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 isdataat:255,relative
 content:!"|3C 2F|LOCATION|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29210
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 content:"|25|fid"
 distance:0
 content:"|3C 2F|LOCATION|3E|"
 distance:0
 content:"|3C|TRACKID|3E|"
 isdataat:255,relative
 content:!"|3C 2F|TRACKID|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29209
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 content:"|25|f"
 distance:0
 content:!"id"
 within:2
 content:"|3C 2F|LOCATION|3E|"
 distance:0
 content:"|3C|FILENAME|3E|"
 isdataat:255,relative
 content:!"|3C 2F|FILENAME|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29208
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RealNetworks RealPlayer RMP file heap buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.rmp
 file_data
 content:"|3C|ACTION|3E|"
 content:"import"
 distance:0
 content:"|3C 2F|ACTION|3E|"
 distance:0
 content:"|3C|TRACK|3E|"
 content:"|3C|LOCATION|3E|"
 isdataat:255,relative
 content:!"|3C 2F|LOCATION|3E|"
 within:255
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,64398
 reference:cve,2013-6877
 reference:url,osvdb.org/show/osvdb/101356
 classtype:attempted-admin
 sid:29207
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $HOME_NET $FTP_PORTS (msg:"FILE-OTHER ftpchk3.php malicious script upload attempt"
 flow:to_server,established
 content:"STOR ftpchk3.php"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp
 reference:url,www.jexanalytics.com/2012/02/wordpress-sites-all-hacked
 classtype:trojan-activity
 sid:30101
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $HOME_NET 20 (msg:"FILE-OTHER ftpchk3.php malicious script upload attempt"
 flow:to_client,established
 content:"function detect_cms()"
 content:"array(\'JFactory::\', \'Joomla!\'),"
 fast_pattern:only
 content:"array(\'wp-blog-header.php\', \'Wordpress\'),"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp
 reference:url,www.jexanalytics.com/2012/02/wordpress-sites-all-hacked
 classtype:trojan-activity
 sid:30100
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|19 B3 FA 00 A4 1F 8C 8C 0D 0E FC 0B FB 28 15 5E 0A 13 2C 5F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-3128
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082
 classtype:denial-of-service
 sid:30241
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER ATMFD Adobe font driver reserved command denial of service attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|19 B3 FA 00 A4 1F 8C 8C 0D 0E FC 0B FB 28 15 5E 0A 13 2C 5F|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-3128
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-082
 classtype:denial-of-service
 sid:30240
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|50 4B 03 04|"
 depth:4
 content:"|00 00|"
 within:2
 distance:24
 content:".exe"
 within:64
 flowbits:set,file.zip.winrar.spoof
 flowbits:noalert
 metadata:service smtp
 reference:bugtraq,66383
 reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html
 classtype:attempted-user
 sid:30909
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER RARLAB WinRAR ZIP format filename spoof attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|50 4B 03 04|"
 depth:4
 content:"|00 00|"
 within:2
 distance:24
 content:".exe"
 within:64
 flowbits:set,file.zip.winrar.spoof
 flowbits:noalert
 metadata:service ftp-data, service http, service imap, service pop3
 reference:bugtraq,66383
 reference:url,an7isec.blogspot.co.il/2014/03/winrar-file-extension-spoofing-0day.html
 classtype:attempted-user
 sid:30906
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Wireshark MPEG dissector stack buffer overflow attempt"
 flow:to_server,established
 file_data
 content:"|2A 3C 86 61 7C 02 D9 62 69 09 97 61 F6 8C 98 61 2A 0A 9C 61 98 1E 84 61 1A D1 91 61 01 02 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,66066
 reference:cve,2014-2299
 reference:url,osvdb.org/show/osvdb/104199
 classtype:attempted-user
 sid:31987
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Wireshark MPEG dissector stack buffer overflow attempt"
 flow:to_client,established
 file_data
 content:"|2A 3C 86 61 7C 02 D9 62 69 09 97 61 F6 8C 98 61 2A 0A 9C 61 98 1E 84 61 1A D1 91 61 01 02 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,66066
 reference:cve,2014-2299
 reference:url,osvdb.org/show/osvdb/104199
 classtype:attempted-user
 sid:31986
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Internet Explorer SVG heap corruption attempt"
 flow:to_server,established
 flowbits:isset,file.svg
 file_data
 content:"execCommand"
 content:"SelectAll"
 within:11
 content:"execCommand"
 distance:0
 content:"Copy"
 within:6
 content:"execCommand"
 distance:0
 content:"Paste"
 within:7
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4138
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32167
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Internet Explorer SVG heap corruption attempt"
 flow:to_client,established
 flowbits:isset,file.svg
 file_data
 content:"execCommand"
 content:"SelectAll"
 within:11
 content:"execCommand"
 distance:0
 content:"Copy"
 within:6
 content:"execCommand"
 distance:0
 content:"Paste"
 within:7
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4138
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-056
 classtype:attempted-user
 sid:32166
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"ppt/embeddings/"
 content:"ppt/embeddings/"
 distance:0
 content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"
 within:50
 content:"ppt/embeddings/"
 distance:0
 content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"
 within:50
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32187
 rev:4
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"ppt/embeddings/"
 content:"ppt/embeddings/"
 distance:0
 content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"
 within:50
 content:"ppt/embeddings/"
 distance:0
 content:"|75 FD 41 63 B2 CF 01 E3 02 89 60 63 B2 CF 01 E3|"
 within:50
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32186
 rev:4
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"
 flow:to_server,established
 flowbits:isset,file.ole
 file_data
 content:"|53 00 63 00 72 00 65 00 65 00 6E 00 4F 00 70 00 65 00 6E 00 44 00 69 00 73 00 70 00 61 00 74 00 63 00 68 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/
 classtype:attempted-admin
 sid:32258
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"
 flow:to_server,established
 flowbits:isset,file.ole
 file_data
 content:"|22 00 25 00 43 00 49 00 4D 00 50 00 41 00 54 00 48 00 25 00 5C 00 43 00 69 00 6D 00 43 00 4D 00 53 00 61 00 66 00 65 00 67 00 73 00 2E 00 65 00 78 00 65 00 22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/
 classtype:attempted-admin
 sid:32257
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity bcl file loading external file attempt"
 flow:to_client,established
 flowbits:isset,file.bcl
 file_data
 content:"|22|cmd /C start "
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:url,www.virustotal.com/en/file/c97edaa725602f9f349d0dac8b50f45cdec687eb15606f82d1fcdce193cfe02f/analysis/
 classtype:attempted-admin
 sid:32256
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"
 flow:to_client,established
 flowbits:isset,file.ole
 file_data
 content:"|53 00 63 00 72 00 65 00 65 00 6E 00 4F 00 70 00 65 00 6E 00 44 00 69 00 73 00 70 00 61 00 74 00 63 00 68 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/
 classtype:attempted-admin
 sid:32255
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GE Cimplicity CimView load remote file attempt"
 flow:to_client,established
 flowbits:isset,file.ole
 file_data
 content:"|22 00 25 00 43 00 49 00 4D 00 50 00 41 00 54 00 48 00 25 00 5C 00 43 00 69 00 6D 00 43 00 4D 00 53 00 61 00 66 00 65 00 67 00 73 00 2E 00 65 00 78 00 65 00 22|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:url,www.virustotal.com/en/file/71264a32c22e2778a1942bb8c7b0ee08a73ffdfab6b7cc890bc4598c1ee9bdf5/analysis/
 classtype:attempted-admin
 sid:32254
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 file_data
 content:"ppt/embeddings/"
 content:"PK|01 02|"
 distance:0
 content:"ppt/embeddings/"
 distance:0
 content:".bin"
 within:40
 content:"PK|01 02|"
 distance:0
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32316
 rev:2
)\n', 'alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 content:"PK|03 04|"
 content:"ppt/slides/_rels/"
 distance:0
 content:"|DF 05 BF 43 B8 77 93 B6 13 11 59 BA 97 21 0C 06|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32315
 rev:2
)\n', 'alert tcp $EXTERNAL_NET 445 -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 content:"PK|03 04|"
 content:"_rels/.rels"
 distance:0
 content:"|6F 64 FA C9 80 66 C2 14 5B A3 20 6D CD 15 88 F6|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32314
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 flowbits:isset,file.zip
 file_data
 content:"|09 00 03 9A D1 3E 54 BF C8 3E 54 55 78 04 00 ED 03 64 00 BB 70 5E F0 C1 C2 8D 52 0F 19 D0 80 1D|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:32313
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Oracle Java SE GSUB FeatureCount Buffer Overflow attempt"
 flow:to_server, established
 file_data
 content:"|01 74 61 6D 6C 00 08 00 04 00 00 00 00 FF FF 82 66 00 00 00 01 00 02 00 04 00 03 00 05 00 06 61|"
 fast_pattern:only
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service smtp
 reference:url,www.oracle.com/technetwork/topics/security/javacpuapr2013-1928497.html
 classtype:attempted-user
 sid:32509
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java SE GSUB FeatureCount Buffer Overflow attempt"
 flow:to_client, established
 file_data
 flowbits:isset,file.ttf
 content:"|01 74 61 6D 6C 00 08 00 04 00 00 00 00 FF FF 82 66 00 00 00 01 00 02 00 04 00 03 00 05 00 06 61|"
 fast_pattern:only
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:url,www.oracle.com/technetwork/topics/security/javacpuapr2013-1928497.html
 classtype:attempted-user
 sid:32508
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft XML invalid priority in xsl template"
 flow:to_server,established
 file_data
 content:"xsl|3A|template"
 content:"priority"
 within:100
 pcre:"/xsl\\x3Atemplate[^\\x3E]*priority\\s*\\x3D[\\s\\x22\\x27]*[\\d\\x2D]*[^\\s\\x22\\x27\\d\\x2d]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-067
 classtype:attempted-user
 sid:32502
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft XML invalid priority in xsl template"
 flow:to_client,established
 file_data
 content:"xsl|3A|template"
 content:"priority"
 within:100
 pcre:"/xsl\\x3Atemplate[^\\x3E]*priority\\s*\\x3D[\\s\\x22\\x27]*[\\d\\x2D]*[^\\s\\x22\\x27\\d\\x2d]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4118
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms14-067
 classtype:attempted-user
 sid:32501
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any (msg:"FILE-OTHER Oracle Java awt_setPixels out-of-bounds read attempt"
 flow:to_client, established
 file_data
 content:"|CA FE BA BE|"
 fast_pattern
 content:"|19 05 19 08 B6 00 10|"
 within:7
 distance:1103
 metadata:impact_flag red, policy balanced-ips drop, policy security-ips drop, service http
 reference:url,www.oracle.com/technetwork/topics/security/cpuapr2014-1972952.html#AppendixJAVA
 classtype:attempted-user
 sid:32562
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows XP .theme file remote code execution attempt"
 flow:to_server,established
 file_data
 content:"[Theme]"
 fast_pattern:only
 content:"SCRNSAVE.EXE="
 content:!"C|3A 5C|"
 within:3
 content:!"%"
 within:1
 content:!"|0D|"
 within:1
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-0010
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-071
 classtype:attempted-admin
 sid:32730
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Reader CoolType.DLL out-of-bounds memory access attempt"
 flow:to_server,established
 file_data
 file_data
 content:"|6A FB 8F 05 F0 06 DA F7 8F 05 0E 60 F9 6A 77 01 99 F7 25 03 F7 AD 4D 15 3A F5 62 F7 30 F7 18 1A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-9161
 reference:url,www.cvedetails.com/cve/CVE-2014-9161
 classtype:attempted-user
 sid:33455
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Reader CoolType.DLL out-of-bounds memory access attempt"
 flow:to_client,established
 file_data
 file_data
 content:"|6A FB 8F 05 F0 06 DA F7 8F 05 0E 60 F9 6A 77 01 99 F7 25 03 F7 AD 4D 15 3A F5 62 F7 30 F7 18 1A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-9161
 reference:url,www.cvedetails.com/cve/CVE-2014-9161
 classtype:attempted-user
 sid:33454
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Type 1 font blend operator negative operand code execution attempt"
 flow:to_server,established
 flowbits:isset,file.psfont
 file_data
 content:"|7C 93 40 4C DF 37 1D BC F1 DB DB 33 B8 83 32 71|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0093
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021
 classtype:attempted-user
 sid:33725
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Type 1 font blend operator negative operand code execution attempt"
 flow:to_client,established
 flowbits:isset,file.psfont
 file_data
 content:"|7C 93 40 4C DF 37 1D BC F1 DB DB 33 B8 83 32 71|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0093
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-021
 classtype:attempted-user
 sid:33724
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Type 1 font memory out-of-bounds read attempt"
 flow:to_server,established
 file_data
 content:"|5F E1 3D 20 49 DD DB 15 D7 26 E2 25 F5 C9 28 B2 CC FB 98 5F 8A 9C C3 B6 5C E4 A5 B4 27 7A 80 01 15 02 00 00 0A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-021
 classtype:attempted-user
 sid:33723
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Type 1 font memory out-of-bounds read attempt"
 flow:to_client,established
 file_data
 content:"|5F E1 3D 20 49 DD DB 15 D7 26 E2 25 F5 C9 28 B2 CC FB 98 5F 8A 9C C3 B6 5C E4 A5 B4 27 7A 80 01 15 02 00 00 0A|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0092
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-021
 classtype:attempted-user
 sid:33722
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office RTF out-of-bounds memory access attempt"
 flow:to_server,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|dppolyline|5C|dppolyline"
 content:"|5C|dppolycount"
 within:200
 content:"|5C|dptxbx|5C|dptxbx"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-0086
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022
 classtype:attempted-user
 sid:33706
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office RTF out-of-bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.rtf
 file_data
 content:"|5C|dppolyline|5C|dppolyline"
 content:"|5C|dppolycount"
 within:200
 content:"|5C|dptxbx|5C|dptxbx"
 within:200
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-0086
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-022
 classtype:attempted-user
 sid:33705
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|4E 42 2A 00 94 4C 00 00 01 01 00 FF FF 01 00 00 B0 09 00 00 B4 0D 00 00 2C 01 00 00 01 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1699
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34404
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|4E 42 2A 00 94 4C 00 00 01 01 00 FF FF 01 00 00 B0 09 00 00 B4 0D 00 00 2C 01 00 00 01 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1699
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34403
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal file exploitation attempt"
 flow:to_client,established
 file_data
 content:"|3B E0 EF 00 FC 9D 80 DF 8A EC 57 80 BF 00 00 00 01 BE 0F 48 CF 0B F8 FB 00 7F 3F FF 77 03 FE 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1675
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34400
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal file exploitation attempt"
 flow:to_server,established
 file_data
 content:"|3B E0 EF 00 FC 9D 80 DF 8A EC 57 80 BF 00 00 00 01 BE 0F 48 CF 0B F8 FB 00 7F 3F FF 77 03 FE 01|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1675
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34399
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"|30 00 00 00 FF FF FF FF 01 00 00 00 01 00 20 00 03 00 00 00 02 00 00 00 18 00 98 00 02 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1696
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34390
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"|30 00 00 00 FF FF FF FF 01 00 00 00 01 00 20 00 03 00 00 00 02 00 00 00 18 00 98 00 02 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1696
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34389
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal out of bounds write attempt"
 flow:to_server,established
 file_data
 content:"|80 69 C0 02 EC FD 18 28 0A 2B BB D8 3D 29 82 D5 98 34 BF 94 2E 75 1E F6 1D C5 BF 9C EB DF 5F C5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1695
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34388
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal out of bounds write attempt"
 flow:to_client,established
 file_data
 content:"|80 69 C0 02 EC FD 18 28 0A 2B BB D8 3D 29 82 D5 98 34 BF 94 2E 75 1E F6 1D C5 BF 9C EB DF 5F C5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1695
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34387
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|42 4C 43 52 20 00 65 00 00 00 EB 06 00 00 7F FF FF FF FF FE 1F FF FF FF FF FF FF FF FF C0 00 B5 41 5E E9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1697
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-045
 classtype:attempted-user
 sid:34386
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|42 4C 43 52 20 00 65 00 00 00 EB 06 00 00 7F FF FF FF FF FE 1F FF FF FF FF FF FF FF FF C0 00 B5 41 5E E9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1697
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-045
 classtype:attempted-user
 sid:34385
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|A2 22 72 5A 97 A1 21 28 FF FF FF FF 10 A0 84 8A A2 31 51 1A 32 0B 89 D4 49 41 2D 68 A2 40 92 B9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-1698
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34372
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|A2 22 72 5A 97 A1 21 28 FF FF FF FF 10 A0 84 8A A2 31 51 1A 32 0B 89 D4 49 41 2D 68 A2 40 92 B9|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-1698
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-045
 classtype:attempted-user
 sid:34371
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ole|file.doc
 file_data
 content:"|87 7A 00 20 00 00 00 80 08 00 00 00 00 00 00 00 FF 01 00 00 00 00 00 00|"
 isdataat:80,relative
 content:!"|00 00|"
 within:80
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,61796
 reference:cve,2013-3934
 classtype:attempted-user
 sid:30534
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ole|file.doc
 file_data
 content:"|87 7A 00 20 00 00 00 80 08 00 00 00 00 00 00 00 FF 01 00 00 00 00 00 00|"
 isdataat:512,relative
 content:!"|00 00|"
 within:512
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,61796
 reference:cve,2013-3934
 classtype:attempted-user
 sid:30533
 rev:5
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows XP .theme file remote code execution attempt"
 flow:to_client,established
 file_data
 content:"[Theme]"
 fast_pattern:only
 content:"SCRNSAVE.EXE="
 content:!"C|3A 5C|"
 within:3
 content:!"%"
 within:1
 content:!"|0D|"
 within:1
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-0810
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms13-071
 classtype:attempted-admin
 sid:27822
 rev:9
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player invalid mpd memory corruption attempt"
 flow:to_server,established
 file_data
 content:"urn|3A|mpeg|3A|dash|3A|schema|3A|mpd|3A|2011"
 fast_pattern:only
 content:"<Period "
 content:"start="
 content:"duration="
 pcre:"/start=[\\x22\\x27](?P<start>[A-Za-z0-9]+)[\\x22\\x27][^>]+duration=[\\x22\\x27](?P=start)[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-3089
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-admin
 sid:34519
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player invalid mpd memory corruption attempt"
 flow:to_client,established
 file_data
 content:"urn|3A|mpeg|3A|dash|3A|schema|3A|mpd|3A|2011"
 fast_pattern:only
 content:"<Period "
 content:"start="
 content:"duration="
 pcre:"/start=[\\x22\\x27](?P<start>[A-Za-z0-9]+)[\\x22\\x27][^>]+duration=[\\x22\\x27](?P=start)[\\x22\\x27]/smi"
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-3089
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-admin
 sid:34518
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player mp4 avcC atom memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.mp4
 file_data
 content:"|00 00 00 01|hvcC"
 byte_test:4,>,0x01000000,4,relative
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-3078
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-user
 sid:34513
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player mp4 avcC atom memory corruption attempt"
 flow:to_server,established
 flowbits:isset,file.mp4
 file_data
 content:"|00 00 00 01|avcC"
 byte_test:4,>,0x01000000,4,relative
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-3078
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-user
 sid:34512
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player mp4 avcC atom memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.mp4
 file_data
 content:"|00 00 00 01|hvcC"
 byte_test:4,>,0x01000000,4,relative
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-3078
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-user
 sid:34511
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player mp4 avcC atom memory corruption attempt"
 flow:to_client,established
 flowbits:isset,file.mp4
 file_data
 content:"|00 00 00 01|avcC"
 byte_test:4,>,0x01000000,4,relative
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-3078
 reference:url,helpx.adobe.com/security/products/flash-player/apsb15-09.html
 classtype:attempted-user
 sid:34510
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD kernel pool overflow attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|00 01 00 00|"
 byte_jump:2,4,relative, post_offset -10
 content:"|00 1A 00 36 00 3E 00 46 00 4E 00 56 00 5E 00 66 00 70|"
 within:18
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2426
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-078
 classtype:attempted-admin
 sid:35305
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD kernel pool overflow attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|00 01 00 00|"
 byte_jump:2,4,relative, post_offset -10
 content:"|00 1A 00 36 00 3E 00 46 00 4E 00 56 00 5E 00 66 00 70|"
 within:18
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2426
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-078
 classtype:attempted-admin
 sid:35304
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows kernel-mode driver TTF file glyf table out of bounds attempt"
 flow:to_server,established
 file_data
 content:"|75 70 70 7B 75 7B 75 25 00 00 00 10 00 9B 00 6C 09 0B 09 00 09 09 09 09 09 09 09 0B 07 07 07 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2464
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35520
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows kernel-mode driver TTF file glyf table out of bounds attempt"
 flow:to_client,established
 file_data
 content:"|75 70 70 7B 75 7B 75 25 00 00 00 10 00 9B 00 6C 09 0B 09 00 09 09 09 09 09 09 09 0B 07 07 07 07|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2464
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35519
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows FontView OpenType Font atmfd.dll invalid memory reference attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|4E 58 8B 08 58 8B 5F B8 8B E1 08 8B DF AE B6 C7 8B 08 0E F9 0A F7 17 F7 D5 15 EB 8B F7 12 72 8B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2461
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-admin
 sid:35518
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows FontView OpenType Font atmfd.dll invalid memory reference attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|4E 58 8B 08 58 8B 5F B8 8B E1 08 8B DF AE B6 C7 8B 08 0E F9 0A F7 17 F7 D5 15 EB 8B F7 12 72 8B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2461
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-admin
 sid:35517
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|E3 F7 0A 07 91 90 8E 8E 8E 89 8F 88 8F 1F 72 A8 83 93 6F A7 76 71 84 83 79 72 08 7A F2 06 8B AB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2459
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35496
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|E3 F7 0A 07 91 90 8E 8E 8E 89 8F 88 8F 1F 72 A8 83 93 6F A7 76 71 84 83 79 72 08 7A F2 06 8B AB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2459
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35495
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows GDI DrvQueryFontData function uninitialized glyph data remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.ttf
 file_data
 content:"|F7 15 19 27 58 41 14 16 16 27 37 22 19 01 0A 0D 22 15 63 17 24 1A 0E 1E 1A 2B 63 16 23|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2435
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-user
 sid:35492
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows GDI DrvQueryFontData function uninitialized glyph data remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.ttf
 file_data
 content:"|F7 15 19 27 58 41 14 16 16 27 37 22 19 01 0A 0D 22 15 63 17 24 1A 0E 1E 1A 2B 63 16 23|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2435
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-user
 sid:35491
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows OTF file parsing error exploitation attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|84 94 85 97 81 A1 A5 93 95 99 A0 08 F0 06 1C 1C BE 0A FC 23 FC AF 15 6F 54 6D 68 56 63 63 6D 69|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2458
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-user
 sid:35490
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows OTF file parsing error exploitation attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|84 94 85 97 81 A1 A5 93 95 99 A0 08 F0 06 1C 1C BE 0A FC 23 FC AF 15 6F 54 6D 68 56 63 63 6D 69|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2458
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-080
 classtype:attempted-user
 sid:35489
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows atmfd.dll font driver malformed OTF file remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|8E 80 08 9A F7 40 7C 06 88 80 86 83 86 86 08 86 86 83 89 81 1B 67 F8 1E 06 94 8D 93 8F 90 1E 90 90 93 90 97|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2462
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35486
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows atmfd.dll font driver malformed OTF file remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|8E 80 08 9A F7 40 7C 06 88 80 86 83 86 86 08 86 86 83 89 81 1B 67 F8 1E 06 94 8D 93 8F 90 1E 90 90 93 90 97|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2462
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35485
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"|16 F8 40 F9 48 FC 40 06 B6 FC EB 15 8B F8 8F F7 27 FB 92 05 FB 13 FB C3 15 F7 2B F7 99 F7 2B FB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2432
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35484
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"|16 F8 40 F9 48 FC 40 06 B6 FC EB 15 8B F8 8F F7 27 FB 92 05 FB 13 FB C3 15 F7 2B F7 99 F7 2B FB|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2432
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-080
 classtype:attempted-admin
 sid:35483
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Windows Media Player mcl remote file execution attempt"
 flow:to_server, established
 flowbits:isset,file.mcl
 file_data
 content:"<application"
 content:".exe"
 within:60
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2509
 reference:cve,2015-6131
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-134
 classtype:attempted-user
 sid:35983
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Windows Media Player mcl remote file execution attempt"
 flow:to_client, established
 flowbits:isset,file.mcl
 file_data
 content:"<application"
 content:".exe"
 within:60
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2509
 reference:cve,2015-6131
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-134
 classtype:attempted-user
 sid:35982
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Journal file parsing remote code execution attempt"
 flow:to_server,established
 file_data
 content:"|4E 42 2A 00 2E 72 5B 00 01 00 00 00 7B 00 00 00 30 4C 83 01 03 00 00 00 FF FF FF FF 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-2513
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-098
 classtype:attempted-user
 sid:35962
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Journal file parsing remote code execution attempt"
 flow:to_client,established
 file_data
 content:"|4E 42 2A 00 2E 72 5B 00 01 00 00 00 7B 00 00 00 30 4C 83 01 03 00 00 00 FF FF FF FF 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-2513
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-098
 classtype:attempted-user
 sid:35961
 rev:1
)\n', 'alert tcp $EXTERNAL_NET [139,445] -> $HOME_NET any (msg:"FILE-OTHER Windows Media Player mcl remote file execution attempt"
 flow:to_client,established
 file_data
 content:"<application"
 depth:12
 offset:63
 content:".exe"
 within:60
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service netbios-ssn
 reference:cve,2015-2509
 reference:cve,2015-6131
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-100
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-134
 classtype:attempted-user
 sid:36271
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Visual Basic scripting engine Filter argument mishandling attempt"
 flow:to_server,established
 file_data
 content:"Microsoft.XMLHTTP"
 fast_pattern:only
 content:".open"
 content:".send"
 within:50
 content:".responsebody"
 within:50
 content:"Filter"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6055
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36442
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Visual Basic scripting engine Filter argument mishandling attempt"
 flow:to_client,established
 file_data
 content:"Microsoft.XMLHTTP"
 fast_pattern:only
 content:".open"
 content:".send"
 within:50
 content:".responsebody"
 within:50
 content:"Filter"
 within:50
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6055
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-106
 classtype:attempted-user
 sid:36441
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_client,established
 file_data
 flowbits:isset,file.corel|file.doc
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 A4|"
 within:rowLength
 content:"|03 00 00 A4|"
 within:rowLength
 byte_test:1,>,32,6,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:36501
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_server,established
 file_data
 flowbits:isset,file.corel|file.doc
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 A4|"
 within:rowLength
 content:"|03 00 00 A4|"
 within:rowLength
 byte_test:1,>,32,6,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:36500
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_server,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 8E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 00 8E|"
 within:rowLength
 byte_test:1,>,32,2,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:36499
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Word WordPerfect CSTYL border element stack overflow attempt"
 flow:to_client,established
 flowbits:isset,file.corel
 file_data
 content:"|DC 01|"
 byte_extract:2,0,rowLength,relative,little
 content:"|03 00 00 8E 00 00 00 00 00 00 00 00 00 00 00 00 00 00 03 00 00 8E|"
 within:rowLength
 byte_test:1,>,32,2,relative,little
 content:"|01 DC|"
 within:rowLength
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2013-1324
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS13-091
 classtype:attempted-user
 sid:36498
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows malformed TrueType file remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.ttf
 file_data
 content:"|00 01 00 00 00 00 E6 66 85 43 27 2E 5F 0F 3C F5 00 01 04 00 00 00 00 00 BB 2B 2C 8F 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6104
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-115
 classtype:attempted-user
 sid:36737
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows malformed TrueType file remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.ttf
 file_data
 content:"|00 01 00 00 00 00 E6 66 85 43 27 2E 5F 0F 3C F5 00 01 04 00 00 00 00 00 BB 2B 2C 8F 00 00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6104
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-115
 classtype:attempted-user
 sid:36736
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Journal integer overflow attempt"
 flow:to_server,established
 file_data
 content:"|32 87 70 A2 43 71 34 43 71 35 43 71 36 43 71 37 43 E9 E8 43 71 BF 43 72 30 43 67 0C 0C 72 32 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6097
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-114
 classtype:attempted-user
 sid:36698
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Journal integer overflow attempt"
 flow:to_client,established
 file_data
 content:"|32 87 70 A2 43 71 34 43 71 35 43 71 36 43 71 37 43 E9 E8 43 71 BF 43 72 30 43 67 0C 0C 72 32 43|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6097
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-114
 classtype:attempted-user
 sid:36697
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Wireshark DECT packet dissector overflow attempt"
 flow:to_server,established
 file_data
 content:"|D4 C3 B2 A1 02 00 04 00|"
 depth:8
 byte_test:4,>,1499,36,little
 content:"|FF FF FF FF FF FF 00 00 00 00 00 00 23 23|"
 depth:14
 offset:40
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,47392
 reference:cve,2011-1591
 reference:url,osvdb.org/show/osvdb/71848
 classtype:attempted-user
 sid:36855
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Windows Media Player MCL to HTML information disclosure attempt"
 flow:to_server,established
 flowbits:isset,file.mcl
 file_data
 content:"MSXML2.XMLHTTP"
 fast_pattern:only
 content:".open"
 nocase
 content:".send"
 nocase
 content:"file:///C:/"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6127
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-134
 classtype:attempted-recon
 sid:36973
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Windows Media Player MCL to HTML information disclosure attempt"
 flow:to_client,established
 flowbits:isset,file.mcl
 file_data
 content:"MSXML2.XMLHTTP"
 fast_pattern:only
 content:".open"
 nocase
 content:".send"
 nocase
 content:"file:///C:/"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6127
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS15-134
 classtype:attempted-recon
 sid:36972
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Font Viewer cmap offset integer underflow attempt"
 flow:to_server,established
 file_data
 content:"|16 4D 00 03 00 01 04 10 00 04 00 26 16 5B 00 03 00 01 04 13 00 02 00 12 16 81 00 03 00 01 04 13|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-6130
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-130
 classtype:attempted-user
 sid:36953
 rev:3
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Font Viewer cmap offset integer underflow attempt"
 flow:to_client,established
 file_data
 content:"|16 4D 00 03 00 01 04 10 00 04 00 26 16 5B 00 03 00 01 04 13 00 02 00 12 16 81 00 03 00 01 04 13|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-6130
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms15-130
 classtype:attempted-user
 sid:36952
 rev:3
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player javascript parsing cross site scripting attempt"
 flow:to_server,established
 file_data
 content:"|5C 5C 26|quot|3B|"
 fast_pattern:only
 content:"sendDataToJS"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-0533
 reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html
 classtype:attempted-user
 sid:37442
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player javascript parsing cross site scripting attempt"
 flow:to_client,established
 file_data
 content:"|5C 5C 26|quot|3B|"
 fast_pattern:only
 content:"sendDataToJS"
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-0533
 reference:url,helpx.adobe.com/security/products/flash-player/apsb14-16.html
 classtype:attempted-user
 sid:37441
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Journal CWispTiss use after free attempt"
 flow:to_server,established
 file_data
 content:"|0F 9F FF FF FF B5 C8 00 00 04 8C B8 01 C2 60 C2 C3 7A FE 3A F5 EB 4A AF 5C B9 73 80 00 02 81 80|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0038
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-013
 classtype:attempted-user
 sid:37578
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Journal CWispTiss use after free attempt"
 flow:to_client,established
 file_data
 content:"|0F 9F FF FF FF B5 C8 00 00 04 8C B8 01 C2 60 C2 C3 7A FE 3A F5 EB 4A AF 5C B9 73 80 00 02 81 80|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0038
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-013
 classtype:attempted-user
 sid:37577
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 file_data
 content:"|46 2D 92 26 20 46 1A A3 89 37 F0 06 EE 3C 82 37 F0 06 E8 C2 BD AE 3C 85 D4 A7 A5 18 42 A2 34 0C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37727
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 file_data
 content:"|46 2D 92 26 20 46 1A A3 89 37 F0 06 EE 3C 82 37 F0 06 E8 C2 BD AE 3C 85 D4 A7 A5 18 42 A2 34 0C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37726
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 file_data
 content:"|4A 6A 4A 70 49 BA A1 5E 49 45 09 43 4C 8C A1 A5 91 9E A1 99 85 9E A1 9E 61 4C 71 46 62 51 6A 4C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37825
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_client,established
 file_data
 content:"|4A 6A 4A 70 49 BA A1 5E 49 45 09 43 4C 8C A1 A5 91 9E A1 99 85 9E A1 9E 61 4C 71 46 62 51 6A 4C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:37824
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.ole|file.doc
 file_data
 content:"|00 00 FF FF 54 00 69 00 6D 00 65 00 73 00 20 00 4E 00 65 00 77 00 20 00|"
 isdataat:80,relative
 content:!"|00 00|"
 within:80
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:bugtraq,61796
 reference:cve,2013-3934
 classtype:attempted-user
 sid:37800
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Kingsoft Writer long font name buffer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.ole|file.doc
 file_data
 content:"|00 00 FF FF 54 00 69 00 6D 00 65 00 73 00 20 00 4E 00 65 00 77 00 20 00|"
 isdataat:512,relative
 content:!"|00|"
 within:512
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:bugtraq,61796
 reference:cve,2013-3934
 classtype:attempted-user
 sid:37799
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player unsupported video encoding remote code execution attempt"
 flow:to_server,established
 file_data
 content:"|04 70 20 7B E7 8D 01 FF C5 00 F4 B7 E0 83 8E A5 D9 BA D2 26 77 58 86 35 00 00 00 BB 09 00 00 05 00 46 00 00 00 00 00 17 02 00 00 00 00 00 00 10|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0967
 classtype:attempted-user
 sid:37779
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player unsupported video encoding remote code execution attempt"
 flow:to_client,established
 file_data
 content:"|04 70 20 7B E7 8D 01 FF C5 00 F4 B7 E0 83 8E A5 D9 BA D2 26 77 58 86 35 00 00 00 BB 09 00 00 05 00 46 00 00 00 00 00 17 02 00 00 00 00 00 00 10|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0967
 classtype:attempted-user
 sid:37778
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows atmfd.dll font driver malformed OTF file remote code execution attempt"
 flow:to_server,established
 file_data
 content:"|7A B3 F8 10 8B 8B 08 20 BA 05 8B 8B 69 FB C6 57 94 4D 95 93 D3 AC F7 F7 08 E3 F8 59 56 91 FB E9 FB B3 05 F7|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0121
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-026
 classtype:attempted-user
 sid:38064
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows atmfd.dll font driver malformed OTF file remote code execution attempt"
 flow:to_client,established
 file_data
 content:"|7A B3 F8 10 8B 8B 08 20 BA 05 8B 8B 69 FB C6 57 94 4D 95 93 D3 AC F7 F7 08 E3 F8 59 56 91 FB E9 FB B3 05 F7|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0121
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-026
 classtype:attempted-user
 sid:38063
 rev:1
)\n', 'alert tcp $HOME_NET any -> $HOME_NET [139,445] (msg:"FILE-OTHER Adobe Acrobat updaternotifications.dll dll-load exploit attempt"
 flow:to_server,established
 content:"|FF|SMB|A2 00 00 00 00|"
 content:"u|00|p|00|d|00|a|00|t|00|e|00|r|00|n|00|o|00|t|00|i|00|f|00|i|00|c|00|a|00|t|00|i|00|o|00|n|00|s|00|.|00|d|00|l|00|l|00 00 00|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service netbios-ssn
 reference:cve,2016-1008
 reference:url,helpx.adobe.com/security/products/acrobat/apsb16-09.html
 classtype:attempted-user
 sid:38171
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Edge Chakra JavaScript engine out of bounds read attempt"
 flow:to_server,established
 file_data
 content:"ArrayBuffer("
 content:"DataView("
 within:200
 content:"0xFFFFFFFF"
 within:50
 content:".setUint32("
 within:200
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0024
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-002
 classtype:attempted-user
 sid:38318
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Edge Chakra JavaScript engine out of bounds read attempt"
 flow:to_client,established
 file_data
 content:"ArrayBuffer("
 content:"DataView("
 within:200
 content:"0xFFFFFFFF"
 within:50
 content:".setUint32("
 within:200
 fast_pattern
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0024
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-002
 classtype:attempted-user
 sid:38317
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows win32k.sys glyph bitmap boundary out of bounds memory access attempt"
 flow:to_server,established
 file_data
 content:"|33 15 23 33 35 23 01 01 01 01 0A 0A 0A 00 00 00 00 01 00 00 00 01 00 00 55 56 E6 2C 5F 0F 3C F5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0145
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-039
 classtype:attempted-admin
 sid:38494
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows win32k.sys glyph bitmap boundary out of bounds memory access attempt"
 flow:to_client,established
 file_data
 content:"|33 15 23 33 35 23 01 01 01 01 0A 0A 0A 00 00 00 00 01 00 00 00 01 00 00 55 56 E6 2C 5F 0F 3C F5|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0145
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-039
 classtype:attempted-admin
 sid:38493
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER GDCM DICOM image integer overflow attempt"
 flow:to_server,established
 file_data
 content:"DICM"
 depth:4
 offset:128
 content:"|FF F7 00 11 08 06 92 0D 14 03 01 11 00 02 11 00 03 11 00 FF E8 00 07 6D 72 66 78 01 FF DA 00 0C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2015-8396
 classtype:attempted-user
 sid:38624
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER GDCM DICOM image integer overflow attempt"
 flow:to_client,established
 file_data
 content:"DICM"
 depth:4
 offset:128
 content:"|FF F7 00 11 08 06 92 0D 14 03 01 11 00 02 11 00 03 11 00 FF E8 00 07 6D 72 66 78 01 FF DA 00 0C|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2015-8396
 classtype:attempted-user
 sid:38623
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Office ole object external file loading attempt"
 flow:to_server,established
 flowbits:isset,file.zip
 file_data
 content:"|09 00 03 9A D1 3E 54 BF C8 3E 54 55 78 04 00 ED 03 64 00 BB 70 5E F0 C1 C2 8D 52 0F 19 D0 80 1D|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy max-detect-ips drop, policy security-ips drop, service smtp
 reference:cve,2014-4114
 reference:cve,2014-6352
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS14-060
 classtype:attempted-admin
 sid:38742
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows Media Center link file remote code execution attempt"
 flow:to_server,established
 flowbits:isset,file.mcl
 file_data
 content:"<application run"
 nocase
 content:".lnk"
 within:60
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-0185
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-059
 classtype:attempted-user
 sid:38779
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows Media Center link file remote code execution attempt"
 flow:to_client,established
 flowbits:isset,file.mcl
 file_data
 content:"<application run"
 nocase
 content:".lnk"
 within:60
 nocase
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-0185
 reference:url,technet.microsoft.com/en-us/security/bulletin/ms16-059
 classtype:attempted-user
 sid:38778
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat DC invalid TIFF tagtype out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.tiff.big
 flowbits:isnotset,file.jpeg
 file_data
 content:"|01 12|"
 content:!"|00 03|"
 within:2
 content:"|00 00 00 01|"
 within:4
 distance:2
 byte_test:2,<,533,4,relative,big
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-1080
 reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html
 classtype:attempted-user
 sid:38957
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat DC invalid TIFF tagtype out of bounds read attempt"
 flow:to_client,established
 flowbits:isset,file.tiff.big
 flowbits:isnotset,file.jpeg
 file_data
 content:"|01 12|"
 content:!"|00 03|"
 within:2
 content:"|00 00 00 01|"
 within:4
 distance:2
 byte_test:2,<,533,4,relative,big
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-1080
 reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html
 classtype:attempted-user
 sid:38956
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Acrobat DC invalid TIFF tagtype out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.tiff.little
 flowbits:isnotset,file.jpeg
 file_data
 content:"|12 01|"
 content:!"|03 00|"
 within:2
 content:"|01 00 00 00|"
 within:4
 distance:2
 byte_test:2,<,533,4,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-1080
 reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html
 classtype:attempted-user
 sid:38955
 rev:2
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Acrobat DC invalid TIFF tagtype out of bounds read attempt"
 flow:to_client,established
 flowbits:isset,file.tiff.little
 flowbits:isnotset,file.jpeg
 file_data
 content:"|12 01|"
 content:!"|03 00|"
 within:2
 content:"|01 00 00 00|"
 within:4
 distance:2
 byte_test:2,<,533,4,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-1080
 reference:url,helpx.adobe.com/security/products/reader/apsb16-14.html
 classtype:attempted-user
 sid:38954
 rev:2
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file out-of-bounds memory access attempt"
 flow:to_server,established
 flowbits:isset,file.otf
 file_data
 content:"CFF|20|"
 content:"|01 00 04 04|"
 content:"|00 01 04 00 00 00 01|"
 distance:10
 byte_extract:4,0,dictsize,relative
 content:!"|04 00 00|"
 within:8
 distance:dictsize
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-074
 classtype:attempted-admin
 sid:39261
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows ATMFD font driver malformed OTF file out-of-bounds memory access attempt"
 flow:to_client,established
 flowbits:isset,file.otf
 file_data
 content:"CFF|20|"
 content:"|01 00 04 04|"
 content:"|00 01 04 00 00 00 01|"
 distance:10
 byte_extract:4,0,dictsize,relative
 content:!"|04 00 00|"
 within:8
 distance:dictsize
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3220
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-074
 classtype:attempted-user
 sid:39260
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Adobe Flash Player malformed JPEG XR heap overflow attempt"
 flow:to_server,established
 flowbits:isset,file.atf
 file_data
 content:"|81 E0 00 00 80 08 60 01 08 00 40 00 00 00 00 27 27 3A 10 A1 04 14 26 00 00 01 00 92 C2 C2 C2 C2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-4136
 reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html
 classtype:attempted-user
 sid:39278
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Adobe Flash Player malformed JPEG XR heap overflow attempt"
 flow:to_client,established
 flowbits:isset,file.atf
 file_data
 content:"|81 E0 00 00 80 08 60 01 08 00 40 00 00 00 00 27 27 3A 10 A1 04 14 26 00 00 01 00 92 C2 C2 C2 C2|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-4136
 reference:url,helpx.adobe.com/security/products/flash-player/apsb16-18.html
 classtype:attempted-user
 sid:39277
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Symantec TNEF decoder integer overflow attempt"
 flow:to_server,established
 flowbits:isset,file.tnef
 file_data
 content:"|78 9F 3E 22|"
 depth:4
 content:"|20 80 03 00 0E 00 00 00|"
 distance:0
 byte_test:2,>,6,12,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3645
 reference:url,www.symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&suid=20160628_00
 classtype:attempted-admin
 sid:39432
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec TNEF decoder integer overflow attempt"
 flow:to_client,established
 flowbits:isset,file.tnef
 file_data
 content:"|78 9F 3E 22|"
 depth:4
 content:"|20 80 03 00 0E 00 00 00|"
 distance:0
 byte_test:2,>,6,12,relative,little
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3645
 reference:url,www.symantec.com/security_response/securityupdates/detail.jsp?fid=security_advisory&pvid=security_advisory&suid=20160628_00
 classtype:attempted-admin
 sid:39431
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Symantec Antivirus ALPkOldFormatDecompressor out of bounds read attempt"
 flow:to_server,established
 stream_size:client,<,20000
 file_data
 content:"PK|03 04|"
 byte_test:4,>,0,18,relative,little
 content:!"|FF FF FF FF|"
 within:4
 distance:18
 byte_extract:4,18,unCompSize,relative,multiplier 10,little
 byte_test:4,>,unCompSize,-8,relative,little
 content:"|08 00|"
 within:2
 distance:-18
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3646
 reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=821
 classtype:attempted-user
 sid:39403
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec Antivirus ALPkOldFormatDecompressor out of bounds read attempt"
 flow:to_client,established
 file_data
 stream_size:server,<,10000
 content:"PK|03 04|"
 byte_test:4,>,0,18,relative,little
 content:!"|FF FF FF FF|"
 within:4
 distance:18
 byte_extract:4,18,unCompSize,relative,multiplier 10,little
 byte_test:4,>,unCompSize,-8,relative,little
 content:"|08 00|"
 within:2
 distance:-18
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3646
 reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=821
 classtype:attempted-user
 sid:39402
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Symantec Norton Antivirus ccScanw.dll Unpack ShortLZ memory corruption attempt"
 flow:to_server,established
 file_data
 content:"|FF C5 88 65 54 32 26 78 66 46 87 C9 20 49 00 81 0B 82 5C 26 12 89 54 54 12 F5 4B 2A 08 A8 22 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-2207
 reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=810
 classtype:attempted-user
 sid:39386
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Symantec Norton Antivirus ccScanw.dll Unpack ShortLZ memory corruption attempt"
 flow:to_client,established
 file_data
 content:"|FF C5 88 65 54 32 26 78 66 46 87 C9 20 49 00 81 0B 82 5C 26 12 89 54 54 12 F5 4B 2A 08 A8 22 28|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-2207
 reference:url,bugs.chromium.org/p/project-zero/issues/detail?id=810
 classtype:attempted-user
 sid:39385
 rev:1
)\n', 'alert tcp $EXTERNAL_NET any -> $SMTP_SERVERS 25 (msg:"FILE-OTHER Microsoft Windows malformed TrueType file RCVT out of bounds read attempt"
 flow:to_server,established
 flowbits:isset,file.ttf
 file_data
 content:"|02 B5 02 CC 00 00 02 E3 FF FF FF E4 FF 86 FF CF FF B6 00 2D 00 2D 00 60 00 A1 00 CD 01 2B 01 1B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service smtp
 reference:cve,2016-3209
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-120
 classtype:attempted-user
 sid:40409
 rev:1
)\n', 'alert tcp $EXTERNAL_NET $FILE_DATA_PORTS -> $HOME_NET any (msg:"FILE-OTHER Microsoft Windows malformed TrueType file RCVT out of bounds read attempt"
 flow:to_client,established
 flowbits:isset,file.ttf
 file_data
 content:"|02 B5 02 CC 00 00 02 E3 FF FF FF E4 FF 86 FF CF FF B6 00 2D 00 2D 00 60 00 A1 00 CD 01 2B 01 1B|"
 fast_pattern:only
 metadata:policy balanced-ips drop, policy security-ips drop, service ftp-data, service http, service imap, service pop3
 reference:cve,2016-3209
 reference:url,technet.microsoft.com/en-us/security/bulletin/MS16-120
 classtype:attempted-user
 sid:40408
 rev:1
)\n']
